<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Quarks project – Documentation</title>
    <link>https://quarks.suse.dev/docs/</link>
    <description>Recent content in Documentation on Quarks project</description>
    <generator>Hugo -- gohugo.io</generator>
    
	  <atom:link href="https://quarks.suse.dev/docs/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: cf-operator</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator&#34;&gt;cf-operator&lt;/h2&gt;

&lt;p&gt;cf-operator manages BOSH deployments on Kubernetes&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;cf-operator manages BOSH deployments on Kubernetes&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;      --apply-crd                                (APPLY_CRD) If true, apply CRDs on start (default true)
      --bosh-dns-docker-image string             (BOSH_DNS_DOCKER_IMAGE) The docker image used for emulating bosh DNS (a CoreDNS image) (default &amp;quot;coredns/coredns:1.6.3&amp;quot;)
  -n, --cf-operator-namespace string             (CF_OPERATOR_NAMESPACE) The operator namespace, for the webhook service (default &amp;quot;default&amp;quot;)
      --cluster-domain string                    (CLUSTER_DOMAIN) The Kubernetes cluster domain (default &amp;quot;cluster.local&amp;quot;)
      --ctx-timeout int                          (CTX_TIMEOUT) context timeout for each k8s API request in seconds (default 300)
  -o, --docker-image-org string                  (DOCKER_IMAGE_ORG) Dockerhub organization that provides the operator docker image (default &amp;quot;cfcontainerization&amp;quot;)
      --docker-image-pull-policy string          (DOCKER_IMAGE_PULL_POLICY) Image pull policy (default &amp;quot;IfNotPresent&amp;quot;)
  -r, --docker-image-repository string           (DOCKER_IMAGE_REPOSITORY) Dockerhub repository that provides the operator docker image (default &amp;quot;cf-operator&amp;quot;)
  -t, --docker-image-tag string                  (DOCKER_IMAGE_TAG) Tag of the operator docker image (default &amp;quot;0.0.1&amp;quot;)
  -h, --help                                     help for cf-operator
  -c, --kubeconfig string                        (KUBECONFIG) Path to a kubeconfig, not required in-cluster
  -l, --log-level string                         (LOG_LEVEL) Only print log messages from this level onward (trace,debug,info,warn) (default &amp;quot;debug&amp;quot;)
      --max-boshdeployment-workers int           (MAX_BOSHDEPLOYMENT_WORKERS) Maximum number of workers concurrently running BOSHDeployment controller (default 1)
      --max-quarks-statefulset-workers int       (MAX_QUARKS_STATEFULSET_WORKERS) Maximum number of workers concurrently running QuarksStatefulSet controller (default 1)
      --meltdown-duration int                    (MELTDOWN_DURATION) Duration (in seconds) of the meltdown period, in which we postpone further reconciles for the same resource (default 60)
      --meltdown-requeue-after int               (MELTDOWN_REQUEUE_AFTER) Duration (in seconds) for which we delay the requeuing of the reconcile (default 30)
      --monitored-id string                      (MONITORED_ID) only monitor namespaces with this id in their namespace label (default &amp;quot;default&amp;quot;)
  -w, --operator-webhook-service-host string     (CF_OPERATOR_WEBHOOK_SERVICE_HOST) Hostname/IP under which the webhook server can be reached from the cluster
  -p, --operator-webhook-service-port string     (CF_OPERATOR_WEBHOOK_SERVICE_PORT) Port the webhook server listens on (default &amp;quot;2999&amp;quot;)
  -x, --operator-webhook-use-service-reference   (CF_OPERATOR_WEBHOOK_USE_SERVICE_REFERENCE) If true the webhook service is targeted using a service reference instead of a URL
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_version&#34;&gt;cf-operator version&lt;/a&gt;  - Print the version number&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util&#34;&gt;cf-operator util&lt;/h2&gt;

&lt;p&gt;Calls a utility subcommand&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Calls a utility subcommand.&lt;/p&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -h, --help   help for util
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator&#34;&gt;cf-operator&lt;/a&gt;  - cf-operator manages BOSH deployments on Kubernetes&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util_instance-group&#34;&gt;cf-operator util instance-group&lt;/a&gt;  - Resolves instance group properties of a BOSH manifest&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util_tail-logs&#34;&gt;cf-operator util tail-logs&lt;/a&gt;    - Tail logs from a pod&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util_template-render&#34;&gt;cf-operator util template-render&lt;/a&gt;    - Renders a bosh manifest&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util_variable-interpolation&#34;&gt;cf-operator util variable-interpolation&lt;/a&gt;  - Interpolate variables&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util_wait&#34;&gt;cf-operator util wait&lt;/a&gt;  - Wait for required service&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util instance-group</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util_instance-group/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util_instance-group/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util-instance-group&#34;&gt;cf-operator util instance-group&lt;/h2&gt;

&lt;p&gt;Resolves instance group properties of a BOSH manifest&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Resolves instance group properties of a BOSH manifest.&lt;/p&gt;

&lt;p&gt;This will resolve the properties of an instance group and return a manifest for that instance group.
Also calculates and prints the BPM configurations for all BOSH jobs of that instance group.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator util instance-group [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -b, --base-dir string              (BASE_DIR) a path to the base directory
  -m, --bosh-manifest-path string    (BOSH_MANIFEST_PATH) path to the bosh manifest file
  -n, --deployment-name string       (DEPLOYMENT_NAME) name of the bdpl resource
  -h, --help                         help for instance-group
      --initial-rollout              (INITIAL_ROLLOUT) Initial rollout of bosh deployment. (default true)
  -g, --instance-group-name string   (INSTANCE_GROUP_NAME) name of the instance group for data gathering
      --output-file-path string      (OUTPUT_FILE_PATH) Path of the file to which json output is written.
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util tail-logs</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util_tail-logs/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util_tail-logs/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util-tail-logs&#34;&gt;cf-operator util tail-logs&lt;/h2&gt;

&lt;p&gt;Tail logs from a pod&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Tail logs from a container in the same pod.&lt;/p&gt;

&lt;p&gt;This will tail all logs under the specified dir.
The dir can be set using the &amp;ldquo;-z&amp;rdquo; flag, or setting
the LOGS_DIR env variable.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator util tail-logs [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -h, --help              help for tail-logs
  -z, --logs-dir string   (LOGS_DIR) a path from where to tail logs
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util template-render</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util_template-render/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util_template-render/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util-template-render&#34;&gt;cf-operator util template-render&lt;/h2&gt;

&lt;p&gt;Renders a bosh manifest&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Renders a bosh manifest.&lt;/p&gt;

&lt;p&gt;This will render a provided manifest instance-group&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator util template-render [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;      --az-index int                 (AZ_INDEX) az index (default -1)
  -m, --bosh-manifest-path string    (BOSH_MANIFEST_PATH) path to the bosh manifest file
  -h, --help                         help for template-render
      --initial-rollout              (INITIAL_ROLLOUT) Initial rollout of bosh deployment. (default true)
  -g, --instance-group-name string   (INSTANCE_GROUP_NAME) name of the instance group for data gathering
  -j, --jobs-dir string              (JOBS_DIR) path to the jobs dir.
  -d, --output-dir string            (OUTPUT_DIR) path to output dir. (default &amp;quot;/var/vcap/jobs&amp;quot;)
      --pod-ip string                (POD_IP) pod IP
      --pod-ordinal int              (POD_ORDINAL) pod ordinal (default -1)
      --replicas int                 (REPLICAS) number of replicas (default -1)
      --spec-index int               (SPEC_INDEX) index of the instance spec (default -1)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util variable-interpolation</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util_variable-interpolation/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util_variable-interpolation/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util-variable-interpolation&#34;&gt;cf-operator util variable-interpolation&lt;/h2&gt;

&lt;p&gt;Interpolate variables&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Interpolate variables of a manifest:&lt;/p&gt;

&lt;p&gt;This will interpolate all the variables from a folder and write an
interpolated manifest to STDOUT&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator util variable-interpolation [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -m, --bosh-manifest-path string   (BOSH_MANIFEST_PATH) path to the bosh manifest file
  -h, --help                        help for variable-interpolation
      --output-file-path string     (OUTPUT_FILE_PATH) Path of the file to which json output is written.
  -v, --variables-dir string        (VARIABLES_DIR) path to the variables dir
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator util wait</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_util_wait/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_util_wait/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-util-wait&#34;&gt;cf-operator util wait&lt;/h2&gt;

&lt;p&gt;Wait for required service&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Wait for required service&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator util wait [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -h, --help           help for wait
      --interval int   interval between checks in seconds (default 1)
      --timeout int    timeout in seconds after the required service must be available (default 1800)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator_util&#34;&gt;cf-operator util&lt;/a&gt;    - Calls a utility subcommand&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: cf-operator version</title>
      <link>https://quarks.suse.dev/docs/commands/cf-operator_version/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/commands/cf-operator_version/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;cf-operator-version&#34;&gt;cf-operator version&lt;/h2&gt;

&lt;p&gt;Print the version number&lt;/p&gt;

&lt;h3 id=&#34;synopsis&#34;&gt;Synopsis&lt;/h3&gt;

&lt;p&gt;Print the version number&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cf-operator version [flags]
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;options&#34;&gt;Options&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;  -h, --help   help for version
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;see-also&#34;&gt;SEE ALSO&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;../cf-operator&#34;&gt;cf-operator&lt;/a&gt;  - cf-operator manages BOSH deployments on Kubernetes&lt;/li&gt;
&lt;/ul&gt;

&lt;h6 id=&#34;auto-generated-by-spf13-cobra-on-22-jul-2020&#34;&gt;Auto generated by spf13/cobra on 22-Jul-2020&lt;/h6&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Development Guidelines</title>
      <link>https://quarks.suse.dev/docs/development/development/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/development/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#development&#34;&gt;Development&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#requirements&#34;&gt;Requirements&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#dependencies&#34;&gt;Dependencies&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#creating-a-new-resource-and-controller&#34;&gt;Creating a new Resource and Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconcile-results&#34;&gt;Reconcile Results&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#testing&#34;&gt;Testing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#create-or-update-pattern&#34;&gt;Create-Or-Update pattern&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#logging-and-events&#34;&gt;Logging and Events&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#standalone-components&#34;&gt;Standalone Components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#versioning&#34;&gt;Versioning&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#colourise-logs&#34;&gt;Colourise Logs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;requirements&#34;&gt;Requirements&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;A working Kubernetes cluster&lt;/li&gt;
&lt;li&gt;Helm v3 binary&lt;/li&gt;
&lt;li&gt;Go 1.12.2 and install the tool chain: &lt;code&gt;make tools&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;dependencies&#34;&gt;Dependencies&lt;/h2&gt;

&lt;p&gt;Run with libraries fetched via go modules:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;GO111MODULE&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;on&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;custom-resource-definitions-crds&#34;&gt;Custom Resource Definitions (CRDs)&lt;/h2&gt;

&lt;p&gt;Kubernetes allows developers to extend the objects its APIs process and store using Custom Resource Definitions (CRDs). We are creating four &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/tree/master/docs/crds&#34; target=&#34;_blank&#34;&gt;CRDs&lt;/a&gt; (see &lt;a href=&#34;../controllers&#34;&gt;Controllers&lt;/a&gt;):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;BOSHDeployment&lt;/li&gt;
&lt;li&gt;QuarksJob&lt;/li&gt;
&lt;li&gt;QuarksSecret&lt;/li&gt;
&lt;li&gt;QuarksStatefulSet&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The CRDs are also defined in code and applied automatically when cf-operator starts. If you are editing CRDs, you should update changes to this YAML files in sync.&lt;/p&gt;

&lt;h2 id=&#34;creating-a-new-resource-and-controller&#34;&gt;Creating a new Resource and Controller&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;create a new directory: &lt;code&gt;./pkg/kube/apis/&amp;lt;group_name&amp;gt;/&amp;lt;version&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;in that directory, create the following files:

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;types.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;register.go&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;doc.go&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;p&gt;You can safely use the implementation from another controller as inspiration.
You can also copy the files and modify them.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;The &lt;code&gt;types.go&lt;/code&gt; file contains the definition of your resource. This is the file you care about. Make sure to run &lt;code&gt;make generate&lt;/code&gt; &lt;em&gt;every time you make a change&lt;/em&gt;. You can also check to see what changes would be done by running &lt;code&gt;make verify-gen-kube&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;register.go&lt;/code&gt; file contains some code that registers your new types.
  This file looks almost the same for all API resources.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;doc.go&lt;/code&gt; (deep object copy) is required to make the &lt;code&gt;deepcopy&lt;/code&gt; generator work.
  It&amp;rsquo;s safe to copy this file from another controller.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;in &lt;code&gt;bin/gen-kube&lt;/code&gt;, add your resource to the &lt;code&gt;GROUP_VERSIONS&lt;/code&gt; variable (separated by a space &lt;code&gt;&amp;quot; &amp;quot;&lt;/code&gt;):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# ...&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;GROUP_VERSIONS&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;boshdeployment:v1alpha1 &amp;lt;controller_name&amp;gt;:&amp;lt;version&amp;gt;&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# ...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;regenerate code&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# int the root of the project&lt;/span&gt;
make generate&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;create a directory structure like this for your actual controller code:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;.
+-- pkg
   +-- kube
       +-- controllers
           +-- &amp;lt;controller_name&amp;gt;
           ¦   +-- controller.go
           ¦   +-- reconciler.go
           +-- controller.go&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;controller.go&lt;/code&gt; is your controller implementation; this is where you should implement an &lt;code&gt;Add&lt;/code&gt; function where register the controller with the &lt;code&gt;Manager&lt;/code&gt;, and you watch for changes for resources that you care about.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;reconciler.go&lt;/code&gt; contains the code that takes action and reconciles actual state with desired state.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Simple implementation to get you started below.
  As always, use the other implementations to get you started.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Controller:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;package&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mycontroller&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;go.uber.org/zap&amp;#34;&lt;/span&gt;

    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/controller&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/controller/controllerutil&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/handler&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/manager&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/source&amp;#34;&lt;/span&gt;

    &lt;span style=&#34;color:#000&#34;&gt;mrcv1&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;code.cloudfoundry.org/quarks-operator/pkg/kube/apis/myresourcecontroller/v1&amp;#34;&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;Add&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;zap&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;SugaredLogger&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;manager&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Manager&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;error&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;r&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;NewReconciler&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;controllerutil&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;SetControllerReference&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;

    &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// Create a new controller
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#000&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;controller&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;New&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;myresource-controller&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;controller&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Options&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Reconciler&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;})&lt;/span&gt;
    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nil&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
      &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt;
    &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;

    &lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// Watch for changes to primary resource
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;c&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Watch&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;source&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Kind&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Type&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;mrcv1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;MyResource&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{}},&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;handler&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;EnqueueRequestForObject&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{})&lt;/span&gt;
    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;!=&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nil&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
      &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt;
    &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;

    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nil&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Reconciler:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;package&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;myresource&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;import&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;go.uber.org/zap&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;metav1&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/apis/meta/v1&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;k8s.io/apimachinery/pkg/runtime&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/client&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/manager&amp;#34;&lt;/span&gt;
    &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;sigs.k8s.io/controller-runtime/pkg/reconcile&amp;#34;&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;setReferenceFunc&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;owner&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;object&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;metav1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Object&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;scheme&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;runtime&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Scheme&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;error&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;NewReconciler&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;zap&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;SugaredLogger&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;manager&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Manager&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;srf&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;setReferenceFunc&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Reconciler&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ReconcileMyResource&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
      &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;          &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;
      &lt;span style=&#34;color:#000&#34;&gt;client&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;       &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;GetClient&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(),&lt;/span&gt;
      &lt;span style=&#34;color:#000&#34;&gt;scheme&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;       &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;GetScheme&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(),&lt;/span&gt;
      &lt;span style=&#34;color:#000&#34;&gt;setReference&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;srf&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;
    &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ReconcileMyResource&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;client&lt;/span&gt;       &lt;span style=&#34;color:#000&#34;&gt;client&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Client&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;scheme&lt;/span&gt;       &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;runtime&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Scheme&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;setReference&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;setReferenceFunc&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;          &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;zap&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;SugaredLogger&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;

  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;r&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ReconcileMyResource&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;Reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;request&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Request&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;error&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Infof&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Reconciling MyResource %s\n&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;request&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NamespacedName&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{},&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nil&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;add the new resource to &lt;code&gt;addToSchemes&lt;/code&gt; in &lt;code&gt;pkg/controllers/controller.go&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;add the new controller to &lt;code&gt;addToManagerFuncs&lt;/code&gt; in the same file.&lt;/li&gt;
&lt;li&gt;create a custom resource definition and add docs to &lt;code&gt;docs/crds&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;reconcile-results&#34;&gt;Reconcile Results&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// RequeueOnError will requeue if reconcile also returns an error
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;RequeueOnError&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{}&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// Requeue will requeue the request, behaviour is different than returning an error
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Requeue&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Requeue&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// RequeueAfterDefault requeues after the default, unless reconcile also returns an error
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;RequeueAfterDefault&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;RequeueAfter&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;config&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;RequeueAfter&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// NoRequeue does not requeue, unless reconcile also returns an error
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NoRequeue&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;reconcile&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Result&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Requeue&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;testing&#34;&gt;Testing&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;create functions in &lt;code&gt;env/machine&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;create functions in &lt;code&gt;env/catalog&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;create-or-update-pattern&#34;&gt;Create-Or-Update pattern&lt;/h2&gt;

&lt;p&gt;A pattern that comes up quite often is that an object needs to be updated if it already exists or created if it doesn&amp;rsquo;t. &lt;code&gt;controller-runtime&lt;/code&gt; provides the &lt;code&gt;controller-util&lt;/code&gt; package which has a &lt;code&gt;CreateOrUpdate&lt;/code&gt; function that can help with that. The object&amp;rsquo;s desired state must be reconciled with the existing state inside the passed in callback MutateFn - &lt;code&gt;type MutateFn func() error&lt;/code&gt;. The MutateFn is called regardless of creating or updating an object.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;_&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;controllerutil&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;CreateOrUpdate&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;r&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;client&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;someSecret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;secretMutateFn&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;someSecret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;someSecret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;StringData&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;someSecret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Labels&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;someSecret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Annotations&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;))&lt;/span&gt;

&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;secretMutateFn&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;s&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;corev1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Secret&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;secretData&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;map&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;labels&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;map&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;annotations&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;map&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;controllerutil&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;MutateFn&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;func&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;()&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;error&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Labels&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;labels&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Annotations&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;annotations&lt;/span&gt;
    &lt;span style=&#34;color:#000&#34;&gt;s&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;StringData&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;secretData&lt;/span&gt;
    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;nil&lt;/span&gt;
  &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;
&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Care must be taken when persisting objects that are already in their final state because they will be overwritten with the existing state if there already is such an object in the system.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;CreateOrUpdate&lt;/code&gt;s should not use blindly &lt;code&gt;DeepCopyInto&lt;/code&gt; or &lt;code&gt;DeepCopy&lt;/code&gt; all the time, but make more precise changes.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;logging-and-events&#34;&gt;Logging and Events&lt;/h2&gt;

&lt;p&gt;We start with a single context and pass that down via controllers into
reconcilers. Reconcilers will create a context with timeout from the inherited
context and linting will check if the &lt;code&gt;cancel()&lt;/code&gt; function of that context is
being handled.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;ctxlog&lt;/code&gt; module provides a context with a named zap logger and an event recorder to the reconcilers.
This is how it&amp;rsquo;s set up for reconcilers:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// after logger is available
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ctxlog&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NewParentContext&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;log&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// adding named log and event recorder in controllers
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ctxlog&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;NewContextWithRecorder&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;example-reconciler&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;mgr&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;GetEventRecorderFor&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;example-recorder&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;))&lt;/span&gt;
&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// adding timeout in reconcilers
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;cancel&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;context&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;WithTimeout&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;ctx&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;timeout&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;defer&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;cancel&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;ctxlog&lt;/code&gt; package provides several logging functions. &lt;code&gt;Infof&lt;/code&gt;, &lt;code&gt;Errorf&lt;/code&gt;, &lt;code&gt;Error&lt;/code&gt; and such wrap the corresponding zap log methods.&lt;/p&gt;

&lt;p&gt;The logging functions are also implemented on struct, to add event generation to the logging:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-go&#34; data-lang=&#34;go&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;ctxlog&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;WithEvent&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;instance&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Reason&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Infof&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;message: %s&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;v&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ctxlog&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;WithEvent&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;instance&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Reason&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Errorf&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;message: %s&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;v&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;err&lt;/span&gt; &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;:=&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;ctxlog&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;WithEvent&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;instance&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Reason&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;).&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Error&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;(&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;part&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;part&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;part&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The reason should be camel-case, so switch statements could match it.&lt;/p&gt;

&lt;p&gt;Error funcs like &lt;code&gt;WithEvent().Errorf()&lt;/code&gt; also return an error, with the same message as the log message and event that were generated.&lt;/p&gt;

&lt;p&gt;Calling &lt;code&gt;WarningEvent&lt;/code&gt; just creates a warning event, without logging.&lt;/p&gt;

&lt;h2 id=&#34;standalone-components&#34;&gt;Standalone Components&lt;/h2&gt;

&lt;p&gt;The cf-operator uses quarks-job as an external component.
The quarks-job operator is run in a separate process.&lt;/p&gt;

&lt;p&gt;When using jobs that capture output, quarks-job needs to know its docker image, to run the &lt;code&gt;persist-output&lt;/code&gt; command in a container.&lt;/p&gt;

&lt;h3 id=&#34;references-in-cf-operator&#34;&gt;References in cf-operator&lt;/h3&gt;

&lt;p&gt;References to quarks job:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;as a library, for the API type, via git commit sha in &lt;code&gt;go.mod&lt;/code&gt;:
&amp;lsquo;b5dc240&amp;rsquo;&lt;/li&gt;
&lt;li&gt;the docker image for integration tests is set via  &lt;code&gt;QUARKS_JOB_IMAGE_TAG&lt;/code&gt;:
&amp;lsquo;v0.0.0-0.gb5dc240&amp;rsquo;&lt;/li&gt;
&lt;li&gt;releases and e2e test use the helm sub chart, build by &lt;code&gt;bin/build-helm&lt;/code&gt;, which uses the &lt;code&gt;QUARKS_JOB_HELM_VERSION&lt;/code&gt; variable:
&amp;lsquo;0.0.0-0.gb5dc240&amp;rsquo;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Both variables are set in &lt;code&gt;bin/include/dependencies&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;update-dependencies&#34;&gt;Update Dependencies&lt;/h3&gt;

&lt;p&gt;To update a dependency in a project use &lt;code&gt;go get&lt;/code&gt;, e.g.:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go get -t -u code.cloudfoundry.org/quarks-job@aad515c
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Using the git commit sha prevents caching problems, which might occur with branch names.&lt;/p&gt;

&lt;h3 id=&#34;local-development-and-go-mod-replace&#34;&gt;Local Development And go mod &amp;lsquo;replace&amp;rsquo;&lt;/h3&gt;

&lt;p&gt;When working locally with multiple repositories it&amp;rsquo;s helpful to replace github dependencies with local directories. The &lt;code&gt;go mod edit -replace&lt;/code&gt; will modify the &lt;code&gt;go.mod&lt;/code&gt; file to point to a local dir, e.g. &amp;lsquo;../quarks-job&amp;rsquo; instead:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go mod edit -replace code.cloudfoundry.org/quarks-utils=../quarks-utils
go mod edit -replace code.cloudfoundry.org/quarks-job=../quarks-job
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;building-docker-image-when-using-go-mod-replace&#34;&gt;Building Docker Image When Using go mod &amp;lsquo;replace&amp;rsquo;&lt;/h3&gt;

&lt;p&gt;The modified libraries are not visible to the container. As a workaround a vendor folder can be used, which is also faster:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;GO111MODULE=on go mod vendor
GO111MODULE=off make build-image
rm -fr vendor
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;use-a-local-quarksjob-image-in-integration-tests&#34;&gt;Use a Local QuarksJob Image in Integration Tests&lt;/h3&gt;

&lt;p&gt;To use a local docker image export &lt;code&gt;QUARKS_JOB_IMAGE_TAG&lt;/code&gt; and make sure the image is available to the cluster, e.g. for kind:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;kind load docker-image cfcontainerization/cf-operator:$DOCKER_IMAGE_TAG
kind load docker-image cfcontainerization/quarks-job:$QUARKS_JOB_IMAGE_TAG
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;use-a-local-quarksjob-image-in-integration-tests-with-kubernetes-for-docker-desktop&#34;&gt;Use a Local QuarksJob Image in Integration Tests with Kubernetes for Docker Desktop&lt;/h3&gt;

&lt;p&gt;To use a local docker image export &lt;code&gt;QUARKS_JOB_IMAGE_TAG&lt;/code&gt; and make sure the image is available to the cluster, e.g. for kind:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;docker tag &amp;lt;cf-operator-tag&amp;gt; cfcontainerization/cf-operator:$DOCKER_IMAGE_TAG
docker tag &amp;lt;quarks-job-tag&amp;gt; cfcontainerization/quarks-job:$QUARKS_JOB_IMAGE_TAG
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;merging-prs&#34;&gt;Merging PRs&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;In PR reviews, make sure only reviewed branches of dependencies are used.&lt;/li&gt;
&lt;li&gt;If several PRs across repos belong together, be careful to merge them together and in order, so that the master branches stay compatible if one of the merges fails.&lt;/li&gt;
&lt;li&gt;Make sure that the cf-operator repo PR has updated value of quarks image tag or version at these places

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/blob/master/bin/include/dependencies#L3&#34; target=&#34;_blank&#34;&gt;Dependency File&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/blob/master/go.mod&#34; target=&#34;_blank&#34;&gt;Go mod file&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;versioning&#34;&gt;Versioning&lt;/h2&gt;

&lt;p&gt;APIs and types follow the upstream versioning scheme described at: &lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/kubernetes-api/#api-versioning&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/concepts/overview/kubernetes-api/#api-versioning&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;colourise-logs&#34;&gt;Colourise Logs&lt;/h2&gt;

&lt;p&gt;Copy the &lt;a href=&#34;https://github.com/garabik/grc&#34; target=&#34;_blank&#34;&gt;grc&lt;/a&gt; (generic colouriser grcat) config file &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/blob/master/docs/zap.grc.conf&#34; target=&#34;_blank&#34;&gt;zap.grc.conf&lt;/a&gt; to &lt;code&gt;/usr/share/grc/conf.zap&lt;/code&gt; and pipe logs to &lt;code&gt;grcat conf.zap&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# install the custom log config
cp docs/zap.grc.conf /usr/share/grc/conf.zap

# running operator
kubectl get pods -A -l name=cf-operator --no-headers=true | tail -1 | read namespace name _
kubectl logs -f -n &amp;quot;$namespace&amp;quot; &amp;quot;$name&amp;quot; | grcat conf.zap

# integration tests example
grcat conf.zap &amp;lt; /tmp/cf-operator-tests.log
&lt;/code&gt;&lt;/pre&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Install</title>
      <link>https://quarks.suse.dev/docs/core-tasks/install/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/core-tasks/install/</guid>
      <description>
        
        
        

&lt;p&gt;The &lt;code&gt;quarks-operator&lt;/code&gt; can be installed via &lt;code&gt;helm&lt;/code&gt;. You can use our &lt;a href=&#34;https://cloudfoundry-incubator.github.io/quarks-helm/&#34; target=&#34;_blank&#34;&gt;helm repository&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;See the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/releases&#34; target=&#34;_blank&#34;&gt;releases page&lt;/a&gt; for up-to-date instructions on how to install the operator.&lt;/p&gt;

&lt;p&gt;For more information about the &lt;code&gt;quarks-operator&lt;/code&gt; helm chart and how to configure it, please refer to the helm repository &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/tree/master/deploy/helm/cf-operator&#34; target=&#34;_blank&#34;&gt;README.md&lt;/a&gt;. A short summary of the installation steps is presented below.&lt;/p&gt;

&lt;h2 id=&#34;prerequisites&#34;&gt;Prerequisites&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Kubernetes cluster&lt;/li&gt;
&lt;li&gt;helm&lt;/li&gt;
&lt;li&gt;kubectl&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;installation&#34;&gt;Installation&lt;/h2&gt;

&lt;p&gt;Add the quarks repository to helm if you haven&amp;rsquo;t already:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm repo add quarks https://cloudfoundry-incubator.github.io/quarks-helm/&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The simplest way to install the operator, is by using the default values:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm install cf-operator quarks/cf-operator --namespace cf-operator&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The operator will watch for BOSH deployments in separate namespaces, not the one it has been deployed to. By default, it creates a namespace &lt;code&gt;staging&lt;/code&gt; and starts watching it.&lt;/p&gt;

&lt;p&gt;A complete list of the chart settings is available &lt;a href=&#34;https://hub.helm.sh/charts/quarks/cf-operator&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;multiple-namespaces&#34;&gt;Multiple namespaces&lt;/h3&gt;

&lt;p&gt;The quarks-operator watches namespaces labeled with &lt;code&gt;quarks.cloudfoundry.org/monitored=ID&lt;/code&gt;. The &lt;code&gt;ID&lt;/code&gt; has to be specified with helm settings during install (&lt;code&gt;--set &amp;quot;global.monitoredID=ID&amp;quot;&lt;/code&gt;).
The helm value setting &lt;code&gt;global.singleNamespace.name=&lt;/code&gt; allows to automatically create a namespace which is being watched by the quarks-operator.&lt;/p&gt;

&lt;p&gt;For example, to watch to a different namespace with a specific ID:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm install relname1 quarks/cf-operator &lt;span style=&#34;color:#4e9a06&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&lt;/span&gt;  --namespace namespace1
  --set &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;global.singleNamespace.name=staging1&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&lt;/span&gt;  --set &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;global.monitoredID=id1&amp;#34;&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&lt;/span&gt;  --set &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;quarks-job.persistOutputClusterRole.name=clusterrole1&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;using-multiple-namespaces-with-one-operator&#34;&gt;Using multiple namespaces with one operator&lt;/h3&gt;

&lt;p&gt;The cluster role can be reused between namespaces. The service account (and role binding) should be different for each namespace.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm install relname1 quarks/cf-operator &lt;span style=&#34;color:#4e9a06&#34;&gt;\
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&lt;/span&gt;  --set &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;global.singleNamespace.create=false&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Manually create before running helm install, for each namespace:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;a namespace &amp;ldquo;staging1&amp;rdquo; with the following labels (note: &amp;ldquo;cfo&amp;rdquo; and &amp;ldquo;qjob-persist-output&amp;rdquo; are the defaults from values.yaml):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    quarks.cloudfoundry.org/monitored: &amp;quot;cfo&amp;quot;
    quarks.cloudfoundry.org/qjob-service-account: qjob-persist-output
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;a service account named &amp;ldquo;qjob-persist-output&amp;rdquo;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;a role binding from the existing cluster role &amp;ldquo;qjob-persist-output&amp;rdquo; to &amp;ldquo;qjob-persist-output&amp;rdquo; service account in namespace &amp;ldquo;staging1&amp;rdquo;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;For more options look at the README for the chart&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm show readme quarks/cf-operator&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;what-next&#34;&gt;What next?&lt;/h2&gt;

&lt;p&gt;With a running &lt;code&gt;quarks-operator&lt;/code&gt; pod, you can try one of the files (see &lt;a href=&#34;https://raw.githubusercontent.com/cloudfoundry-incubator/quarks-operator/master/docs/examples/bosh-deployment/boshdeployment-with-custom-variable.yaml&#34; target=&#34;_blank&#34;&gt;boshdeployment-with-custom-variable.yaml&lt;/a&gt; ), as follows (if you installed it with default values):&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kubectl -n staging apply -f https://raw.githubusercontent.com/cloudfoundry-incubator/quarks-operator/master/docs/examples/bosh-deployment/boshdeployment-with-custom-variable.yaml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The above will spawn two pods in your &lt;code&gt;cf-operator&lt;/code&gt; namespace (which needs to be created upfront), running the BOSH nats release.&lt;/p&gt;

&lt;p&gt;You can access the &lt;code&gt;quarks-operator&lt;/code&gt; logs by following the operator pod&amp;rsquo;s output:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kubectl logs -f -n cf-operator cf-operator&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or look at the k8s event log:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kubectl get events -n cf-operator --watch&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;modifying-the-deployment&#34;&gt;Modifying the deployment&lt;/h2&gt;

&lt;p&gt;The main input to the operator is the &lt;code&gt;BOSH deployment&lt;/code&gt; custom resource and the according manifest config map or secret. Changes to the &lt;code&gt;Spec&lt;/code&gt; or &lt;code&gt;Data&lt;/code&gt; fields of either of those will trigger the operator to recalculate the desired state and apply the required changes from the current state.&lt;/p&gt;

&lt;p&gt;Besides that there are more things the user can change which will trigger an update of the deployment:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ops files&lt;/code&gt; can be added or removed from the &lt;code&gt;BOSH deployment&lt;/code&gt;. Existing &lt;code&gt;ops file&lt;/code&gt; config maps and secrets can be modified&lt;/li&gt;
&lt;li&gt;generated secrets for &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/blob/master/docs/from_bosh_to_kube.md#variables-to-quarks-secrets&#34; target=&#34;_blank&#34;&gt;explicit variables&lt;/a&gt; can be modified&lt;/li&gt;
&lt;li&gt;secrets for &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/blob/master/docs/from_bosh_to_kube.md#manual-implicit-variables&#34; target=&#34;_blank&#34;&gt;implicit variables&lt;/a&gt; have to be created by the user beforehand anyway, but can also be changed after the initial deployment&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Build</title>
      <link>https://quarks.suse.dev/docs/core-tasks/building/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/core-tasks/building/</guid>
      <description>
        
        
        

&lt;p&gt;The following steps layout the process of generating a &lt;code&gt;cf-operator&lt;/code&gt; controller and how to install this in your Kubernetes cluster. This is probably a good approach, when developing, as a way to inmediately test your changes.&lt;/p&gt;

&lt;h2 id=&#34;build-it-from-source&#34;&gt;Build it from source&lt;/h2&gt;

&lt;p&gt;Follow this steps to build a proper docker image and generate a deployable helm chart:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Checkout the latest stable release / or run it from develop branch&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;git checkout v0.3.0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build the cf-operator binary, this will be embedded later on the docker image&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build the docker image&lt;/p&gt;

&lt;p&gt;When running in minikube, please run: &lt;code&gt;eval $(minikube docker-env)&lt;/code&gt;, to build the image
directly on minikube docker.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build-image&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: This will automatically generate a docker image tag based on your current commit, tag and SHA.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Generated helm charts with a proper docker image tag, org and repository&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build-helm&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: This will generate a new directory under the base dir, named &lt;code&gt;helm/&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Install the helm chart(apply Kubernetes Custom Resources)&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;helm install cf-operator-test helm/cf-operator&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: The cf-operator will be available under the namespace set in the context, usually &lt;code&gt;default&lt;/code&gt;, running as a pod.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;notes&#34;&gt;Notes&lt;/h2&gt;

&lt;h3 id=&#34;local-development-with-minikube-and-havener&#34;&gt;Local Development with Minikube and Havener&lt;/h3&gt;

&lt;p&gt;Make sure you have &lt;a href=&#34;https://github.com/homeport/havener&#34; target=&#34;_blank&#34;&gt;havener&lt;/a&gt; install.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;havener deploy --config dev-env-havener.yaml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
      </description>
    </item>
    
    <item>
      <title>Docs: Testing</title>
      <link>https://quarks.suse.dev/docs/development/testing/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/testing/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#testing&#34;&gt;Testing&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#tests-description&#34;&gt;Tests description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#unit&#34;&gt;Unit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#integration&#34;&gt;Integration&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#end-to-end&#34;&gt;End-to-End&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#running-tests&#34;&gt;Running tests&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#in-minikube&#34;&gt;in minikube&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#in-kind&#34;&gt;in KinD&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#makefile&#34;&gt;Makefile&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#general-targets&#34;&gt;General Targets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#build-targets&#34;&gt;Build Targets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#test-targets&#34;&gt;Test Targets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#generate-targets&#34;&gt;Generate Targets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ci&#34;&gt;CI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;tests-description&#34;&gt;Tests description&lt;/h2&gt;

&lt;p&gt;Based on upstreams documentation &lt;a href=&#34;https://github.com/thtanaka/kubernetes/blob/master/docs/devel/testing.md&#34; target=&#34;_blank&#34;&gt;https://github.com/thtanaka/kubernetes/blob/master/docs/devel/testing.md&lt;/a&gt; we use three levels of testing: &lt;code&gt;unit&lt;/code&gt;, &lt;code&gt;integration&lt;/code&gt; and &lt;code&gt;e2e&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Before starting, run &lt;code&gt;make tools&lt;/code&gt; to install the required dependencies.&lt;/p&gt;

&lt;p&gt;Running &lt;code&gt;make test&lt;/code&gt; executes all the test suites.&lt;/p&gt;

&lt;p&gt;We use ginkgo for testing. Every package needs a &lt;code&gt;suite_test.go&lt;/code&gt; for setup. It can be generated by running &lt;code&gt;ginkgo bootstrap&lt;/code&gt; in the sub folder. Rename the generated file afterwards, to stay consistent.
There is also &lt;code&gt;ginkgo generate&lt;/code&gt; to create skeleton test files.&lt;/p&gt;

&lt;h2 id=&#34;unit&#34;&gt;Unit&lt;/h2&gt;

&lt;p&gt;While unit testing we:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;test classes in isolation&lt;/li&gt;
&lt;li&gt;pass all dependencies to the constructor, so we can inject fakes for testing&lt;/li&gt;
&lt;li&gt;use &lt;code&gt;counterfeiter&lt;/code&gt; and &lt;code&gt;gomock&lt;/code&gt;/&lt;code&gt;mockgen&lt;/code&gt; to generate and update fakes and mocks&lt;/li&gt;
&lt;li&gt;don&amp;rsquo;t test private methods, tests are in a separate &lt;code&gt;_test&lt;/code&gt; package&lt;/li&gt;
&lt;li&gt;try not to nest ginkgo contexts too deep and keep tests DRY by extracting useful helpers&lt;/li&gt;
&lt;li&gt;assert incoming messages produce the expected state&lt;/li&gt;
&lt;li&gt;assert outgoing commands happened, like a file gets written&lt;/li&gt;
&lt;li&gt;assert all handled error cases are triggered&lt;/li&gt;
&lt;li&gt;can ignore outgoing queries, which only change internal state&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;setup-ruby&#34;&gt;Setup Ruby&lt;/h3&gt;

&lt;p&gt;Ruby gem for template rendering&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;gem install bosh-template&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;integration&#34;&gt;Integration&lt;/h2&gt;

&lt;p&gt;Integration tests formulate expectations on the interactions of several components.
They require access to a Kubernetes, preferably &lt;code&gt;minikube&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Integration tests start our operator directly, bypassing the command line.
They do require the operator &lt;a href=&#34;#upload-operator-image&#34;&gt;docker image&lt;/a&gt; and the &lt;code&gt;bosh-template&lt;/code&gt; Ruby gem.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;environment&lt;/code&gt; package provides helpers to start the operator, get the kubeconfig and use the clients to create objects.
In &lt;code&gt;testing&lt;/code&gt; the &lt;code&gt;catalog&lt;/code&gt; defines test objects.&lt;/p&gt;

&lt;p&gt;Integration tests use a special logger, which does not log to stdout and whose messages can be accessed as a an array by calling &lt;code&gt;env.AllLogMessages()&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;When using &lt;code&gt;bin/test-integration&lt;/code&gt; the integration tests are run in parallel.
Each Ginkgo test node has a separate namespace, log file and webhook server port and certificate.&lt;/p&gt;

&lt;p&gt;The node index starts at 1 and is used as following to generate names:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;namespace: &lt;span style=&#34;color:#000&#34;&gt;$TEST_NAMESPACE&lt;/span&gt; + &amp;lt;node_index&amp;gt;
webhook port: &lt;span style=&#34;color:#000&#34;&gt;$CF_OPERATOR_WEBHOOK_SERVICE_PORT&lt;/span&gt; + &amp;lt;node_index&amp;gt;
log file: &lt;span style=&#34;color:#000&#34;&gt;$CF_OPERATOR_TESTING_TMP&lt;/span&gt;/cf-operator-tests-&amp;lt;node_index&amp;gt;.log&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Integration tests use the &lt;code&gt;TEST_NAMESPACE&lt;/code&gt; environment variable as a base to
calculate the namespace name. Test namespaces are deleted automatically once
the tests are completed.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;CF_OPERATOR_TESTING_TMP&lt;/code&gt; can be used to set a tmp directory for storing logs
and other files generated during testing. If this variable is not set &lt;code&gt;/tmp&lt;/code&gt;
will be used instead.&lt;/p&gt;

&lt;p&gt;The tests will create some NodePort services; normally the test can detect an IP
address automatically. &lt;code&gt;CF_OPERATOR_NODE_IP&lt;/code&gt; can set to the node IP of any
arbitrary node to override this (e.g. for OpenStack Kubernetes clusters).&lt;/p&gt;

&lt;p&gt;Generated files will be cleand up after the test run unless &lt;code&gt;SKIP_CF_OPERATOR_TESTING_TMP_CLEANUP&lt;/code&gt;
is set to &lt;code&gt;true&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;webhook-configuration&#34;&gt;&lt;strong&gt;Webhook Configuration&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;Quarks StatefulSet requires a k8s webhook to mutate the volumes of a pod.
Kubernetes will call back to the operator for certain requests and use the
modified pod manifest, which is returned.
CF-Operator also uses a validating webhook to validate the BOSH deployment spec and the creation
of reference resources specified in the spec. Secret validation admission webhook restricts the
user from updating a versioned secret.&lt;/p&gt;

&lt;p&gt;The cf-operator integration tests use &lt;code&gt;CF_OPERATOR_WEBHOOK_SERVICE_PORT&lt;/code&gt; as a
base value to calculate the port number to listen to on &lt;code&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The tests use a &lt;code&gt;mutatingwebhookconfiguration&lt;/code&gt; and a &lt;code&gt;validatingwebhookconfiguration&lt;/code&gt; to configure Kubernetes to
connect to this address. The address needs to be reachable from the cluster.&lt;/p&gt;

&lt;p&gt;The configuration only applies to a single namespace, by using a selector. It contains the URL of the webhooks, build from
&lt;code&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/code&gt; and the calculated port.
It also contains SSL certificates and CA, which are necessary to connect to the webhook.&lt;/p&gt;

&lt;p&gt;The certificates and keys are written to disk, so the webhook server can use
them.  They are also cached in a k8s secret for production, but that is not
being used in integration tests, since they delete the test namespaces.&lt;/p&gt;

&lt;p&gt;Tests suites should clean up their, namespace dependant, webhook configuration automatically.&lt;/p&gt;

&lt;h2 id=&#34;end-to-end&#34;&gt;End-to-End&lt;/h2&gt;

&lt;p&gt;The e2e tests are meant to test acceptance scenarios. They are written from an end user perspective.
They are split into two types, &amp;lsquo;cli&amp;rsquo; and &amp;lsquo;kube&amp;rsquo;.&lt;/p&gt;

&lt;p&gt;The e2e CLI test exercise different command line options and commands which don&amp;rsquo;t need a running Kubernetes, like template rendering.
The CLI tests build the operator binary themselves.&lt;/p&gt;

&lt;p&gt;The second type of e2e tests use &lt;code&gt;helm&lt;/code&gt; to install the CF operator into the k8s cluster and use the files from &lt;code&gt;docs/examples&lt;/code&gt; for testing.&lt;/p&gt;

&lt;h2 id=&#34;running-tests&#34;&gt;Running tests&lt;/h2&gt;

&lt;h3 id=&#34;in-minikube&#34;&gt;In minikube&lt;/h3&gt;

&lt;p&gt;The following steps are necessary to have a proper environment setup, where all types of tests can be executed:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Start &lt;code&gt;minikube&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;minikube start --kubernetes-version v1.15.5&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Switch to minikube docker daemon&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;eval&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;$(&lt;/span&gt;minikube docker-env&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: Template rendering for BOSH jobs is done at deployment time by the operator
binary. Therefore the operator docker image needs to be made available to
Kubernetes cluster.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Export the &lt;code&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/code&gt; env variable&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;$(&lt;/span&gt;ip -4 a s dev &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;$(&lt;/span&gt;ip r l &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;/0 &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; cut -f5 -d&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; grep -oP &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;inet \K\S+(?=/)&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: On Mac, use &lt;code&gt;export CF_OPERATOR_WEBHOOK_SERVICE_HOST=$(ip a s $(ip r g 0/0 | cut -f5 -d&#39; &#39;) | grep -oE &#39;inet [^ /]+&#39; | cut -f2 -d&#39; &#39;)&lt;/code&gt;, because grep cannot handle perl regexs.
&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: You can also find the correct IP, by running &lt;code&gt;ip addr&lt;/code&gt;. The IP address under &lt;code&gt;vboxnet1&lt;/code&gt; is the IP that you need.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Export the &lt;code&gt;OPERATOR_TEST_STORAGE_CLASS&lt;/code&gt; env variable&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;OPERATOR_TEST_STORAGE_CLASS&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;standard&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: Require for the PVC test creation, in minikube.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Ensure &lt;code&gt;GO111MODULE&lt;/code&gt; is set&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;GO111MODULE&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;on&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: When you have a vendor folder (either from the submodule or manually created) settings this to &lt;code&gt;off&lt;/code&gt; speeds up the &lt;code&gt;build-image&lt;/code&gt; target.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build the &lt;code&gt;cf-operator&lt;/code&gt; binary&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build the &lt;code&gt;cf-operator&lt;/code&gt; docker image&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build-image&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: Consider setting &lt;code&gt;DOCKER_IMAGE_TAG&lt;/code&gt; to a fixed variable. This will avoid rebuilding the docker image everytime, when doing changes in files not related to the &lt;code&gt;cf-operator&lt;/code&gt;
binary.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: When not running in CI, nothing ensures a proper cleanup of resources after the deletion of the &lt;code&gt;cf-operator&lt;/code&gt; in the environment. You can make sure to manually verify that none
old resources will interfere with a future installation, by:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Deleting old mutating webhooks configurations&lt;/span&gt;
kubectl get mutatingwebhookconfiguration -oname &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; xargs -n &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt; kubectl delete&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;in-kind&#34;&gt;In KinD&lt;/h3&gt;

&lt;p&gt;The following steps are necessary to have a proper environment setup, where all types of tests can be executed:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Install &lt;code&gt;KinD&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Follow the instructions from &lt;a href=&#34;https://github.com/kubernetes-sigs/kind/&#34; target=&#34;_blank&#34;&gt;https://github.com/kubernetes-sigs/kind/&lt;/a&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Start cluster&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;kind create cluster --image kindest/node:v1.15.6&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Export the &lt;code&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/code&gt; env variable. Use the IP of the docker bridge or your public IP. Firewall rules may interfere.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;CF_OPERATOR_WEBHOOK_SERVICE_HOST&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;$(&lt;/span&gt;ip -4 a s dev &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;$(&lt;/span&gt;ip r l &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;/0 &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; cut -f5 -d&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;)&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt; grep -oP &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;inet \K\S+(?=/)&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: On Mac, use &lt;code&gt;export CF_OPERATOR_WEBHOOK_SERVICE_HOST=$(ip a s $(ip r g 0/0 | cut -f5 -d&#39; &#39;) | grep -oE &#39;inet [^ /]+&#39; | cut -f2 -d&#39; &#39;)&lt;/code&gt;, because grep cannot handle perl regexs.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Export the &lt;code&gt;OPERATOR_TEST_STORAGE_CLASS&lt;/code&gt; env variable&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;OPERATOR_TEST_STORAGE_CLASS&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;standard&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt;Note&lt;/strong&gt;&lt;/em&gt;: Required for the PVC tests.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Build the &lt;code&gt;cf-operator&lt;/code&gt; docker image&lt;/p&gt;

&lt;p&gt;First set the version to something static, not dependant on git:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;export&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;DOCKER_IMAGE_TAG&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;${&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;DOCKER_IMAGE_TAG&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;:-&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;dev&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;bin/build-image&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or if you have local changes and use &lt;code&gt;go mod edit --replace&lt;/code&gt;,
follow instructions from &lt;a href=&#34;../../development/development#standalone-components&#34;&gt;development&lt;/a&gt;.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Load image into KinD&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;kind load docker-image cfcontainerization/cf-operator:$DOCKER_IMAGE_TAG
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Set QuarksJob dependency. Choose a tag from &lt;a href=&#34;https://hub.docker.com/r/cfcontainerization/quarks-job/tags&#34; target=&#34;_blank&#34;&gt;docker.io&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;export QUARKS_JOB_IMAGE_TAG=${QUARKS_JOB_IMAGE_TAG:-dev}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If using a locally built quarks-job image, load it via&lt;/p&gt;

&lt;p&gt;&lt;code&gt;kind load docker-image cfcontainerization/quarks-job:$QUARKS_JOB_IMAGE_TAG&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;(see &lt;a href=&#34;../../development/development#standalone-components&#34;&gt;development&lt;/a&gt;).&lt;/p&gt;

&lt;h2 id=&#34;makefile&#34;&gt;Makefile&lt;/h2&gt;

&lt;p&gt;The following are the make targets available and their actions. When building and running the targets manually on the quarks-operator codebase, please set &lt;code&gt;PROJECT=quarks-operator&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The common scripts between the &lt;code&gt;quarks-operator&lt;/code&gt; components are in the &lt;code&gt;quarks-utils&lt;/code&gt; &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-utils/&#34; target=&#34;_blank&#34;&gt;project&lt;/a&gt;. To download them, make sure to run &lt;code&gt;bin/tools-shared&lt;/code&gt; or &lt;code&gt;make tools&lt;/code&gt; before running any other script/target.&lt;/p&gt;

&lt;h3 id=&#34;general-targets&#34;&gt;General Targets&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Action&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;all&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;install dependencies, run tests and builds &lt;code&gt;cf-operator&lt;/code&gt; binary.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;up&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;starts the operator using the binary created by &lt;code&gt;build&lt;/code&gt; make target.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;vet&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs the code analyzing tool &lt;code&gt;vet&lt;/code&gt; to identify problems in the source code.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;lint&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs &lt;code&gt;go lint&lt;/code&gt;to identify style mistakes.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;tools&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;installs go dependencies required to &lt;code&gt;cf-operator&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;check-scripts&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs &lt;code&gt;shellcheck&lt;/code&gt; to identify syntax, semmantic and subtle caveats in shell scripts.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;build-targets&#34;&gt;Build Targets&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Action&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;build&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;builds the &lt;code&gt;cf-operator&lt;/code&gt; binary.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;build-image&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;builds the &lt;code&gt;cf-operator&lt;/code&gt; docker image.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;build-helm&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;builds the &lt;code&gt;cf-operator&lt;/code&gt; helm tar file.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;test-targets&#34;&gt;Test Targets&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Action&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs unit,integration and e2e tests.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-unit&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs unit tests only.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-integration&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs integration tests only.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-cli-e2e&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs end to end tests for CLI.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-helm-e2e&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs end to end tests on k8s using &lt;code&gt;helm install&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-integration-storage&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs integration storage tests.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;test-helm-e2e-storage&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs e2e storage tests.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;generate-targets&#34;&gt;Generate Targets&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Name&lt;/th&gt;
&lt;th&gt;Action&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;generate&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;runs &lt;code&gt;gen-kube&lt;/code&gt; and &lt;code&gt;gen-fakes&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;gen-kube&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;generates kube client,informers, lister code.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;gen-fakes&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;generates fake objects for unit testing.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;gen-command-docs&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;generates docs for all commands.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;verify-gen-kube&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;informs if you need to run &lt;code&gt;gen-kube&lt;/code&gt; make target.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;ci&#34;&gt;CI&lt;/h2&gt;

&lt;p&gt;Our Concourse pipeline definitions are kept in the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator-ci&#34; target=&#34;_blank&#34;&gt;cf-operator-ci&lt;/a&gt; repo.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Releasing</title>
      <link>https://quarks.suse.dev/docs/development/releasing/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/releasing/</guid>
      <description>
        
        
        

&lt;p&gt;We&amp;rsquo;re releasing based on tags, which contain our version number. The format is &amp;lsquo;v0.0.0&amp;rsquo;.
The release title will be set to this version.&lt;/p&gt;

&lt;p&gt;The CI pipeline has a &amp;lsquo;release&amp;rsquo; job, which will update the release on Github.
That job triggers itself, when a draft release is created.&lt;/p&gt;

&lt;h2 id=&#34;create-new-release-pipeline&#34;&gt;Create new release pipeline&lt;/h2&gt;

&lt;p&gt;We release from release-branches. Each maintained release has a separate pipeline in Concourse.
To create a new pipeline run this in the CI repository:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;color:#204a87&#34;&gt;cd&lt;/span&gt; pipelines/cf-operator-release
./configure.sh CFO v0.4.x v0.4&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Where &lt;code&gt;CFO&lt;/code&gt; is your concourse target and &lt;code&gt;v0.4.x&lt;/code&gt; is the name of the branch.
The last argument, &lt;code&gt;v0.4&lt;/code&gt; is used to filter Github tags, which belong to the release.&lt;/p&gt;

&lt;p&gt;This allows a separate Github branch and Concourse pipeline for each major version.
Within those pipelines, releases can be built from minor versions.&lt;/p&gt;

&lt;h2 id=&#34;create-a-new-release&#34;&gt;Create a new release&lt;/h2&gt;

&lt;p&gt;After completion, the pipeline will create several artifacts:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;helm chart on S3&lt;/li&gt;
&lt;li&gt;helm chart in our repo at &lt;a href=&#34;https://cloudfoundry-incubator.github.io/quarks-helm/&#34; target=&#34;_blank&#34;&gt;https://cloudfoundry-incubator.github.io/quarks-helm/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;cf-operator binary on S3&lt;/li&gt;
&lt;li&gt;docker image of the operator on dockerhub&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Running the &amp;lsquo;release&amp;rsquo; job will take the latest artificats, which passed through the pipeline and add them to the Github release:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;to the body&lt;/li&gt;
&lt;li&gt;as Github assets for downloading&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The version numbers (&lt;code&gt;v0.0.0-&amp;lt;number-of-commits&amp;gt;.&amp;lt;commit-SHA&amp;gt;&lt;/code&gt;) of these assets are taken from the info on S3.
They have to match the Github tag, else the release job will fail.
The assets will be copied into a &amp;lsquo;release&amp;rsquo; folder on S3.&lt;/p&gt;

&lt;p&gt;The docker image is only referenced from the helm chart and not mentioned in the release, though.&lt;/p&gt;

&lt;h2 id=&#34;checklist&#34;&gt;Checklist&lt;/h2&gt;

&lt;h3 id=&#34;major-release&#34;&gt;Major Release&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;Create version branch&lt;/li&gt;
&lt;li&gt;Create a new release pipeline for that branch&lt;/li&gt;
&lt;li&gt;Unpause pipeline&lt;/li&gt;
&lt;li&gt;Continue with &amp;ldquo;Minor Bump&amp;rdquo;&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;minor-bump&#34;&gt;Minor Bump&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;Tag commit with new version&lt;/li&gt;
&lt;li&gt;Push commit&lt;/li&gt;
&lt;li&gt;Wait for commit to pass release pipeline, &amp;lsquo;publish&amp;rsquo; needs to create the binary and helm chart, before the &amp;lsquo;release&amp;rsquo; job can run&lt;/li&gt;
&lt;li&gt;Create a draft Github release for that tag, &amp;lsquo;release&amp;rsquo; job triggers&lt;/li&gt;
&lt;li&gt;Wait for &amp;lsquo;release&amp;rsquo; job to finish on Concourse&lt;/li&gt;
&lt;li&gt;Edit the draft release on Github and publish it&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Try not to push to the pipeline again, until step 4 is completed. The &amp;lsquo;release&amp;rsquo; job will always take the most recent artifacts from S3. Maybe pause the &amp;lsquo;publish&amp;rsquo; job manually to avoid accidental updates.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: From BOSH to Kubernetes</title>
      <link>https://quarks.suse.dev/docs/core-tasks/from_bosh_to_kube/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/core-tasks/from_bosh_to_kube/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#open-questions&#34;&gt;Open Questions&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#missing-features&#34;&gt;Missing Features&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#high-level-direction&#34;&gt;High-level Direction&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#deployment-lifecycle&#34;&gt;Deployment Lifecycle&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#example-deployment-manifest-conversion-details&#34;&gt;Example Deployment Manifest Conversion Details&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bpm&#34;&gt;BPM&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#entrypoint--environment-variables&#34;&gt;Entrypoint &amp;amp; Environment Variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#resources&#34;&gt;Resources&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#health-checks&#34;&gt;Health checks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#hooks&#34;&gt;Hooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#misc&#34;&gt;Misc&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#conversion-details&#34;&gt;Conversion Details&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#calculation-of-docker-image-location-for-releases&#34;&gt;Calculation of docker image location for releases&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#variables-to-quarks-secrets&#34;&gt;Variables to Quarks Secrets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#overriding-generated-variables&#34;&gt;Overriding generated variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#instance-groups-to-quarks-statefulsets-and-jobs&#34;&gt;Instance Groups to Quarks StatefulSets and Jobs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bosh-services-vs-bosh-errands&#34;&gt;BOSH Services vs BOSH Errands&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#miscellaneous&#34;&gt;Miscellaneous&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#dealing-with-azs&#34;&gt;Dealing with AZs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#support-for-activepassive-pod-replicas&#34;&gt;Support for active/passive pod replicas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ephemeral-disks&#34;&gt;Ephemeral Disks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#credentials-for-docker-registries&#34;&gt;Credentials for Docker Registries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#running-manual-errands&#34;&gt;Running manual errands&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#readiness-and-liveness-probes&#34;&gt;Readiness and Liveness Probes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#persistent-disks&#34;&gt;Persistent Disks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#manual-implicit-variables&#34;&gt;Manual (&amp;ldquo;implicit&amp;rdquo;) variables&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#pre_render_scripts&#34;&gt;Pre_render_scripts&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bosh-dns&#34;&gt;BOSH DNS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#flow&#34;&gt;Flow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#naming-conventions&#34;&gt;Naming Conventions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;open-questions&#34;&gt;Open Questions&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;How do we rename things going from one version to the next?&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;missing-features&#34;&gt;Missing Features&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;Canary support in QuarksStatefulSets&lt;/li&gt;
&lt;li&gt;Missing support for the &lt;code&gt;allow_executions&lt;/code&gt; flag in bpm configs&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;high-level-direction&#34;&gt;High-level Direction&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;releases are defined in the usual way (a &lt;code&gt;releases&lt;/code&gt; block), but the information given is used to build a reference for a docker image&lt;/li&gt;
&lt;li&gt;each instance group is transformed to an &lt;code&gt;QuarksStatefulSet&lt;/code&gt; or an &lt;code&gt;QuarksJob&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;each BOSH Job corresponds to one or more containers in the &lt;code&gt;Pod&lt;/code&gt; template defined in the &lt;code&gt;QuarksStatefulSet&lt;/code&gt; or the &lt;code&gt;QuarksJob&lt;/code&gt;; there&amp;rsquo;s one container for each process defined in the BPM information of each BOSH Job&lt;/li&gt;
&lt;li&gt;&amp;ldquo;explicit&amp;rdquo; &lt;code&gt;variables&lt;/code&gt; are generated using &lt;code&gt;QuarksSecrets&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;for rendering of BOSH Job Templates, please read &lt;a href=&#34;../../features/rendering_templates&#34;&gt;this document&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;we have a concept of &lt;a href=&#34;../../features/desired_manifests&#34;&gt;Desired Manifests&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;all communication happens through Kubernetes &lt;code&gt;Services&lt;/code&gt;, which have deterministic DNS Addresses; you can read more about these &lt;a href=&#34;../../features/rendering_templates#services-and-dns-addresses&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;deployment-lifecycle&#34;&gt;Deployment Lifecycle&lt;/h2&gt;

&lt;p&gt;Please read the &lt;a href=&#34;../../development/controllers/bosh_deployment&#34;&gt;documentation for the &lt;code&gt;BOSHDeployment&lt;/code&gt; controller&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;example-deployment-manifest-conversion-details&#34;&gt;Example Deployment Manifest Conversion Details&lt;/h2&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;---&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The name of the deployment. Replace the name with the name of the BOSHDeployment resource&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# It&amp;#39;s used to namespace resources created for this deployment.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Based on docs [1], names should be less than 253 characters. We should limit this to&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# characters in the operator, to make sure that with any suffix, we won&amp;#39;t go beyond the limit.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is printed in the logs if this is present.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;director_uuid&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;bar&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A hash of director features. We could use this to control operator features as well.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;features&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Enable variables to be regenerated by the config server (e.g. CredHub) when the variable options change. Default false.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# In the cf-operator, if an QuarksSecret is changed, (e.g. a new domain is added to a cert),&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# the value will be automatically updated.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The operator won&amp;#39;t be able to control this behavior.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is printed in the logs if this is present.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;converge_variables&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Randomizes AZs for left over instances that cannot be distributed equally between AZs.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not currently used. It&amp;#39;s likely that we&amp;#39;ll be able to support this.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;randomize_az_placement&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Enables or disables returning of DNS addresses in links.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# In Kubernetes we always use DNS addresses.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# An error should be returned if this value is set to false.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;use_dns_addresses&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A list of all releases used in this deployment.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Required.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each release&amp;#39;s image reference is constructed from this information like this:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# &amp;lt;url&amp;gt;/&amp;lt;name&amp;gt;:&amp;lt;stemcell.os&amp;gt;-&amp;lt;stemcell.version&amp;gt;-&amp;lt;version&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;releases&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Name of a release used in the deployment.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;capi-release&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The version of the release to be used.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# &amp;#34;latest&amp;#34; is not supported by the cf-operator. An error is thrown if &amp;#34;latest&amp;#34; is used.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;version&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;1.0&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Required for the operator. Link to the registry and organization containing the image.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;url&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;docker.io/cloudfoundry&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Integrity of the image itself is handled by whatever&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# container runtime and the image registry.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;sha1&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;332ac15609b220a3fdf5efad0e0aa069d8235788&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Required by the operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;stemcell&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# OS of the stemcell used by the release. Used to construct the image name.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;os&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;opensuse&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Version of the OS of the stemcell used by the release.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;version&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;42.3&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Only used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A secret is created with the credentials [2], used by the pods&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# that reference this release.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;credentials&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;username&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;secret&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;stemcells&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Specifies how updates are handled&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The cf-operator uses some of these settings.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;update&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The number of pods to deploy in the new version of an QuarksStatefulSet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Once canaries are running, deployment can continue.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# TODO: Support for canaries needs implementation in QuarksStatefulSet.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;canaries&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Time to wait for canary pods to be ready in a new version of an QuarksStatefulSet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;canary_watch_time&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The maximum number of non-canary instances to update in parallel for an QuarksStatefulSet.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# TODO: Support for this needs to be implemented in the controller.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;max_in_flight&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# TODO: is there a need for this in QuarksStatefulSet (in a readiness Probe?)&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;update_watch_time&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used in cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# All instance groups are deployed at the same time.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If set to true, a warning is logged.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;serial&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used in cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If set, a warning is logged.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;vm_strategy&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each instance group is converted into an QuarksStatefulSet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;instance_groups&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Used to name the QuarksStatefulSet or QuarksJob&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;api-az1&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Support for AZs is implemented in the QuarksStatefulSet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;azs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;az1&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Number of replicas for the StatefulSets in an QuarksStatefulSet&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If this instance group defines an QuarksJob, this value must be 1. An error is thrown otherwise&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;instances&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each job results in a rendered bpm.yml file.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# BPM information is required - the deployment fails if it&amp;#39;s missing.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each job has one or more processes (defined in bpm.yml), and each   corresponds to a container of a pod in a StatefulSet or Job&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;jobs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# It&amp;#39;s used to name the container&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cloud_controller_ng&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The name of a release that must exist in the releases block.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If it doesn&amp;#39;t exist in the releases block, an error is thrown.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The docker image used for the container is resolved using this release name.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;release&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;capi-release&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Used by the cf-operator to calculate links before rendering templates.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# All resources in the cf-operator are deterministic (IP addresses are not used),&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# So they can be calculated before template rendering occurs.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;consumes&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Same as the consumes block above.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;provides&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Defines all properties, used to render job templates.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Job templates are rendered as Secrets, and then mounted into pod containers.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If a property is changed, the operator runs rendering in an QuarksJob, and the&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# template&amp;#39;s secret is (re)generated.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# All properties are input to this QuarksJob that does rendering.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Some properties can reference variables, which can be generated. The cf-operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# collects values for all properties before starting the rendering process.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;properties&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;domain&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;mycf.com&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;admin_password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;((adminpass))&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Extra information specific to the cf-operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;quarks&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;run&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Hints for pod replica count&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;scaling&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;min&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;max&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;3&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;ha&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Extra capabilities required by the containers of this job&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;capabilities&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Memory used by each container. Overrides info from vm_resources.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;memory&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;128&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Number of vCPUs used by each container. Overrides info from vm_resources.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;virtual-cpus&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Healthcheck information for the containers in this job.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;healthcheck&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;some_process_name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;readiness&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;                &lt;/span&gt;exec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;                  &lt;/span&gt;command&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;                  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;curl --silent --fail --head http://${HOSTNAME}:8080/health&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# List of ports to be opened up for this job.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;ports&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;health-port&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;protocol&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;TCP&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;internal&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;8080&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;vm_type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;vm_extensions&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Used by the cf-operator to limit the resources used by a container in a pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;vm_resources&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Number of vCPUs used by a container&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;cpu&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;4&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Memory used by a container&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;ram&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1024&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Used for PVC sizes if `ephemeralAsPVC` is set to true&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;ephemeral_disk_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;4096&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;stemcell&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Size of the volume attached to a pod container.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;persistent_disk&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;4096&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# This must be the name of a StorageClass used by the cf-operator to create volumes.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;persistent_disk_type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;default&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this key is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;networks&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;static_ips&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;default&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Specific update settings for this instance group. Use this to override global job update settings on a per-instance-group basis.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;update&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# TODO: understand how instance group renames can occur in an QuarksStatefulSet or QuarksJob&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;migrated_from&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cloud_controller&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# This is the key that controls how an instance group is treated by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If lifecycle is &amp;#34;service&amp;#34;, an QuarksStatefulSet is created for the instance group.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Otherwise, if it&amp;#39;s &amp;#34;errand&amp;#34;, an QuarksJob is created. As with normal BOSH, errands have a&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# manual trigger, so QuarksJobs have to support this (manual triggers).&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# In Kubernetes we also need errands that can run on a trigger. These are not supported by BOSH.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The lifecycle for such an QuarksJob is &amp;#34;auto-errand&amp;#34;.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Manual triggers are supported by QuarksJobs&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;lifecycle&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;service&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Deprecated - the cf-operator does not support this key.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# An error is thrown if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;properties&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Usually used for BOSH Agent configuration.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# We can use this hash to control how the operator generates resources, however&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# none of the settings used by the Agent are supported by the operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;env&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;persistent_disk_fs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;ext4&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;persistent_disk_mount_options&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;bosh&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;Hash&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;optional&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;foo&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;keep_root_password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;vcap&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;remove_dev_tools&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;remove_static_libraries&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;.&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;swap_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;100&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;ipv6&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;enable&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;job_dir&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;tmpfs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;tmpfs_size&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;0m&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;agent&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not used by the cf-operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A warning is logged if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;tmpfs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Used by the cf-operator to set kubernetes-specific information&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# for the resources representing this instance group.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;settings&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Affinity information for this instance group&amp;#39;s pod.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# These definitions are merged directly into the pod&amp;#39;s definition.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The structure is the same as the one used by Kube [3].&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;affinity&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Labels to add to the resources representing the instance group&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Annotations to add to the resources representing the instance group&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;annotations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Ops files that are applied on top of instance group properties yaml or BPM data yaml&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;preRenderOps&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;bpm&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;replace&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;path&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/foo&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;value&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;bar&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;instanceGroup&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;replace&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;path&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/foo&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;value&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;bar&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# disable_log_sidecar is an option to disable log sidecar&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;disable_log_sidecar&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# serviceAccountName is the name of the ServiceAccount to use to run this pod.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;serviceAccountName&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;kubecf&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# automountServiceAccountToken indicates whether a service account token should be automatically mounted&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;automountServiceAccountToken&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# ImagePullSecrets is an optional list of references to secrets to use for pulling any of the images.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# This field in PodSpec can be automated by setting the imagePullSecrets in a serviceAccount.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;imagePullSecrets&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Tolerations and taints are a concept defined in kubernetes to repel pods from nodes. [4]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;tolerations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# If this is set to true, the operator will define a PersistentVolumeClaim template&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# on the QuarksStatefulSet of the instance group, and it will use that PVC for all volume&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# mounts for ephemeral disks&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;ephemeralAsPVC&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;false&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# This sets the backoffLimit for the jobs running errands. If not set, it will use the Kube default which is 6.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# https://kubernetes.io/docs/concepts/workloads/controllers/jobs-run-to-completion/#handling-pod-and-container-failures&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;jobBackoffLimit&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;6&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# An array of disks to be mounted on the containers&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;disks&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# A PersistentVolumeClaim to be used as a template in the StatefulSet of the instance group.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;pvc&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;foo&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;storageClassName&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;persistent&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Volume definition to be included in the pod.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;volume&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;extravolume&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;emptyDir&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Volume mounts to be set on the containers that match the job and process set in &amp;#34;filters&amp;#34;.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;volumeMount&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;extravolume&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;mountPath&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/var/vcap/data/rep&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Filters to identify on which containers to apply the volume mounts.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;filters&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;job_name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cflinuxfs3-rootfs-setup&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;process_name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;test-server&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each addon job is added to the desired manifest before it&amp;#39;s persisted&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not all placement rules are supported, see below for more details.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;addons&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The name of the addon is not used by the operator.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# TODO: investigate whether it&amp;#39;s useful to  set this in an annotation of the instance group sts/pod&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;foo&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# All jobs are added to instance groups based on placement rules before the desired manifest is persisted&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;jobs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;metron&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;release&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;loggregator-release&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;properties&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;loggregator&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;metron&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;log_level&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;debug&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;include&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Supported&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;stemcell&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;os&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;opensuse&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not supported, addons are used per-deployment&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;deployments&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Supported&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;jobs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cloud_controller_ng&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;release&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;capi-release&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Supported&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;instance_groups&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;api&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;diego-cell&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not supported&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;networks&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Not supported&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;teams&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# The same matchers are supported as the &amp;#34;include&amp;#34; key&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;exclude&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Deprecated - the cf-operator does not support this key.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# An error is thrown if this is set.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;properties&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# For each variable, the cf-operator creates QuarksSecrets&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# As with normal BOSH, variables are referenced by job properties.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Each variable&amp;#39;s generated secret is mounted in the container that renders each job&amp;#39;s&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# templates. They are then used by the rendering process.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# This means that the operator needs to look at the job&amp;#39;s properties, and parse any references&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# to variables, so it knows what it needs to mount.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;variables&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Unique name used to identify a variable. Used to name the QuarksSecret&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;adminPass&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# As with normal BOSH, supported types are certificate, password, rsa, and ssh.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;password&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Specifies generation options&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;options&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{is_ca&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;common_name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;some-ca&amp;#34;&lt;/span&gt;}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# Tags are transformed into annotations for the resources created&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# by this deployment.&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;tags&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;maintainer&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;Philip J. Fry&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;[1] &lt;a href=&#34;https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[2] &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[3] &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[4] &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;bpm&#34;&gt;BPM&lt;/h2&gt;

&lt;p&gt;In a BOSH release some jobs have BPM configuration in &lt;code&gt;templates/bpm.yml.erb&lt;/code&gt;. Each process specified in the BPM configuration is run in a single Kubernetes &lt;code&gt;Container&lt;/code&gt; as part of a &lt;code&gt;Pod&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The following subsections describe the mapping of BPM configuration into containers.&lt;/p&gt;

&lt;h3 id=&#34;entrypoint-environment-variables&#34;&gt;Entrypoint &amp;amp; Environment Variables&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Bosh&lt;/th&gt;
&lt;th&gt;Kube Pod Container&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;executable&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;command&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;args&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;args&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;env&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;env&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;resources&#34;&gt;Resources&lt;/h3&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Bosh&lt;/th&gt;
&lt;th&gt;Kube Pod Container&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;workdir&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;workingDir&lt;/code&gt;. Not implemented yet.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;hooks&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;initContainers&lt;/code&gt;. and container hooks. Not implemented yet.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;process.capabilities&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;container.SecurityContext.Capabilities&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;limits&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;container.Resources.Limits&lt;/code&gt;. Not implemented yet.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ephemeral_disk&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;emptyDir&lt;/code&gt; volumes by default, but can be &lt;code&gt;PersistentVolumeClaims&lt;/code&gt; if &lt;code&gt;ephemeralAsPVC&lt;/code&gt; is set on the &lt;code&gt;bosh.agent.settings&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;persistent_disk&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;PersistentVolumeClaims&lt;/code&gt;. Not yet implemented.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;additional_volumes&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;emptyDir&lt;/code&gt;. Paths under /var/vcap/store are currently ignored.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;unsafe.unrestricted_volumes&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;emptyDir&lt;/code&gt;. Paths under /var/vcap/store are currently ignored.&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;unsafe.privileged&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;container.SecurityContext.Privileged&lt;/code&gt;.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&#34;health-checks&#34;&gt;Health checks&lt;/h3&gt;

&lt;p&gt;BPM doesn&amp;rsquo;t provide information for health checks and relies on monit instead.
CF-Operator provides health checks via the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/blob/master/pkg/bosh/manifest/containerization.go#L11&#34; target=&#34;_blank&#34;&gt;quarks&lt;/a&gt; property key in the deployment manifest.&lt;/p&gt;

&lt;p&gt;In Kubernetes, we use &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-probes/&#34; target=&#34;_blank&#34;&gt;liveness and readiness probes&lt;/a&gt; for healthchecks.&lt;/p&gt;

&lt;h3 id=&#34;hooks&#34;&gt;Hooks&lt;/h3&gt;

&lt;p&gt;BPM supports &lt;code&gt;pre_start&lt;/code&gt; hooks. CF-Operator will convert those to additional init containers.&lt;/p&gt;

&lt;h3 id=&#34;misc&#34;&gt;Misc&lt;/h3&gt;

&lt;p&gt;In addition, there are configuration variables that are not available in Bosh but are required for scaling in a kubernetes environment.&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Job spec in Manifest&lt;/th&gt;
&lt;th&gt;Kube Pod Container&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;properties.quarks.bpm.processes[n].requests.cpu&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;container.Resources.Requests.cpu&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container&#34; target=&#34;_blank&#34;&gt;Guaranteed CPU&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;properties.quarks.bpm.processes[n].requests.memory&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;container.Resources.Requests.memory&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#resource-requests-and-limits-of-pod-and-container&#34; target=&#34;_blank&#34;&gt;Guaranteed memory&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&#34;conversion-details&#34;&gt;Conversion Details&lt;/h2&gt;

&lt;h3 id=&#34;calculation-of-docker-image-location-for-releases&#34;&gt;Calculation of docker image location for releases&lt;/h3&gt;

&lt;p&gt;Release image tags are immutable.
The release image locations are comprised of multiple elements:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;docker registry URL&lt;/li&gt;
&lt;li&gt;organization and repository&lt;/li&gt;
&lt;li&gt;stemcell name and version&lt;/li&gt;
&lt;li&gt;fissile version&lt;/li&gt;
&lt;li&gt;the release name and version&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Release image locations always have to be resolved in the context of an instance group/job because they depend on the stemcell that is being used.&lt;/p&gt;

&lt;p&gt;A typical release image location looks could look like &lt;code&gt;hub.docker.com/cfcontainerization/cflinuxfs3-release:opensuse-15.0-28.g837c5b3-30.263-7.0.0_233.gde0accd0-0.62.0&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The different elements are taken from different places in the manifest. Given this excerpt from a BOSH deployment manifest:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;stemcells&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;alias&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;default&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;os&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;opensuse&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;-42.3&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;version&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;28.&lt;/span&gt;g837c5b3&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;-30.263-7.0&lt;/span&gt;.0_234.gcd7d1132&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;instance_groups&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;diego-cell&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;stemcell&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;default&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;jobs&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cflinuxfs3-rootfs-setup&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;release&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cflinuxfs3&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;releases&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cflinuxfs3&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;version&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0.62.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;url&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;hub.docker.com/cfcontainerization&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;sha1&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;6466c44827c3493645ca34b084e7c21de23272b4&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;stemcell&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;os&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;opensuse&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;-15.0&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;version&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;28.&lt;/span&gt;g837c5b3&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;-30.263-7.0&lt;/span&gt;.0_233.gde0accd0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The stemcell information (name, and stemcell and fissile version) are taken from the &lt;code&gt;stemcells&lt;/code&gt; entry that matches the instance group&amp;rsquo;s stemcell alias. The registry URL including the organization, the release name, and the version come from the &lt;code&gt;releases&lt;/code&gt; entry that&amp;rsquo;s referenced from the job.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Releases can optionally specify a separate &lt;code&gt;stemcell&lt;/code&gt; section, in which case the information from the instance group stemcell is overridden.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;variables-to-quarks-secrets&#34;&gt;Variables to Quarks Secrets&lt;/h3&gt;

&lt;p&gt;For each &lt;strong&gt;Explicit BOSH Variable&lt;/strong&gt; (with a definition in the &lt;code&gt;variables&lt;/code&gt; section in the deployment manifest), the cf-operator creates an &lt;code&gt;QuarksSecret&lt;/code&gt;.
The &lt;code&gt;QuarksSecret&lt;/code&gt; is meant to generate the value required by the variable.&lt;/p&gt;

&lt;p&gt;The name of the &lt;code&gt;QuarksSecret&lt;/code&gt; is calculated like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;var-&amp;lt;VARIABLE_NAME&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The name of the final generated &lt;code&gt;Secret&lt;/code&gt; (the &lt;code&gt;secretName&lt;/code&gt; key of the &lt;code&gt;QuarksSecret&lt;/code&gt;) is calculated the same way.&lt;/p&gt;

&lt;h4 id=&#34;overriding-generated-variables&#34;&gt;Overriding generated variables&lt;/h4&gt;

&lt;p&gt;The user can also specify overrides for generated secrets using the &lt;code&gt;vars&lt;/code&gt; key in the &lt;code&gt;BOSHDeployment&lt;/code&gt; spec.&lt;/p&gt;

&lt;p&gt;These map explicit variable names to secret names.&lt;/p&gt;

&lt;p&gt;Each secret must contain the usual keys used in explicit variables (see &lt;a href=&#34;https://bosh.io/docs/variable-types/&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt; for more details).&lt;/p&gt;

&lt;p&gt;You can find an example &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/blob/master/docs/examples/bosh-deployment/boshdeployment-with-user-variable.yaml&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;instance-groups-to-quarks-statefulsets-and-jobs&#34;&gt;Instance Groups to Quarks StatefulSets and Jobs&lt;/h3&gt;

&lt;h4 id=&#34;bosh-services-vs-bosh-errands&#34;&gt;BOSH Services vs BOSH Errands&lt;/h4&gt;

&lt;p&gt;BOSH Services are converted to &lt;code&gt;QuarksStatefulSets&lt;/code&gt; and &lt;code&gt;Services&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;BOSH Errands are converted to &lt;code&gt;QuarksJobs&lt;/code&gt; with &lt;code&gt;trigger.strategy: manually&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;BOSH Auto-Errands (supported only by the operator) are converted to &lt;code&gt;QuarksJobs&lt;/code&gt; with &lt;code&gt;trigger.strategy: once&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&#34;miscellaneous&#34;&gt;Miscellaneous&lt;/h2&gt;

&lt;h3 id=&#34;dealing-with-azs&#34;&gt;Dealing with AZs&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;QuarksStatefulSets&lt;/code&gt; support AZs. You can learn more about this in &lt;a href=&#34;../../development/controllers/quarks_statefulset#az-support&#34;&gt;the docs&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;support-for-active-passive-pod-replicas&#34;&gt;Support for active/passive pod replicas&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;QuarksStatefulSets&lt;/code&gt; support active/passive pod replicas. You can learn more about this in &lt;a href=&#34;../../development/controllers/quarks_statefulset#quarksstatefulset-active-passive-controller&#34;&gt;the docs&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;ephemeral-disks&#34;&gt;Ephemeral Disks&lt;/h3&gt;

&lt;p&gt;We use an &lt;code&gt;emptyDir&lt;/code&gt; for ephemeral disks. You can learn more from &lt;a href=&#34;https://kubernetes.io/docs/concepts/storage/volumes/#emptydir&#34; target=&#34;_blank&#34;&gt;the official docs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If the setting &lt;code&gt;bosh.settings.agent.ephemeralAsPVC&lt;/code&gt; is set to &lt;code&gt;true&lt;/code&gt;, the operator will use &lt;code&gt;PersistentVolumeClaims&lt;/code&gt; instead.
This option should be used for jobs that make assumptions about ephemeral disks (like this &lt;a href=&#34;https://github.com/cloudfoundry/garden-runc-release/tree/develop/jobs/garden&#34; target=&#34;_blank&#34;&gt;garden&lt;/a&gt; job) mounts, or the size limit for the disk is critical.
If &lt;code&gt;vm_resources.ephemeral_disk_size&lt;/code&gt; is set, the PVC size will be set to this. If it&amp;rsquo;s not set, the operator will try to use &lt;code&gt;persistent_disk&lt;/code&gt; as a size. If this is not set either, the operator will use a default of &lt;code&gt;10GB&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;credentials-for-docker-registries&#34;&gt;Credentials for Docker Registries&lt;/h3&gt;

&lt;p&gt;Providing credentials for private registries is supported by Kubernetes. Please read &lt;a href=&#34;https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/#registry-secret-existing-credentials&#34; target=&#34;_blank&#34;&gt;the official docs&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;running-manual-errands&#34;&gt;Running manual errands&lt;/h3&gt;

&lt;p&gt;BOSH makes use of errands, which are manually triggered.
We support manual triggers - you can learn more in the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/blob/master/docs/quarksjob.md#errands&#34; target=&#34;_blank&#34;&gt;QuarksJob docs&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;readiness-and-liveness-probes&#34;&gt;Readiness and Liveness Probes&lt;/h3&gt;

&lt;p&gt;When the deployment manifest declares health check information for jobs, via the &lt;code&gt;quarks&lt;/code&gt; section, we configure those in Kubernetes.&lt;/p&gt;

&lt;p&gt;The probes are defined per BPM process.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Example:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;instance_groups&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;api-az1&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;process.&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;properties&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;quarks&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;run&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;healthcheck&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;bpm-process-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;readiness&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;              &lt;/span&gt;liveness&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Both keys contain information that should is used as-is for the container that matches the process name.&lt;/p&gt;

&lt;h3 id=&#34;persistent-disks&#34;&gt;Persistent Disks&lt;/h3&gt;

&lt;p&gt;When a BOSH deployment manifest declares persistent disks on instance groups, we provide a persistent volume to the containers of a pod in &lt;code&gt;/var/vcap/store&lt;/code&gt;. You can learn more about BOSH Persistent Disks in the &lt;a href=&#34;https://bosh.io/docs/persistent-disks/&#34; target=&#34;_blank&#34;&gt;BOSH Official Docs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;These volumes are mounted on each container that&amp;rsquo;s part of the instance group.&lt;/p&gt;

&lt;p&gt;The implementation uses the default storage class if not specified using the &lt;code&gt;persistent_disk_type&lt;/code&gt; key in the manifest.&lt;/p&gt;

&lt;h3 id=&#34;manual-implicit-variables&#34;&gt;Manual (&amp;ldquo;implicit&amp;rdquo;) variables&lt;/h3&gt;

&lt;p&gt;BOSH deployment manifests support two different types of variables, implicit and explicit ones.&lt;/p&gt;

&lt;p&gt;&amp;ldquo;Explicit&amp;rdquo; variables are declared in the &lt;code&gt;variables&lt;/code&gt; section of the manifest and are generated automatically before the interpolation step.&lt;/p&gt;

&lt;p&gt;&amp;ldquo;Implicit&amp;rdquo; variables just appear in the document within double parentheses without any declaration. These variables have to be provided by the user prior to creating the BOSH deployment as a secret. The secret name has to follow the scheme&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;var-&amp;lt;variable-name&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;By default the variable content is expected in the &lt;code&gt;value&lt;/code&gt; key, e.g.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;((system-domain))
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;---&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Secret&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;var-system-domain&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Opaque&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;stringData&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;value&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;example.com&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It is also possible to specify the key name after a &lt;code&gt;/&lt;/code&gt; separator, e.g.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;((ssl/ca))
&lt;/code&gt;&lt;/pre&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;---&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Secret&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;var-ssl&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Opaque&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;stringData&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;ca&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;...&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;cert&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;...&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;key&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;pre-render-scripts&#34;&gt;Pre_render_scripts&lt;/h3&gt;

&lt;p&gt;Similar to what can be achieved in SCF v1, with the &lt;a href=&#34;https://github.com/SUSE/scf/tree/develop/container-host-files/etc/scf/config/scripts/patches&#34; target=&#34;_blank&#34;&gt;patches&lt;/a&gt; scripts, the &lt;code&gt;cf-operator&lt;/code&gt; is able to support this behaviour. Basically, it allows the user to execute a custom script during runtime of the job container for a specific &lt;code&gt;instance_group&lt;/code&gt;. Because patching during runtime is always a great feature to have, for a variety of reasons, users can specify this via the &lt;code&gt;quarks.pre_render_scripts&lt;/code&gt; key.&lt;/p&gt;

&lt;p&gt;Keep it mind, that the script should belong to a type, to avoid running all scripts as a whole. Currently supported types are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;quarks.pre_render_scripts.bpm&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;quarks.pre_render_scripts.ig_resolver&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;quarks.pre_render_scripts.jobs&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This allows you to run anything, by specifying a list of commands/scripts to execute. For example:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-sh&#34; data-lang=&#34;sh&#34;&gt;instance_groups:
- name: redis-slave
  instances: &lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;
  lifecycle: errand
  azs: &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;[&lt;/span&gt;z1, z2&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;]&lt;/span&gt;
  jobs:
  - name: redis-server
    release: redis
    properties:
      quarks:
        pre_render_scripts:
          bpm:
          - &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;|&lt;/span&gt;
            touch /tmp&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;bosh-dns&#34;&gt;BOSH DNS&lt;/h3&gt;

&lt;p&gt;The BOSH DNS addon is implemented using a separate DNS server (coredns). For each BOSHDeployment, which enables this addon, an additional DNS server is created within the namespace.
This DNS server rewrites all BOSH dns requests to standard k8s queries (e.g. &lt;code&gt;api.service.cf.internal&lt;/code&gt; -&amp;gt; &lt;code&gt;api.&amp;lt;namespace&amp;gt;.svc.cluster.local&lt;/code&gt;) and forwards them to the k8s DNS server.
All pods created from the BOSHDeployment are configured to use this DNS server.&lt;/p&gt;

&lt;p&gt;Additionally the headless services are created on base of the specified aliases. The following alias&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;domain&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;blobstore.service.cf.internal&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;targets&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;deployment&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;cf&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;domain&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;bosh&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;instance_group&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;singleton-blobstore&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;network&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;default&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;query&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;will create a headless service with the name &lt;code&gt;blobstore&lt;/code&gt; instead of &lt;code&gt;singleton-blobstore&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For migration purpose, the DNS service does also a rewrite of all previous headless service names
(e.g. &lt;code&gt;singleton-blobstore&lt;/code&gt; is rewritten to &lt;code&gt;blobstore.&amp;lt;namespace&amp;gt;.svc.cluster.local&lt;/code&gt;).&lt;/p&gt;

&lt;h2 id=&#34;flow&#34;&gt;Flow&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;https://docs.google.com/drawings/d/e/2PACX-1vSsapirEQTlBvFDYjRbCxK5IJaxRqPDfTi37OcBVr60BGbDThn83HeHJyRModicUeghc7enfyYY_CHI/pub?w=1279&amp;amp;h=997&#34; alt=&#34;flow&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;naming-conventions&#34;&gt;Naming Conventions&lt;/h2&gt;

&lt;p&gt;After creating a &lt;code&gt;BOSHDeployment&lt;/code&gt; named &lt;code&gt;nats-deployment&lt;/code&gt;, with one Instance Group, the following resources should exist:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;BOSHDeployment&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats-deployment&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;QuarksJob&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;ig
dm&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;QuarksSecret&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;var-nats-password&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;QuarksStatefulSet&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;Secrets&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;bpm.nats-v1
ig-resolved.nats-v1
var-nats-password
with-ops
desired-manifest-v1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;StatefulSets&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;Pods&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats-0
nats-1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;Services&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats
nats-0
nats-1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: About operators</title>
      <link>https://quarks.suse.dev/docs/concepts/about_operators/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/concepts/about_operators/</guid>
      <description>
        
        
        

&lt;h1 id=&#34;about-operators&#34;&gt;About Operators&lt;/h1&gt;

&lt;h2 id=&#34;framework-controller-runtime&#34;&gt;Framework: Controller Runtime&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://book.kubebuilder.io/&#34; target=&#34;_blank&#34;&gt;Kubebuilder docs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://godoc.org/github.com/kubernetes-sigs/controller-runtime/pkg&#34; target=&#34;_blank&#34;&gt;controller-runtime docs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;operator-pattern-features&#34;&gt;Operator Pattern &amp;amp; Features&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Operator pattern&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://admiralty.io/blog/kubernetes-custom-resource-controller-and-operator-development-tools/&#34; target=&#34;_blank&#34;&gt;Kubernetes Custom Resource Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.slideshare.net/Jakobkaralus/the-kubernetes-operator-pattern-containerconf-nov-2017&#34; target=&#34;_blank&#34;&gt;The Kubernetes Operator Pattern&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Admission webhooks and eventing&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://book.kubebuilder.io/beyond_basics/sample_webhook.html&#34; target=&#34;_blank&#34;&gt;Sample Webhook&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://schd.ws/hosted_files/kccncchina2018english/50/kubecon_Tom_Ilya_CRDs.pdf&#34; target=&#34;_blank&#34;&gt;Custom Resource Definitions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Finalizers&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#finalizers&#34; target=&#34;_blank&#34;&gt;Finalizers - Official Docs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/giantswarm/operatorkit/blob/master/docs/using_finalizers.md&#34; target=&#34;_blank&#34;&gt;Using Finalizers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Watches&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://book.kubebuilder.io/beyond_basics/controller_watches.html&#34; target=&#34;_blank&#34;&gt;Controller Watches&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Generate resources&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.openshift.com/kubernetes-deep-dive-code-generation-customresources/&#34; target=&#34;_blank&#34;&gt;Code Generation for Custom Resources&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Apply CRD&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/velotio-perspectives/extending-kubernetes-apis-with-custom-resource-definitions-crds-139c99ed3477&#34; target=&#34;_blank&#34;&gt;Extending Kubernetes APIs using CRDs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;operator-examples&#34;&gt;Operator Examples&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/upmc-enterprises/elasticsearch-operator&#34; target=&#34;_blank&#34;&gt;Elastic Search Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/zalando-incubator/postgres-operator&#34; target=&#34;_blank&#34;&gt;Postgres Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubeflow/tf-operator&#34; target=&#34;_blank&#34;&gt;Tensorflow Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/nats-io/nats-operator&#34; target=&#34;_blank&#34;&gt;NATS Operator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/knative/serving/blob/059bf5f8c193148e54ddac37fba337c2cf6496db/cmd/controller/main.go#L144&#34; target=&#34;_blank&#34;&gt;Knative&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/kubernetes/sample-controller&#34; target=&#34;_blank&#34;&gt;Sample controller&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;extending-kubernetes&#34;&gt;Extending Kubernetes&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://engineering.bitnami.com/articles/a-deep-dive-into-kubernetes-controllers.html&#34; target=&#34;_blank&#34;&gt;Controller pattern&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/@trstringer/create-kubernetes-controllers-for-core-and-custom-resources-62fc35ad64a3&#34; target=&#34;_blank&#34;&gt;Custom controllers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/access-kubernetes-api/custom-resources/custom-resource-definitions/#validation&#34; target=&#34;_blank&#34;&gt;CRD openAPI validation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.amazon.de/Kubernetes-Design-Patterns-Extensions-container-cluster-ebook/dp/B07HSZHRHZ&#34; target=&#34;_blank&#34;&gt;Kubernetes primitives (ebook)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;testing&#34;&gt;Testing&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/thtanaka/kubernetes/blob/master/docs/devel/testing.md#integration-tests&#34; target=&#34;_blank&#34;&gt;Kubernetes docs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://itnext.io/testing-kubernetes-go-applications-f1f87502b6ef&#34; target=&#34;_blank&#34;&gt;Kubernetes fakes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://speakerdeck.com/skmetz/magic-tricks-of-testing-railsconf&#34; target=&#34;_blank&#34;&gt;Magic tricks of testing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Bosh Deployment</title>
      <link>https://quarks.suse.dev/docs/development/controllers/bosh_deployment/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/bosh_deployment/</guid>
      <description>
        
        
        

&lt;h1 id=&#34;boshdeployment&#34;&gt;BOSHDeployment&lt;/h1&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#boshdeployment&#34;&gt;BOSHDeployment&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#description&#34;&gt;Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bdpl-component&#34;&gt;BDPL Component&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#boshdeployment-controller&#34;&gt;BOSHDeployment Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-bdpl-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-bdpl-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-bdpl-controller&#34;&gt;Highlights&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#generate-variables-controller&#34;&gt;Generate Variables Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-gv-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-gv-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-gv-controller&#34;&gt;Highlights&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bpm-controller&#34;&gt;BPM Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-bpm-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-bpm-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-bpm-controller&#34;&gt;Highlights&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#bdpl-abstract-view&#34;&gt;BDPL Abstract view&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#boshdeployment-resource-examples&#34;&gt;BOSHDeployment resource examples&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;[BOSHDeployment status][#boshdeployment-status]&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;A BOSH deployment is created from a deployment manifest and optionally ops files.&lt;/p&gt;

&lt;p&gt;The deployment manifest is based on a vanilla BOSH deployment manifest.
The ops files modify the deployment manifest. For example, ops files can be used to replace release tarballs with &lt;a href=&#34;https://ci.flintstone.cf.cloud.ibm.com/teams/containerization/pipelines/release-images&#34; target=&#34;_blank&#34;&gt;docker images&lt;/a&gt;, thus enabling deployment on Kubernetes.&lt;/p&gt;

&lt;p&gt;A deployment is represented by the &lt;code&gt;boshdeployments.quarks.cloudfoundry.org&lt;/code&gt; (&lt;code&gt;bdpl&lt;/code&gt;) custom resource, defined in &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/crds/quarks_v1alpha1_boshdeployment_crd.yaml&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;boshdeployment_crd.yaml&lt;/code&gt;&lt;/a&gt;.
This &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/bosh-deployment/boshdeployment.yaml&#34; target=&#34;_blank&#34;&gt;bdpl custom resource&lt;/a&gt; contains references to config maps or secrets containing the actual manifests content.&lt;/p&gt;

&lt;p&gt;The name of the &lt;code&gt;bdpl&lt;/code&gt; resource is the &lt;a href=&#34;https://bosh.io/docs/manifest-v2/#deployment&#34; target=&#34;_blank&#34;&gt;deployment name&lt;/a&gt;. The name in the BOSH manifest is ignored.&lt;/p&gt;

&lt;p&gt;After creating the &lt;code&gt;bdpl&lt;/code&gt; resource on Kubernetes, i.e. via &lt;code&gt;kubectl apply&lt;/code&gt;, the CF operator will start reconciliation, which will eventually result in the deployment
of the BOSH release on Kubernetes.&lt;/p&gt;

&lt;h2 id=&#34;bdpl-component&#34;&gt;BDPL Component&lt;/h2&gt;

&lt;p&gt;The &lt;strong&gt;BOSHDeployment&lt;/strong&gt; component is a categorization of a set of controllers, under the same group. Inside the &lt;strong&gt;BDPL&lt;/strong&gt; component we have a set of 3 controllers together with one separate reconciliation loop per controller to deal with &lt;code&gt;BOSH deployments&lt;/code&gt;(end user input)&lt;/p&gt;

&lt;p&gt;Figure 1 is a &lt;strong&gt;BDPL&lt;/strong&gt; component diagram that covers the set of controllers it uses and their relationship with other components(e.g. &lt;code&gt;QuarksJob&lt;/code&gt;, &lt;code&gt;QuarksSecret&lt;/code&gt; and &lt;code&gt;QuarksStatefulSet&lt;/code&gt;)&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_bdplcomponent_flow.png&#34; alt=&#34;bdpl-component-flow&#34; /&gt;
&lt;em&gt;Fig. 1: The BOSHDeployment component&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Figure 1 illustrates a couple of things. Firstly, at the very top, we have the &lt;code&gt;cf-operator&lt;/code&gt; , which is a long running application with a namespaced scope. When the &lt;code&gt;cf-operator&lt;/code&gt; pod is initialized it will automatically register all controllers with the &lt;a href=&#34;https://kubernetes.io/docs/reference/command-line-tools-reference/kube-controller-manager/&#34; target=&#34;_blank&#34;&gt;Kubernetes Controller Manager&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;While at a first glance the above diagram looks complex, it can be explained easily by focusing on each controller´s main functions: &lt;code&gt;Reconciliation &amp;amp; Watch&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;boshdeployment-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;BOSHDeployment Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_bdplcontroller_flow.png&#34; alt=&#34;bdpl-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 2: The BOSHDeployment controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is the controller that manages the end user input(a BOSH manifest).&lt;/p&gt;

&lt;h4 id=&#34;watches-in-bdpl-controller&#34;&gt;Watches in BDPL controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;BOSHDeployment&lt;/code&gt;: Create&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ConfigMaps&lt;/code&gt;: Update&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Secrets&lt;/code&gt;: Create and Update&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-bdpl-controller&#34;&gt;Reconciliation in BDPL controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;generates &lt;code&gt;.with-ops&lt;/code&gt; secret, that contains the deployment manifest, with all ops files applied&lt;/li&gt;
&lt;li&gt;generates &lt;code&gt;variable interpolation&lt;/code&gt; &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/tree/master/README.md#one-off-jobs-auto-errands&#34; target=&#34;_blank&#34;&gt;&lt;strong&gt;QuarksJob&lt;/strong&gt;&lt;/a&gt; resource&lt;/li&gt;
&lt;li&gt;generates &lt;code&gt;data gathering&lt;/code&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt; resource&lt;/li&gt;
&lt;li&gt;generates &lt;code&gt;BPM configuration&lt;/code&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt; resource&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;highlights-in-bdpl-controller&#34;&gt;Highlights in BDPL controller&lt;/h4&gt;

&lt;p&gt;Transform the concepts of BOSH into Kubernetes resources:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;BOSH &lt;code&gt;errands&lt;/code&gt; to &lt;code&gt;QuarksJob&lt;/code&gt; CRD instances&lt;/li&gt;
&lt;li&gt;BOSH &lt;code&gt;instance_groups&lt;/code&gt; to &lt;code&gt;QuarksStatefulSet&lt;/code&gt; CRD instances&lt;/li&gt;
&lt;li&gt;BOSH &lt;code&gt;variables&lt;/code&gt; to &lt;code&gt;QuarksSecret&lt;/code&gt; CRD instance&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;All of the three created &lt;em&gt;QuarksJob&lt;/em&gt; instances will eventually persist their STDOUT into new secrets under the same namespace.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;The output of the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/commands/cf-operator_util_variable-interpolation.md&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;variable interpolation&lt;/code&gt;&lt;/a&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt; ends up as the &lt;code&gt;.desired-manifest-v1&lt;/code&gt; &lt;strong&gt;secret&lt;/strong&gt;, which is a versioned secret. At the same time this secret serves as the input for the &lt;code&gt;data gathering&lt;/code&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;The output of the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/commands/cf-operator_util_instance-group.md&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;data gathering&lt;/code&gt;&lt;/a&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt;, ends up
as the &lt;code&gt;.ig-resolved.&amp;lt;instance_group_name&amp;gt;-v1&lt;/code&gt; versioned secret.&lt;/li&gt;
&lt;li&gt;The output of the &lt;code&gt;BPM configuration&lt;/code&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt;, ends up as the &lt;code&gt;bpm.&amp;lt;instance_group_name&amp;gt;-v1&lt;/code&gt; versioned secret.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;generate-variables-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;Generate Variables Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_gvariablecontroller_flow.png&#34; alt=&#34;quarks_gvariablecontroller_flow.png&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Fig. 3: The Generated Variables controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is the controller that is responsible for auto-generating certificates, passwords and other secrets declared in the manifest. In other words, it translates all BOSH variables into custom Kubernetes primitive resources. It does this with the help of &lt;code&gt;QuarksSecrets&lt;/code&gt;. It watches the &lt;code&gt;.with-ops&lt;/code&gt; secret, retrieves the list of BOSH variables and triggers the generation of &lt;code&gt;QuarksSecrets&lt;/code&gt; per item in that list.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-gv-controller&#34;&gt;Watches in GV controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Secrets&lt;/code&gt;: Create and Update.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-gv-controller&#34;&gt;Reconciliation in GV controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;generates &lt;code&gt;QuarksSecrets&lt;/code&gt; resources.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;highlights-in-gv-controller&#34;&gt;Highlights in GV controller&lt;/h4&gt;

&lt;p&gt;The &lt;code&gt;secrets&lt;/code&gt; resources,  generated by these &lt;code&gt;QuarksSecrets&lt;/code&gt; are referenced by the &lt;code&gt;variable interpolation&lt;/code&gt; &lt;strong&gt;QuarksJob&lt;/strong&gt;. When these secrets are created/updated, the variable interpolation QuarksJob is run.&lt;/p&gt;

&lt;h3 id=&#34;bpm-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;BPM Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_bpm-controller_flow.png&#34; alt=&#34;bpm-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 4: The BPM controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The BPM controller has the responsibility to generate Kubernetes resources per &lt;code&gt;instance_group&lt;/code&gt;. It is triggered for each &lt;code&gt;instance_group&lt;/code&gt; in the desired manifest, since we generate one BPM Secret for each. The reconciler starts each &lt;code&gt;instance_group&lt;/code&gt; as its corresponding secret is created. It &lt;em&gt;does not wait&lt;/em&gt; for all secrets to be ready.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-bpm-controller&#34;&gt;Watches in BPM controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/blob/master/docs/quarksjob.md#versioned-secrets&#34; target=&#34;_blank&#34;&gt;&lt;code&gt;versioned secrets&lt;/code&gt;&lt;/a&gt;: Create and Update.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-bpm-controller&#34;&gt;Reconciliation in BPM controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Render BPM resources per &lt;code&gt;instance_group&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Convert &lt;code&gt;instance_groups&lt;/code&gt; of the type &lt;code&gt;services&lt;/code&gt; to &lt;code&gt;QuarksStafulSet&lt;/code&gt; resources.&lt;/li&gt;
&lt;li&gt;Convert &lt;code&gt;instance_groups&lt;/code&gt; of the type &lt;code&gt;errand&lt;/code&gt; to &lt;code&gt;QuarksJob&lt;/code&gt; resources.&lt;/li&gt;
&lt;li&gt;Generates Kubernetes services that will expose ports for the &lt;code&gt;instance_groups&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Generate require PVC´s.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;highlights-in-bpm-controller&#34;&gt;Highlights in BPM controller&lt;/h4&gt;

&lt;p&gt;The &lt;strong&gt;Secrets&lt;/strong&gt; watched by the BPM Reconciler are &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/blob/master/docs/quarksjob.md#versioned-secrets&#34; target=&#34;_blank&#34;&gt;Versioned Secrets&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Resources are &lt;em&gt;applied&lt;/em&gt; using an &lt;strong&gt;upsert technique&lt;/strong&gt; &lt;a href=&#34;https://godoc.org/sigs.k8s.io/controller-runtime/pkg/controller/controllerutil#CreateOrUpdate&#34; target=&#34;_blank&#34;&gt;implementation&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Any resources that are no longer required are deleted.&lt;/p&gt;

&lt;p&gt;As the &lt;code&gt;BOSHDeployment&lt;/code&gt; is deleted, all owned resources are automatically deleted in a cascading fashion.&lt;/p&gt;

&lt;p&gt;Persistent volumes are left behind.&lt;/p&gt;

&lt;h2 id=&#34;bdpl-abstract-view&#34;&gt;BDPL Abstract view&lt;/h2&gt;

&lt;p&gt;Figure 5 is a diagram that explains the whole &lt;code&gt;BOSHDeployment&lt;/code&gt; component controllers flow, in a more high level perspective.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://docs.google.com/drawings/d/e/2PACX-1vTsCO5USd8AJIk_uHMRKl0NABuW85uVGJNebNvgI0Hz_9jhle6fcynLTcHh8cxW6lMgaV_DWyPEvm2-/pub?w=3161&amp;amp;h=2376&#34; alt=&#34;deployment-state&#34; /&gt;
&lt;a href=&#34;https://docs.google.com/drawings/d/126ExNqPxDg1LcB14pbtS5S-iJzLYPyXZ5Jr9vTfFqXA/edit?usp=sharing&#34; target=&#34;_blank&#34;&gt;edit&lt;/a&gt;
&lt;em&gt;Fig. 5: The BOSHDeployment component controllers interactions&lt;/em&gt;&lt;/p&gt;

&lt;h2 id=&#34;boshdeployment-resource-examples&#34;&gt;BOSHDeployment resource examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/bosh-deployment&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/bosh-deployment&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;boshdeployment-status&#34;&gt;BOSHDeployment status&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;BOSHDeployment&lt;/code&gt; status is resolved by a &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/blob/c6480811376faf81d6edadb62fcd0c7951e173c1/pkg/kube/controllers/boshdeployment/status_reconciler.go&#34; target=&#34;_blank&#34;&gt;separate controller&lt;/a&gt; which tracks the status of &lt;code&gt;QuarksJob&lt;/code&gt; and &lt;code&gt;QuarksStatefulSet&lt;/code&gt; associated with a deployment.
The controller annotates the instance groups and the jobs counters and it resolves the BDPL State (&lt;code&gt;Deployed&lt;/code&gt;, &lt;code&gt;Converting&lt;/code&gt; , &lt;code&gt;Resolving&lt;/code&gt;) by looking at the associated resources states and computing the overall state.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;BOSHDeployment&lt;/code&gt; status spec is composed of the following fields:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-golang&#34; data-lang=&#34;golang&#34;&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// BOSHDeploymentStatus defines the observed state of BOSHDeployment
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#000&#34;&gt;BOSHDeploymentStatus&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;{&lt;/span&gt;
	&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;// Timestamp for the last reconcile
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;&lt;/span&gt;	&lt;span style=&#34;color:#000&#34;&gt;LastReconcile&lt;/span&gt;          &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;metav1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Time&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;lastReconcile&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;State&lt;/span&gt;                  &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;       &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;state&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;Message&lt;/span&gt;                &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;string&lt;/span&gt;       &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;message&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;TotalJobCount&lt;/span&gt;          &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;int&lt;/span&gt;          &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;totalJobCount&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;CompletedJobCount&lt;/span&gt;      &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;int&lt;/span&gt;          &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;completedJobCount&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;TotalInstanceGroups&lt;/span&gt;    &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;int&lt;/span&gt;          &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;totalInstanceGroups&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;DeployedInstanceGroups&lt;/span&gt; &lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;int&lt;/span&gt;          &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;deployedInstanceGroups&amp;#34;`&lt;/span&gt;
	&lt;span style=&#34;color:#000&#34;&gt;StateTimestamp&lt;/span&gt;         &lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;metav1&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;.&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;Time&lt;/span&gt; &lt;span style=&#34;color:#4e9a06&#34;&gt;`json:&amp;#34;stateTimestamp&amp;#34;`&lt;/span&gt;
&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;BOSHDeployment&lt;/code&gt; States can be:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Created&lt;/li&gt;
&lt;li&gt;Converting to Kubernetes Resources&lt;/li&gt;
&lt;li&gt;Resolving Manifest&lt;/li&gt;
&lt;li&gt;Deployed&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;where &amp;ldquo;Deployed&amp;rdquo; is the final state. Note that during deployments, the lifecycle might vary if the same resources are updated subsequently: the status of a &lt;code&gt;BOSHDeployment&lt;/code&gt; may go back from &lt;code&gt;Deployed&lt;/code&gt; to &lt;code&gt;Converting&lt;/code&gt; and &lt;code&gt;Resolving&lt;/code&gt; again if updates to the manifest are triggered.&lt;/p&gt;

&lt;p&gt;The Reconcile resolves to the Deployed state by looking at the overall counts of &lt;code&gt;QuarksJobs&lt;/code&gt; and &lt;code&gt;QuarksStatefulSet&lt;/code&gt; associated to the &lt;code&gt;BOSHDeployment&lt;/code&gt; and its state:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Converting&lt;/code&gt;: All &lt;code&gt;QuarksJobs&lt;/code&gt; belonging to a &lt;code&gt;BOSHDeployment&lt;/code&gt; are completed, but &lt;code&gt;QuarksStatefulSet&lt;/code&gt; aren&amp;rsquo;t ready yet ( or either way around )&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Resolving&lt;/code&gt;: &lt;code&gt;QuarksJobs&lt;/code&gt; belonging to a &lt;code&gt;BOSHDeployment&lt;/code&gt; aren&amp;rsquo;t completed, &lt;code&gt;QuarksStatefulSet&lt;/code&gt; aren&amp;rsquo;t ready yet&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Deployed&lt;/code&gt;: All &lt;code&gt;QuarksJobs&lt;/code&gt; and &lt;code&gt;QuarksStatefulSet&lt;/code&gt; are ready/completed.&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: BOSH Variables</title>
      <link>https://quarks.suse.dev/docs/features/variables/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/variables/</guid>
      <description>
        
        
        

&lt;p&gt;BOSH releases consume two types of variables, explicit and implicit ones.&lt;/p&gt;

&lt;h3 id=&#34;implicit-variables&#34;&gt;Implicit Variables&lt;/h3&gt;

&lt;p&gt;Implicit variables have to be created before creating a BOSH deployment resource.
The &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator/blob/master/docs/examples/bosh-deployment/boshdeployment-with-custom-variable.yaml&#34; target=&#34;_blank&#34;&gt;example&lt;/a&gt; creates a secret named &lt;code&gt;var-custom-password&lt;/code&gt;. That value will be used to fill &lt;code&gt;((custom-password))&lt;/code&gt; place holders in the BOSH manifest.&lt;/p&gt;

&lt;p&gt;The name of the secret has to follow this scheme: &amp;lsquo;var-&lt;variable-name&gt;&amp;lsquo;&lt;/p&gt;

&lt;p&gt;Missing implicit variables are treated as an error.&lt;/p&gt;

&lt;h3 id=&#34;explicit-variables&#34;&gt;Explicit Variables&lt;/h3&gt;

&lt;p&gt;Explicit variables are explicitly defined in the &lt;a href=&#34;https://bosh.io/docs/manifest-v2/#variables&#34; target=&#34;_blank&#34;&gt;BOSH manifest&lt;/a&gt;. They are generated automatically upon deployment and stored in secrets.&lt;/p&gt;

&lt;p&gt;The naming scheme is the same as for implicit variables.&lt;/p&gt;

&lt;p&gt;If an explicit variable secret already exists, it will not be generated. This allows users to set their own passwords, etc.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Labels</title>
      <link>https://quarks.suse.dev/docs/development/labels/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/labels/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/deployment-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentSecretType&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/secret-type&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentVersion&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/deployment-version&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelInstanceGroupName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/instance-group-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelReferencedJobName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/referenced-job-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelAZIndex&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/az-index&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelAZName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/az-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelActivePod&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/pod-active&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelPodOrdinal&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/pod-ordinal&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelQStsName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/quarks-statefulset-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qsv1a1.LabelKind&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/secret-kind&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;delete&lt;/code&gt; = pod&lt;/li&gt;
&lt;li&gt;&lt;code&gt;variableName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;app&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&#34;data-from-tests&#34;&gt;Data From Tests&lt;/h1&gt;

&lt;h2 id=&#34;configmaps&#34;&gt;ConfigMaps&lt;/h2&gt;

&lt;h3 id=&#34;secret-rotation-configmap&#34;&gt;Secret Rotation ConfigMap&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-rotation = yes
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;qjob&#34;&gt;QJob&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = bosh-manifest-two-instance-groups
delete=pod
quarks.cloudfoundry.org/deployment-version = 1
quarks.cloudfoundry.org/instance-group-name = nats-smoke-tests
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;qjob-job&#34;&gt;QJob Job&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/qjob-name = ig-bosh-manifest-two-instance-groups
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;pod-from-job&#34;&gt;Pod from Job&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;delete=pod
quarks.cloudfoundry.org/qjob-name=dm-test
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;qsts&#34;&gt;QSTS&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = test
quarks.cloudfoundry.org/deployment-version = 1
quarks.cloudfoundry.org/instance-group-name = nats
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;sts&#34;&gt;STS&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/quarks-statefulset-name=test-nats
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;sts-pod&#34;&gt;STS Pod&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/pod-active=active|true
quarks.cloudfoundry.org/pod-ordinal=0
quarks.cloudfoundry.org/quarks-statefulset-name=test-nats
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;service&#34;&gt;Service&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/pod-ordinal=0
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;qsec&#34;&gt;QSec&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = test
variableName = nats_password
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;qsec-secret&#34;&gt;QSec Secret&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-kind=generated
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;secrets&#34;&gt;Secrets&lt;/h2&gt;

&lt;h3 id=&#34;withops-secrets&#34;&gt;WithOps Secrets&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/secret-type=with-ops
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;desired-manifest-secret&#34;&gt;Desired Manifest Secret&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=desired-manifest
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testdesired-manifest
quarks.cloudfoundry.org/referenced-job-name=instance-group-test
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=desired
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;bpm-secret&#34;&gt;BPM Secret&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testbpmnats
quarks.cloudfoundry.org/remote-id=nats
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=bpm
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;ig-resolved-secret&#34;&gt;IG Resolved Secret&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testig-resolvednats
quarks.cloudfoundry.org/remote-id=nats
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=ig-resolved
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;link-secret&#34;&gt;Link Secret&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=link-test-nats-nats
quarks.cloudfoundry.org/remote-id=nats
&lt;/code&gt;&lt;/pre&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Cloud Foundry Operator</title>
      <link>https://quarks.suse.dev/docs/concepts/operator/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/concepts/operator/</guid>
      <description>
        
        
        

&lt;div class=&#34;pageinfo pageinfo-primary&#34;&gt;
&lt;p&gt;The CF-Operator is a Cloud Foundry Incubating Project.&lt;/p&gt;

&lt;/div&gt;


&lt;p&gt;&lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/&#34; target=&#34;_blank&#34;&gt;cf-operator&lt;/a&gt; enables the deployment of BOSH Releases, especially Cloud Foundry, to Kubernetes.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s implemented as a k8s operator, an active controller component which acts upon custom k8s resources.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/#installing&#34; target=&#34;_blank&#34;&gt;Installation notes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Incubation Proposal: &lt;a href=&#34;https://docs.google.com/document/d/1_IvFf-cCR4_Hxg-L7Z_R51EKhZfBqlprrs5NgC2iO2w/edit#heading=h.lybtsdyh8res&#34; target=&#34;_blank&#34;&gt;Containerizing Cloud Foundry&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Slack: #quarks-dev on &lt;a href=&#34;https://slack.cloudfoundry.org/&#34; target=&#34;_blank&#34;&gt;https://slack.cloudfoundry.org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Backlog: &lt;a href=&#34;https://www.pivotaltracker.com/n/projects/2192232&#34; target=&#34;_blank&#34;&gt;Pivotal Tracker&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Docker: &lt;a href=&#34;https://hub.docker.com/r/cfcontainerization/cf-operator/tags&#34; target=&#34;_blank&#34;&gt;https://hub.docker.com/r/cfcontainerization/cf-operator/tags&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Project Quarks</title>
      <link>https://quarks.suse.dev/docs/concepts/quarks/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/concepts/quarks/</guid>
      <description>
        
        
        &lt;p&gt;&lt;a href=&#34;https://www.cloudfoundry.org/project-quarks/&#34; target=&#34;_blank&#34;&gt;Project Quarks&lt;/a&gt; is an incubating effort within the Cloud Foundry Foundation that packages Cloud Foundry Application Runtime as containers instead of virtual machines, enabling easy deployment to Kubernetes.&lt;/p&gt;

&lt;p&gt;The resulting containerized CFAR provides an identical developer experience to that of BOSH-managed Cloud Foundry installations, requires less infrastructure capacity and delivers an operational experience that is familiar to Kubernetes operators.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks Job</title>
      <link>https://quarks.suse.dev/docs/development/controllers/quarksjob/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/quarksjob/</guid>
      <description>
        
        
        

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#quarksjob&#34;&gt;QuarksJob&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#quarksjob-component&#34;&gt;QuarksJob Component&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#errand-controller&#34;&gt;Errand Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-errand-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-errand-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-errand-controller&#34;&gt;Highlights&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#job-controller&#34;&gt;Job Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-job-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-job-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-job-controller&#34;&gt;Highlights&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#relationship-with-the-bdpl-component&#34;&gt;Relationship with the BDPL component&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarksjob-examples&#34;&gt;QuarksJob Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;The &lt;strong&gt;QuarksJob&lt;/strong&gt; component is a categorization of a set of controllers, under the same group. Inside the &lt;strong&gt;QuarksJob&lt;/strong&gt; component we have a set of 2 controllers together with one separate reconciliation loop per controller.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_deployment_flow-QuarksJob.png&#34; alt=&#34;flow-quarks-job&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Figure 1, illustrates the &lt;strong&gt;QuarksJob&lt;/strong&gt; component diagram and the set of controllers it uses.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_ejobcomponent_flow.png&#34; alt=&#34;flow-quarks-job&#34; /&gt;
&lt;em&gt;Fig. 1: The QuarksJob component&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;errand-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;Errand Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_ejoberrandcontroller_flow.png&#34; alt=&#34;errand-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 2: The Errand controller flow&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is the controller responsible for implementing &lt;strong&gt;Errands&lt;/strong&gt;, this will lead to the generation of a Kubernetes job, in order to complete a task.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-errand-controller&#34;&gt;Watches in Errand controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;QuarksJob&lt;/code&gt; resources: Create and Update&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ConfigMaps&lt;/code&gt;: Update&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Secrets&lt;/code&gt;: Create and Update&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-errand-controller&#34;&gt;Reconciliation in Errand controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;When an &lt;code&gt;QuarksJob&lt;/code&gt; instance is generated, it will create an associated Kubernetes Job.&lt;/li&gt;
&lt;li&gt;The generation of new Kubernetes Jobs also serves as the trigger for the &lt;code&gt;Job Controller&lt;/code&gt;, to start the Reconciliation.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;job-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;Job Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_ejobjobcontroller_flow.png&#34; alt=&#34;job-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 3: The Job controller flow&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This is an auxiliary controller that relies on the Errand Controller output. It will be watching for Kubernetes Jobs that have Succeeded and deletes the job. If the jobpod of the succeeded job has a label &lt;code&gt;delete=pod&lt;/code&gt;, it deletes the job pod too.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-job-controller&#34;&gt;Watches in job controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Jobs&lt;/code&gt;: Succeeded&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-job-controller&#34;&gt;Reconciliation in job controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Deletes succeeded job and its pod.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;relationship-with-the-bdpl-component&#34;&gt;Relationship with the BDPL component&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_bdpl_and_ejob_flow.png&#34; alt=&#34;bdpl-qjob-relationship&#34; /&gt;
&lt;em&gt;Fig. 4: Relationship between the BDPL controller and the QuarksJob component&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Figure 4 illustrates the interaction of the &lt;strong&gt;BOSHDeployment&lt;/strong&gt; Controller with the &lt;strong&gt;Errand&lt;/strong&gt; Controller and how the output of this one serves as the trigger for the &lt;strong&gt;Job&lt;/strong&gt; Controller.&lt;/p&gt;

&lt;h2 id=&#34;quarksjob-examples&#34;&gt;&lt;code&gt;QuarksJob&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/tree/master/docs/examples&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/quarks-job/tree/master/docs/examples&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks restart</title>
      <link>https://quarks.suse.dev/docs/development/controllers/quarks_restart/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/quarks_restart/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;The QuarksRestart controller is responsible for restarting kubernetes resources such as &lt;code&gt;StatefulSet&lt;/code&gt; and &lt;code&gt;Deployment&lt;/code&gt;. They are restarted whenever a secret referenced by these resources gets updated.&lt;/p&gt;

&lt;p&gt;This feature also enables updating entangled pods whenever the link secrets get updated.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-quarks-restart-controller&#34;&gt;Watches in Quarks Restart Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Secret&lt;/code&gt;: Updates for secrets that have the annotation &lt;code&gt;quarks.cloudfoundry.org/restart-on-update&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-quarks-restart-controller&#34;&gt;Reconciliation in Quarks Restart Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;adds restart annotation &lt;code&gt;quarks.cloudfoundry.org/restart&lt;/code&gt; to &lt;code&gt;StatefulSet&lt;/code&gt; or &lt;code&gt;Deployment&lt;/code&gt; as appropriate.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;quarksrestart-examples&#34;&gt;&lt;code&gt;QuarksRestart&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/quarks-restart&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/quarks-restart&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks Secret</title>
      <link>https://quarks.suse.dev/docs/development/controllers/quarks_secret/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/quarks_secret/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret&#34;&gt;QuarksSecret&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#description&#34;&gt;Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret-component&#34;&gt;QuarksSecret Component&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;QuarksSecret Controller&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-quarks-secret-controller&#34;&gt;Watches in Quarks Secret Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-quarks-secret-controller&#34;&gt;Reconciliation in Quarks Secret Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-quarks-secret-controller&#34;&gt;Highlights in Quarks Secret Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#types&#34;&gt;Types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#auto-approving-certificates&#34;&gt;Auto-approving Certificates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#copies&#34;&gt;Copies&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#certificatesigningrequest-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;CertificateSigningRequest Controller&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-csr-controller&#34;&gt;Watches in CSR Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-csr-controller&#34;&gt;Reconciliation in CSR Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#highlights-in-csr-controller&#34;&gt;Highlights in CSR Controller&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#secretrotation-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;SecretRotation Controller&lt;/em&gt;&lt;/strong&gt;&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-secret-rotation-controller&#34;&gt;Watches in Secret Rotation Controller&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-secret-rotation-controller&#34;&gt;Reconciliation in Secret Rotation Controller&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#relationship-with-the-bdpl-component&#34;&gt;Relationship With the BDPL Component&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret-examples&#34;&gt;&lt;code&gt;QuarksSecret&lt;/code&gt; Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;A QuarksSecret generates passwords, keys and certificates and stores them in Kubernetes secrets.&lt;/p&gt;

&lt;h2 id=&#34;quarkssecret-component&#34;&gt;QuarksSecret Component&lt;/h2&gt;

&lt;p&gt;The &lt;strong&gt;QuarksSecret&lt;/strong&gt; component consists of three controllers, each with a separate reconciliation loop.&lt;/p&gt;

&lt;p&gt;Figure 1, illustrates the component and associated set of controllers.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_eseccomponent_flow.png&#34; alt=&#34;qsec-component-flow&#34; /&gt;
&lt;em&gt;Fig. 1: The QuarksSecret component&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;quarkssecret-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;QuarksSecret Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_eseccontroller_flow.png&#34; alt=&#34;qsec-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 2: The QuarksSecret controller&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&#34;watches-in-quarks-secret-controller&#34;&gt;Watches in Quarks Secret Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;QuarksSecret&lt;/code&gt;: Creation&lt;/li&gt;
&lt;li&gt;&lt;code&gt;QuarksSecret&lt;/code&gt;: Updates if &lt;code&gt;.status.generated&lt;/code&gt; is false&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-quarks-secret-controller&#34;&gt;Reconciliation in Quarks Secret Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;generates Kubernetes secret of specific types(see Types under Highlights).&lt;/li&gt;
&lt;li&gt;generate a Certificate Signing Request against the cluster API.&lt;/li&gt;
&lt;li&gt;sets &lt;code&gt;.status.generated&lt;/code&gt; to &lt;code&gt;true&lt;/code&gt;, to avoid re-generation and allow secret rotation.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;highlights-in-quarks-secret-controller&#34;&gt;Highlights in Quarks Secret Controller&lt;/h4&gt;

&lt;h5 id=&#34;types&#34;&gt;Types&lt;/h5&gt;

&lt;p&gt;Depending on the &lt;code&gt;spec.type&lt;/code&gt;, &lt;code&gt;QuarksSecret&lt;/code&gt; supports generating the following:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Secret Type&lt;/th&gt;
&lt;th&gt;spec.type&lt;/th&gt;
&lt;th&gt;certificate.signerType&lt;/th&gt;
&lt;th&gt;certificate.isCA&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;&lt;code&gt;passwords&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;password&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;username-password pairs&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;basic-auth&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;rsa keys&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;rsa&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;ssh keys&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;ssh&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;td&gt;not set&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;self-signed root certificates&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;certificate&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;local&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;true&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;self-signed certificates&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;certificate&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;local&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;&lt;code&gt;cluster-signed certificates&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;certificate&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;cluster&lt;/code&gt;&lt;/td&gt;
&lt;td&gt;&lt;code&gt;false&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;You can find more details in the &lt;a href=&#34;https://bosh.io/docs/variable-types&#34; target=&#34;_blank&#34;&gt;BOSH docs&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h5 id=&#34;auto-approving-certificates&#34;&gt;Auto-approving Certificates&lt;/h5&gt;

&lt;p&gt;A certificate &lt;code&gt;QuarksSecret&lt;/code&gt; can be signed by the Kubernetes API Server. The &lt;strong&gt;QuarksSecret&lt;/strong&gt; Controller is responsible for generating the certificate signing request:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;certificates.k8s.io/v1beta1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;CertificateSigningRequest&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;generate-certificate&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;request&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;((encoded-cert-signing-request))&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;usages&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;digital&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;signature&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;key&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;encipherment&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h5 id=&#34;copies&#34;&gt;Copies&lt;/h5&gt;

&lt;p&gt;The &lt;code&gt;QuarksSecret&lt;/code&gt; controller can create copies of a generated secret across multiple namespaces, as long as the target secrets (that live in a namespace other than the namespace of the &lt;code&gt;QuarksSecret&lt;/code&gt;) already exist, and have an annotation of:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;quarks.cloudfoundry.org/secret-copy-of: NAMESPACE/generate-password-with-copies&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;as well as the usual label for generated secrets:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;quarks.cloudfoundry.org/secret-kind: generated&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This ensures that the creator of the &lt;code&gt;QuarksSecret&lt;/code&gt; must have access to the copy target namespace.&lt;/p&gt;

&lt;p&gt;Copied &lt;code&gt;Secrets&lt;/code&gt; do not have an owner set, and are not cleaned up automatically when the &lt;code&gt;QuarksSecret&lt;/code&gt; is deleted.&lt;/p&gt;

&lt;h3 id=&#34;certificatesigningrequest-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;CertificateSigningRequest Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_certsrcontroller_flow.png&#34; alt=&#34;certsr-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 3: The CertificateSigningRequest controller&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&#34;watches-in-csr-controller&#34;&gt;Watches in CSR Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Certificate Signing Request&lt;/code&gt;: Creation&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-csr-controller&#34;&gt;Reconciliation in CSR Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;once the request is approved by Kubernetes API, will generate a certificate stored in a Kubernetes secret, that is recognized by the cluster.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;highlights-in-csr-controller&#34;&gt;Highlights in CSR Controller&lt;/h4&gt;

&lt;p&gt;The CertificateSigningRequest controller watches for &lt;code&gt;CertificateSigningRequest&lt;/code&gt; and approves &lt;code&gt;QuarksSecret&lt;/code&gt;-owned CSRs and persists the generated certificate.&lt;/p&gt;

&lt;h3 id=&#34;secretrotation-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;SecretRotation Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;The secret rotation controller watches for a rotation config map and re-generates all the listed &lt;code&gt;QuarksSecrets&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-secret-rotation-controller&#34;&gt;Watches in Secret Rotation Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ConfigMap&lt;/code&gt;: Creation of a config map, which has the &lt;code&gt;secret-rotation&lt;/code&gt; label.&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-secret-rotation-controller&#34;&gt;Reconciliation in Secret Rotation Controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;Will read the array of &lt;code&gt;QuarksSecret&lt;/code&gt; names from the JSON under the config map key &lt;code&gt;secrets&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Skip &lt;code&gt;QuarksSecret&lt;/code&gt; where &lt;code&gt;.status.generated&lt;/code&gt; is &lt;code&gt;false&lt;/code&gt;, as these might be under control of the user.&lt;/li&gt;
&lt;li&gt;Set &lt;code&gt;.status.generated&lt;/code&gt; for each named &lt;code&gt;QuarksSecret&lt;/code&gt; to &lt;code&gt;false&lt;/code&gt;, to trigger re-creation of the corresponding secret.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;relationship-with-the-bdpl-component&#34;&gt;Relationship With the BDPL Component&lt;/h2&gt;

&lt;p&gt;All explicit variables of a BOSH manifest will be created as &lt;code&gt;QuarksSecret&lt;/code&gt; instances, which will trigger the &lt;strong&gt;QuarksSecret&lt;/strong&gt; Controller.
This will create corresponding secrets. If the user decides to change a secret, the &lt;code&gt;.status.generated&lt;/code&gt; field in the corresponding &lt;code&gt;QuarksSecret&lt;/code&gt; should be set to &lt;code&gt;false&lt;/code&gt;, to protect against overwriting.&lt;/p&gt;

&lt;h2 id=&#34;quarkssecret-examples&#34;&gt;&lt;code&gt;QuarksSecret&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-secret/tree/master/docs/examples&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/quarks-secret/tree/master/docs/examples&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks StatefulSet</title>
      <link>https://quarks.suse.dev/docs/development/controllers/quarks_statefulset/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/quarks_statefulset/</guid>
      <description>
        
        
        

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#QuarksStatefulSet&#34;&gt;QuarksStatefulSet&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#Description&#34;&gt;Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarksstatefulset-component&#34;&gt;QuarksStatefulSet Component&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#_quarksstatefulset-controller_&#34;&gt;QuarksStatefulSet Controller&lt;/a&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;#watches-in-sts-controller&#34;&gt;Watches&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#reconciliation-in-sts-controller&#34;&gt;Reconciliation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#scaling-restrictions-not-implemented&#34;&gt;Scaling Restrictions (not implemented)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#automatic-restart-of-containers&#34;&gt;Automatic Restart of Containers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#exposing-quarksstatefulsets-publicly&#34;&gt;Exposing QuarksStatefulSets Publicly&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#cluster-ip&#34;&gt;Cluster IP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#load-balancer&#34;&gt;Load Balancer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#ingress&#34;&gt;Ingress&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#extended-upgrade-support&#34;&gt;Extended Upgrade Support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#detects-if-statefulset-versions-are-running&#34;&gt;Detects if StatefulSet versions are running&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#az-support&#34;&gt;AZ Support&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#tolerations&#34;&gt;Tolerations&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarksstatefulset-active-passive-controller&#34;&gt;QuarksStatefulSet Active-Passive Controller&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#relationship-with-the-bdpl-component&#34;&gt;Relationship with the BPM component&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#`quarks-statefulset`-examples&#34;&gt;&lt;code&gt;QuarksStatefulSet&lt;/code&gt; Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;The QuarksStatefulSet component can be understood as the set of controllers responsible for translating the BOSH manifest &lt;code&gt;instance_groups&lt;/code&gt; into Kubernetes resources.&lt;/p&gt;

&lt;h2 id=&#34;quarksstatefulset-component&#34;&gt;QuarksStatefulset Component&lt;/h2&gt;

&lt;p&gt;The &lt;strong&gt;QuarksStatefulset&lt;/strong&gt; component is a categorization of a set of controllers, under the same group. Inside the &lt;strong&gt;QuarksStatefulset&lt;/strong&gt; component, we have a set of 2 controllers together with one separate reconciliation loop per controller.&lt;/p&gt;

&lt;p&gt;Figure 1 illustrates a &lt;strong&gt;QuarksStatefulset&lt;/strong&gt; component diagram that covers the set of controllers it uses.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_estscomponent_flow.png&#34; alt=&#34;qsts-component-flow&#34; /&gt;
&lt;em&gt;Fig. 1: The QuarksStatefulset component&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;quarksstatefulset-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;QuarksStatefulSet Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_estscontroller_flow.png&#34; alt=&#34;qsts-controller-flow&#34; /&gt;
&lt;em&gt;Fig. 2: The QuarksStatefulset controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This controller will generate a Kubernetes statefulset for each &lt;code&gt;instance_group&lt;/code&gt; defined in the BOSH manifest. This &lt;code&gt;Statefulset&lt;/code&gt; will also include a set of Kubernetes services, so that each component can be accessed on specific ports.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-sts-controller&#34;&gt;Watches in sts controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;QuarksStatefulset&lt;/code&gt;: Creation&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Configmaps&lt;/code&gt;: Update&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Secrets&lt;/code&gt;: Update&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-sts-controller&#34;&gt;Reconciliation in sts controller&lt;/h4&gt;

&lt;p&gt;Will generate versioned &lt;code&gt;Statefulsets&lt;/code&gt; with the required data to make all jobs of the &lt;code&gt;instance_group&lt;/code&gt; runnable.&lt;/p&gt;

&lt;h4 id=&#34;scaling-restrictions-not-implemented&#34;&gt;Scaling Restrictions (not implemented)&lt;/h4&gt;

&lt;p&gt;Ability to set restrictions on how scaling can occur: min, max, odd replicas.&lt;/p&gt;

&lt;h4 id=&#34;automatic-restart-of-containers&#34;&gt;Automatic Restart of Containers&lt;/h4&gt;

&lt;p&gt;When an env value or mount changes due to a &lt;code&gt;ConfigMap&lt;/code&gt; or &lt;code&gt;Secret&lt;/code&gt; change, containers are restarted.
The operator watches all the &lt;code&gt;ConfigMaps&lt;/code&gt; and &lt;code&gt;Secrets&lt;/code&gt; referenced by the &lt;code&gt;StatefulSet&lt;/code&gt;, and automatically performs the update, without extra workarounds.&lt;/p&gt;

&lt;h4 id=&#34;exposing-quarksstatefulsets-publicly&#34;&gt;Exposing QuarksStatefulSets Publicly&lt;/h4&gt;

&lt;p&gt;Exposing &lt;code&gt;quarksstatefulsets&lt;/code&gt; is similar to exposing &lt;code&gt;statefulsets&lt;/code&gt; in kubernetes. A Kubernetes service makes use of labels to select the pods which should be in the service. We need to use two labels to group the pods of a single instance group.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/instance-group-name: ((instanceGroupName))&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name: ((deploymentName))&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;cluster-ip&#34;&gt;Cluster IP&lt;/h4&gt;

&lt;p&gt;Following is the example which creates a service with type &lt;strong&gt;ClusterIP&lt;/strong&gt; for a single instance group named &lt;code&gt;nats&lt;/code&gt; in deployment &lt;code&gt;nats-deployment&lt;/code&gt; for exposing port 4222.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Service&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats-service&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;ClusterIP&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;selector&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/instance-group-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/deployment-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats-deployment&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;ports&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;protocol&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;TCP&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;port&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;80&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;targetPort&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;4222&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Complete example can be found &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/bosh-deployment/boshdeployment-with-service.yaml&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Though, by default, quarks creates three services of type &lt;strong&gt;ClusterIP&lt;/strong&gt; as defined &lt;a href=&#34;../../core-tasks/from_bosh_to_kube/#naming-conventions&#34;&gt;here&lt;/a&gt; for any instance group.&lt;/p&gt;

&lt;h4 id=&#34;load-balancer&#34;&gt;Load Balancer&lt;/h4&gt;

&lt;p&gt;For creating a service type &lt;strong&gt;LoadBalancer&lt;/strong&gt;, we just need to change the &lt;code&gt;.spec.type&lt;/code&gt; to &lt;code&gt;LoadBalancer&lt;/code&gt; in the above example. The LoadBalancer Ingress is your public IP specified in the output of this command &lt;code&gt;kubectl describe service nats-service&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&#34;ingress&#34;&gt;Ingress&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;Ingress&lt;/strong&gt; doesn&amp;rsquo;t use any labels but just sits on top of services and acts as a smart router. You can create services of different types based on the above examples and use them as values in the ingress Kubernetes spec. An example of Ingress can be found &lt;a href=&#34;https://kubernetes.io/docs/tasks/access-application-cluster/ingress-minikube/#create-an-ingress-resource&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For more information about Kubernetes services, we recommend you to read &lt;a href=&#34;https://kubernetes.io/docs/concepts/services-networking/service/&#34; target=&#34;_blank&#34;&gt;this&lt;/a&gt;.&lt;/p&gt;

&lt;h4 id=&#34;extended-upgrade-support&#34;&gt;Extended Upgrade Support&lt;/h4&gt;

&lt;p&gt;When an update needs to happen, a second &lt;code&gt;StatefulSet&lt;/code&gt; for the new version is deployed, and both coexist until canary conditions are met.&lt;/p&gt;

&lt;p&gt;Annotated with a version (auto-incremented on each update). The annotation key is &lt;code&gt;quarks.cloudfoundry.org/version&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Ability to upgrade even though &lt;code&gt;StatefulSet&lt;/code&gt; pods are not ready.&lt;/p&gt;

&lt;h4 id=&#34;detects-if-statefulset-versions-are-running&#34;&gt;Detects if StatefulSet versions are running&lt;/h4&gt;

&lt;p&gt;During upgrades, there is more than one &lt;code&gt;StatefulSet&lt;/code&gt; version for an &lt;code&gt;QuarksStatefulSet&lt;/code&gt; resource. The operator lists available versions and keeps track of which are running.&lt;/p&gt;

&lt;p&gt;A running version means that at least one pod that belongs to a &lt;code&gt;StatefulSet&lt;/code&gt; is running. When a version &lt;strong&gt;n&lt;/strong&gt; is running, any version lower than &lt;strong&gt;n&lt;/strong&gt; is deleted.&lt;/p&gt;

&lt;p&gt;The controller continues to reconcile until there&amp;rsquo;s only one version.&lt;/p&gt;

&lt;h4 id=&#34;az-support&#34;&gt;AZ Support&lt;/h4&gt;

&lt;p&gt;The &lt;code&gt;zones&lt;/code&gt; key defines the availability zones the &lt;code&gt;QuarksStatefulSet&lt;/code&gt; needs to span.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;zoneNodeLabel&lt;/code&gt; defines the node label that defines a node&amp;rsquo;s zone.
The default value for &lt;code&gt;zoneNodeLabel&lt;/code&gt; is &lt;code&gt;failure-domain.beta.kubernetes.io/zone&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The example below defines an &lt;code&gt;QuarksStatefulSet&lt;/code&gt; that should be deployed in two availability zones, &lt;strong&gt;us-central1-a&lt;/strong&gt; and &lt;strong&gt;us-central1-b&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;quarks.cloudfoundry.org/v1alpha1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;QuarksStatefulSet&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;MyQuarksStatefulSet&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;zoneNodeLabel&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;failure-domain.beta.kubernetes.io/zone&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;zones&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;us-central1-a&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;,&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;us-central1-b&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;...&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;template&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;replicas&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;QuarksStatefulSet&lt;/code&gt; controller creates one &lt;code&gt;StatefulSet&lt;/code&gt; version for each availability zone, and adds affinity information to the pods of those &lt;code&gt;StatefulSets&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;affinity&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;nodeAffinity&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;nodeSelectorTerms&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;matchExpressions&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;key&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;failure-domain.beta.kubernetes.io/zone&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;operator&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;In&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;values&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;[&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;us-central1-a&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If zones are set for an &lt;code&gt;QuarksStatefulSet&lt;/code&gt;, the following occurs:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The name of each created &lt;code&gt;StatefulSet&lt;/code&gt; is generated as &lt;code&gt;&amp;lt;quarks statefulset name&amp;gt;-z&amp;lt;index of az&amp;gt;&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;myquarksstatefulset-z0&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The &lt;code&gt;StatefulSet&lt;/code&gt; and its &lt;code&gt;Pods&lt;/code&gt; are labeled with the following:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;quarks.cloudfoundry.org/az-index&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;0&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;quarks.cloudfoundry.org/az-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;us-central1-a&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;The &lt;code&gt;StatefulSet&lt;/code&gt; and its &lt;code&gt;Pods&lt;/code&gt; are annotated with an &lt;strong&gt;ordered&lt;/strong&gt; JSON array of all the availability zones:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;quarks.cloudfoundry.org/zones&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;[&amp;#34;us-central1-a&amp;#34;, &amp;#34;us-central1-b&amp;#34;]&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;As defined above, each pod is modified to contain affinity rules.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Each container and init container of each pod have the following env vars set:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;KUBE_AZ&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;zone name&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;BOSH_AZ&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;zone name&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;CF_OPERATOR_AZ&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;zone name&amp;#34;&lt;/span&gt;
&lt;span style=&#34;color:#000&#34;&gt;AZ_INDEX&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;zone index&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h5 id=&#34;tolerations&#34;&gt;Tolerations&lt;/h5&gt;

&lt;p&gt;Taints and tolerations is a concept defined in kubernetes to repel pods from nodes &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/&#34; target=&#34;_blank&#34;&gt;link&lt;/a&gt;. Defining tolerations is same as defined in the kubernetes docs. Keep in mind the affinity rules added by the controller when az&amp;rsquo;s are defined. An example is specified in the examples folder.&lt;/p&gt;

&lt;h4 id=&#34;restarting-on-config-change&#34;&gt;Restarting on Config Change&lt;/h4&gt;

&lt;p&gt;&lt;code&gt;QuarksStatefulSets&lt;/code&gt; can be automatically updated when the environment/mounts have changed due to a referenced
&lt;code&gt;ConfigMap&lt;/code&gt; or a &lt;code&gt;Secret&lt;/code&gt; being updated. This behavior is controlled by the &lt;code&gt;updateOnConfigChange&lt;/code&gt; flag which defaults to &lt;code&gt;false&lt;/code&gt;.&lt;/p&gt;

&lt;h4 id=&#34;watches-in-cleanup-controller&#34;&gt;Watches in cleanup controller&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;StatefulSet&lt;/code&gt;: Creation/Update&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;reconciliation-in-cleanup-controller&#34;&gt;Reconciliation in cleanup controller&lt;/h4&gt;

&lt;p&gt;It will delete statefulsets with old versions, only after the new statefulset version instances are up and running.&lt;/p&gt;

&lt;h3 id=&#34;quarksstatefulset-active-passive-controller&#34;&gt;&lt;strong&gt;&lt;em&gt;QuarksStatefulSet Active-Passive Controller&lt;/em&gt;&lt;/strong&gt;&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_estsactivepassivecontroller_flow.png&#34; alt=&#34;qsts-activepassivecontroller-flow&#34; /&gt;
&lt;em&gt;Fig. 3: The QuarksStatefulset active/passive controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Active/passive model is application model that have multiple running instances, but only one instance is active and all other instances are passive (standby). If the active instance is down, one of the passive instances will be promoted to active immediately.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;activePassiveProbes&lt;/code&gt; key defines active probe to be performed on a container. The controller examines the active probe periodically to see if the active one is still active. If active pod is down or there isn’t an active pod, the first running pod will be promoted as active and label it as &lt;code&gt;quarks.cloudfoundry.org/pod-active: active&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;quarks.cloudfoundry.org/v1alpha1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;QuarksStatefulSet&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;myquarksstatefulset&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;activePassiveProbes&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;busybox&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;# define a active probe on the container&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;exec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;command&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/bin/sh&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;-c&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/root/check-active.sh&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;template&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;replicas&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;template&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;        &lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;containers&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;          &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;busybox&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;image&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;busybox&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;command&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;sleep&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;            &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;3600&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;...&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The controller manages this active probing and provides pod designation label to the service&amp;rsquo;s selectors. Any requests sent to the service will then only be sent to the active pod.&lt;/p&gt;

&lt;h2 id=&#34;relationship-with-the-bdpl-component&#34;&gt;Relationship with the BDPL component&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_bpm_and_ests_flow.png&#34; alt=&#34;bpm-qsts-relationship&#34; /&gt;
&lt;em&gt;Fig. 4: Relationship with the BPM controller&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Figure 4 illustrates the interaction of the &lt;strong&gt;BPM&lt;/strong&gt; Controller with the &lt;strong&gt;QuarksStatefulSet&lt;/strong&gt; Controller. Once the BPM controller consumes the data persisted in secrets from the &lt;code&gt;QuarksJob&lt;/code&gt; Component, it will use that data to generate new &lt;code&gt;QuarksStatefulset&lt;/code&gt; instances. When these resources are generated, the QuarksStatefulSet controller will be watching and trigger its reconciliation loop.&lt;/p&gt;

&lt;h2 id=&#34;quarksstatefulset-examples&#34;&gt;&lt;code&gt;QuarksStatefulSet&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/quarks-statefulset&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/cf-operator/tree/master/docs/examples/quarks-statefulset&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: StatefulSet Rollout</title>
      <link>https://quarks.suse.dev/docs/development/controllers/statefulsetrollout/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/statefulsetrollout/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;motivation&#34;&gt;Motivation&lt;/h2&gt;

&lt;p&gt;The former implementation use a new &lt;code&gt;StatefulSet&lt;/code&gt; for each new version of a manifest. This had the following drawbacks:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Update on a cluster with multiple nodes was not working. When the new pods were started on a different node, the volume was blocked by the old pod.&lt;/li&gt;
&lt;li&gt;On a single node cluster this was also not working, if the workload (e.g. mysql) was using a lock on the volume on file-system level.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;why-standard-k8s-statefulset-is-not-sufficient&#34;&gt;Why standard K8s StatefulSet is not sufficient&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Out-of-order updates are possible when e.g. a pod/node crashes.&lt;/li&gt;
&lt;li&gt;Recovering from a failed deployment is not possible with the standard kubernetes &lt;code&gt;StatefulSet&lt;/code&gt; controller.&lt;/li&gt;
&lt;li&gt;There is no timeout when the new deployment is rolled out and is stuck.&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;statemachine&#34;&gt;Statemachine&lt;/h2&gt;

&lt;p&gt;This controller implements the following state machine&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;../quarks_sts_rollout_fsm.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;known-limitations&#34;&gt;Known Limitations&lt;/h3&gt;

&lt;h4 id=&#34;canaryupscale&#34;&gt;CanaryUpscale&lt;/h4&gt;

&lt;p&gt;During upscale, there is no real canary behaviour implemented.
If a &lt;code&gt;StatefulSet&lt;/code&gt; is scaled from 3 to 5 replicas, the state changes to &lt;code&gt;CanaryUpscale&lt;/code&gt; and &lt;code&gt;Partition&lt;/code&gt; is set to 2.
The k8s statefulset controller creates the 2 missing instances.
If all instances are ready the controller switches to state &lt;code&gt;Rollout&lt;/code&gt; and continues as usual.
Due to the fact that more than 1 instance might be updated in state &lt;code&gt;CanaryUpscale&lt;/code&gt;, the &lt;code&gt;update-watch-time&lt;/code&gt; is used as timeout.&lt;/p&gt;

&lt;h4 id=&#34;single-replica&#34;&gt;Single Replica&lt;/h4&gt;

&lt;p&gt;The former implementation was starting a second pod during the update before shutting down the old one.
This is no longer possible as the name of the pod won&amp;rsquo;t change and results in a downtime.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Troubleshooting</title>
      <link>https://quarks.suse.dev/docs/core-tasks/troubleshooting/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/core-tasks/troubleshooting/</guid>
      <description>
        
        
        

&lt;h3 id=&#34;cluster-ca&#34;&gt;Cluster CA&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;cf-operator&lt;/code&gt; assumes that the cluster root CA is also used for signing CSRs via the certificates.k8s.io API and will embed this CA in the generated certificate secrets. If your cluster is set up to use a different cluster-signing CA the generated certificates will have the wrong CA embedded. See &lt;a href=&#34;https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/&#34; target=&#34;_blank&#34;&gt;https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster/&lt;/a&gt; for more information on cluster trust.&lt;/p&gt;

&lt;h3 id=&#34;recovering-from-a-crash&#34;&gt;Recovering from a crash&lt;/h3&gt;

&lt;p&gt;If the operator pod crashes, it cannot be restarted in the same namespace before the existing mutating webhook configuration for that namespace is removed.
The operator uses mutating webhooks to modify pods on the fly and Kubernetes fails to create pods if the webhook server is unreachable.
The webhook configurations are installed cluster wide and don&amp;rsquo;t belong to a single namespace, just like custom resources.&lt;/p&gt;

&lt;p&gt;To remove the webhook configurations for the cf-operator namespace run:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;CF_OPERATOR_NAMESPACE&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;cf-operator
kubectl delete mutatingwebhookconfiguration &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cf-operator-hook-&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;$CF_OPERATOR_NAMESPACE&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&lt;/span&gt;
kubectl delete validatingwebhookconfiguration &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cf-operator-hook-&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;$CF_OPERATOR_NAMESPACE&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;From &lt;strong&gt;Kubernetes 1.15&lt;/strong&gt; onwards, it is possible to instead patch the webhook configurations for the cf-operator namespace via:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;&lt;span style=&#34;color:#000&#34;&gt;CF_OPERATOR_NAMESPACE&lt;/span&gt;&lt;span style=&#34;color:#ce5c00;font-weight:bold&#34;&gt;=&lt;/span&gt;cf-operator
kubectl patch mutatingwebhookconfigurations &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;cf-operator-hook-&lt;/span&gt;&lt;span style=&#34;color:#000&#34;&gt;$CF_OPERATOR_NAMESPACE&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;&lt;/span&gt; -p &lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;webhooks:
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;- name: mutate-pods.quarks.cloudfoundry.org
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;  objectSelector:
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;    matchExpressions:
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;    - key: name
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;      operator: NotIn
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;      values:
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;      - &amp;#34;cf-operator&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
      </description>
    </item>
    
    <item>
      <title>Docs: Nice tools to use</title>
      <link>https://quarks.suse.dev/docs/development/tooling/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/tooling/</guid>
      <description>
        
        
        

&lt;p&gt;The following is a list of tools with their respective main features that can help you
to simplify your development work when dealing with &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-operator&#34; target=&#34;_blank&#34;&gt;quarks-operator&lt;/a&gt; and &lt;a href=&#34;https://github.com/SUSE/kubecf&#34; target=&#34;_blank&#34;&gt;kubecf&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&#34;k9s-https-github-com-derailed-k9s&#34;&gt;&lt;a href=&#34;https://github.com/derailed/k9s&#34; target=&#34;_blank&#34;&gt;k9s&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;It provides an easy way to navigate through your k8s resources, while watching lively
to changes on them. Main features that can be helpful for containerized CF are:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;inmediate access to resources YAMLs definition&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;inmediate access to services endpoints&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;inmediate access to pods/container logs&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;sort resources(e.g. pods) by cpu or memory consumption&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;inmediate access to a container secure shell&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;havener-https-github-com-homeport-havener&#34;&gt;&lt;a href=&#34;https://github.com/homeport/havener&#34; target=&#34;_blank&#34;&gt;havener&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A tool-kit with different features around k8s and CloudFoundry&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;top&lt;/code&gt;, to get an overview on the cpu/memory/load of the cluster, per ns and pods.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;logs&lt;/code&gt;, to download all logs from all pods into your local system&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;pod-exec&lt;/code&gt;, to open a shell into containers. This can execute cmds in different containers
simultaneously.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;code&gt;node-exec&lt;/code&gt;, to open a shell into nodes. This can execute cmds in different containers
simultaneously.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;stern-https-github-com-wercker-stern&#34;&gt;&lt;a href=&#34;https://github.com/wercker/stern&#34; target=&#34;_blank&#34;&gt;stern&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;Allows you to tail multiple pods on k8s and multiple containers within the pod.&lt;/p&gt;

&lt;h3 id=&#34;kube-dashboard-https-kubernetes-io-docs-tasks-access-application-cluster-web-ui-dashboard&#34;&gt;&lt;a href=&#34;https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/&#34; target=&#34;_blank&#34;&gt;kube dashboard&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;A more user friendly way to navigate your k8s cluster resources.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Desired Manifests</title>
      <link>https://quarks.suse.dev/docs/features/desired_manifests/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/desired_manifests/</guid>
      <description>
        
        
        &lt;p&gt;A desired manifest is a BOSH deployment manifest that has already been calculated so that it&amp;rsquo;s the actual final state that the user wishes his software to be in. All ops files have been applied, variables have been calculated and replaced. This manifest is persisted and versioned.&lt;/p&gt;

&lt;p&gt;Ops files are applied by the operator.
Variables are replaced by an &lt;code&gt;QuarksJob&lt;/code&gt; that runs the operator&amp;rsquo;s image. The &lt;code&gt;QuarksJob&lt;/code&gt; writes the manifest on stdout, which is persisted using a &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/blob/master/docs/quarksjob.md#versioned-secrets&#34; target=&#34;_blank&#34;&gt;Versioned Secret&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Each manifest version that goes live is immutable.
A manifest&amp;rsquo;s version is an integer that gets incremented.
The &lt;em&gt;current version&lt;/em&gt; of the manifest is the greatest version.&lt;/p&gt;

&lt;p&gt;These manifests are kept in secrets named using the following rule:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-plain&#34; data-lang=&#34;plain&#34;&gt;&amp;lt;operator-namespace&amp;gt;/&amp;lt;deployment-name&amp;gt;.desired-manifest-v&amp;lt;version&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;deployment-name&lt;/code&gt;: the name of deployment manifest&lt;/li&gt;
&lt;li&gt;&lt;code&gt;version&lt;/code&gt;: the version of manifest&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Each secret is also annotated and labeled with information such as:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;the deployment name&lt;/li&gt;
&lt;li&gt;the secret kind&lt;/li&gt;
&lt;li&gt;its version&lt;/li&gt;
&lt;li&gt;a description of the &amp;ldquo;sources&amp;rdquo; used to render the manifest (e.g. the location of the CRD that generated it).&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Entanglements</title>
      <link>https://quarks.suse.dev/docs/features/entanglements/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/entanglements/</guid>
      <description>
        
        
        

&lt;p&gt;Also known as &amp;ldquo;Quarks Links&amp;rdquo; - they provide a way to share/discover information between BOSH and Kube Native components.&lt;/p&gt;

&lt;h2 id=&#34;using-k8s-native-values-in-bosh-deployments-native-bosh&#34;&gt;Using k8s Native Values in BOSH Deployments (Native -&amp;gt; BOSH)&lt;/h2&gt;

&lt;p&gt;In this case, the native component is a provider, and the BOSH component is a consumer.&lt;/p&gt;

&lt;p&gt;We construct link information from the native resources like this:&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;BOSH Link&lt;/th&gt;
&lt;th&gt;Native&lt;/th&gt;
&lt;th&gt;Description&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;address&lt;/td&gt;
&lt;td&gt;Service&lt;/td&gt;
&lt;td&gt;DNS address of a k8s &lt;em&gt;service&lt;/em&gt; annotated  &lt;code&gt;quarks.cloudfoundry.org/provides = LINK_NAME&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;azs&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;not supported&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;properties&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;td&gt;properties retrieved from a &lt;em&gt;secret&lt;/em&gt; annotated &lt;code&gt;quarks.cloudfoundry.org/provides = LINK_NAME&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.name&lt;/td&gt;
&lt;td&gt;Pod&lt;/td&gt;
&lt;td&gt;name of &lt;em&gt;pod&lt;/em&gt; selected by the k8s &lt;em&gt;service&lt;/em&gt; that&amp;rsquo;s annotated &lt;code&gt;quarks.cloudfoundry.org/provides = LINK_NAME&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.id&lt;/td&gt;
&lt;td&gt;Pod&lt;/td&gt;
&lt;td&gt;&lt;em&gt;pod&lt;/em&gt; uid&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.index&lt;/td&gt;
&lt;td&gt;Pod&lt;/td&gt;
&lt;td&gt;set to a value 0-(pod replica count)&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.az&lt;/td&gt;
&lt;td&gt;N/A&lt;/td&gt;
&lt;td&gt;not supported&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.address&lt;/td&gt;
&lt;td&gt;Pod&lt;/td&gt;
&lt;td&gt;ip of &lt;em&gt;pod&lt;/em&gt;&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;instances.bootstrap&lt;/td&gt;
&lt;td&gt;Pod&lt;/td&gt;
&lt;td&gt;set to true if index == 0&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
&lt;p&gt;If multiple secrets or services are found with the same link information, the operator should error&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;example-native-bosh&#34;&gt;Example (Native -&amp;gt; BOSH)&lt;/h3&gt;

&lt;p&gt;When a job consumes a link, it will have a section like this in the in its job spec (&lt;code&gt;job.MF&lt;/code&gt;), e.g. the nats release:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;consumes&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We can create the following k8s secret to fulfill the link:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Secret&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;secretlink&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/deployment-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;mydeployment&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;annotations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/provides&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;{&amp;#34;name&amp;#34;:&amp;#34;nats&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;nats&amp;#34;}&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;data&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;link&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;|
&lt;/span&gt;&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;      nats.user: myuser&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;nats.password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;mysecret&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using this secret, the nats release can use &lt;code&gt;link(&amp;quot;nats&amp;quot;).p(&amp;quot;password&amp;quot;)&lt;/code&gt; in its eruby templates.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-eruby&#34; data-lang=&#34;eruby&#34;&gt;&amp;#34;&amp;lt;%= p(&amp;#34;nats.password&amp;#34;) %&amp;gt;&amp;#34;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Furthermore, if there is a matching k8s service, it will be used in the link:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Service&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/deployment-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;mydeployment&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;annotations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/link-provider-name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;nats-service&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;ports&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;port&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;9099&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;protocol&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;TCP&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;targetPort&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;9099&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;selector&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;app&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;mynats&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Using this service, I should be able to use &lt;code&gt;link(&amp;quot;nats&amp;quot;).address&lt;/code&gt;, and I should get a value of &lt;code&gt;nats-service&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This service selects for &lt;code&gt;Pods&lt;/code&gt; that have the label &lt;code&gt;app: mynats&lt;/code&gt;. The &lt;code&gt;instances&lt;/code&gt; array should be populated using information from these pods.&lt;/p&gt;

&lt;p&gt;If the secret is changed, consumers of the link are automatically restarted.&lt;/p&gt;

&lt;p&gt;If the service is changed, or the list of pods selected by the service is changed, consumers of the link are automatically restarted.&lt;/p&gt;

&lt;h2 id=&#34;using-bosh-variables-in-k8s-pods-bosh-native&#34;&gt;Using BOSH Variables in k8s Pods (BOSH -&amp;gt; Native)&lt;/h2&gt;

&lt;p&gt;In this case, the BOSH component is a provider, and the native component is a consumer.
The native component is pod, which might belong to a deployment or statefulset.&lt;/p&gt;

&lt;p&gt;The operator creates link secrets for all providers in a BOSH deployment. Each secret contains a flattened map with the provided properties:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Secret&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;link-test-nats-nats&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;annotations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/restart-on-update&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#34;true&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;labels&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;quarks.cloudfoundry.org/entanglement&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;link-test-nats-nats&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;data&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;nats.password&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;YXBwYXJlbnRseSwgeW91Cg==&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;nats.port&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;aGF2ZSB0b28K&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;nats.user&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;bXVjaCB0aW1lCg==&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;If a pod is annotated with the following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment: foo&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/consumes: &#39;[{&amp;quot;name&amp;quot;:&amp;quot;nats&amp;quot;,&amp;quot;type&amp;quot;:&amp;quot;nats&amp;quot;}]&#39;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The operator will mutate the pod to:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;mount the link secrets as &lt;code&gt;/quarks/link/DEPLOYMENT/&amp;lt;type&amp;gt;-&amp;lt;name&amp;gt;/&amp;lt;key&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;add an environment variable for each key in the secret data mapping: &lt;code&gt;LINK_&amp;lt;key&amp;gt;&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The &lt;code&gt;&amp;lt;name&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;type&amp;gt;&lt;/code&gt; are the respective link type and name. For example, the nats release uses &lt;code&gt;nats&lt;/code&gt; for both the name and the type of the link. The &lt;code&gt;&amp;lt;key&amp;gt;&lt;/code&gt; describes the BOSH property, flattened (dot-style), for example &lt;code&gt;nats.password&lt;/code&gt;. The key name is modified to be upper case and without dots in the context of an environment variable, therefore &lt;code&gt;nats.password&lt;/code&gt; becomes &lt;code&gt;LINK_NATS_PASSWORD&lt;/code&gt; in the container.&lt;/p&gt;

&lt;p&gt;If link information changes, the operator will trigger an update (restart) of the deployment or statefulset owning the pod.
This can be done by updating the template of the pod using an annotation.&lt;/p&gt;

&lt;h3 id=&#34;example-bosh-native&#34;&gt;Example (BOSH -&amp;gt; Native)&lt;/h3&gt;

&lt;p&gt;an Eirini Helm Chart&lt;/p&gt;

&lt;p&gt;The OPI process of Eirini required the NATS password and IP.&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;...&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;template&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;quarks.cloudfoundry.org/deployment&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;{{&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;.Values.deploymentName&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;}}&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;      &lt;/span&gt;quarks.cloudfoundry.org/consumes&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;[{&amp;#34;name&amp;#34;:&amp;#34;nats&amp;#34;,&amp;#34;type&amp;#34;:&amp;#34;nats&amp;#34;}]&amp;#39;&lt;/span&gt;`&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;spec&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and a CF-Deployment with Operator, which has the following instance groups:
- API
- Diego Cell
- Gorouter
- NATS
  &lt;code&gt;provides: nats&lt;/code&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Naming Conventions</title>
      <link>https://quarks.suse.dev/docs/concepts/naming/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/concepts/naming/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#naming-conventions&#34;&gt;Naming Conventions&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#kubernetes-resources&#34;&gt;Kubernetes Resources&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#kubernetes-services&#34;&gt;Kubernetes Services&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;kubernetes-resources&#34;&gt;Kubernetes Resources&lt;/h2&gt;

&lt;p&gt;Kube names can only consist of lowercase alphanumeric characters, and the character &lt;code&gt;&amp;quot;-&amp;quot;&lt;/code&gt;.
All &lt;code&gt;&amp;quot;_&amp;quot;&lt;/code&gt; characters are replaced with &lt;code&gt;&amp;quot;-&amp;quot;&lt;/code&gt;. All other non-alphanumeric characters are removed.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;name&lt;/code&gt; cannot start or end with a &lt;code&gt;&amp;quot;-&amp;quot;&lt;/code&gt;. These characters are trimmed.&lt;/p&gt;

&lt;p&gt;Names are also restricted to 63 characters in length, so if a generated name exceeds 63 characters, it should be recalculated as:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;name=&amp;lt;INSTANCE_GROUP_NAME&amp;gt;-&amp;lt;INDEX&amp;gt;&amp;lt;DEPLOYMENT_NAME&amp;gt;

&amp;lt;name trimmed to 31 characters&amp;gt;&amp;lt;md5 hash of name&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;kubernetes-services&#34;&gt;Kubernetes Services&lt;/h3&gt;

&lt;p&gt;The same check needs to apply to the entire address of a &lt;code&gt;Service&lt;/code&gt;. If an entire address is longer than 253 characters, the &lt;code&gt;servicename&lt;/code&gt; is trimmed until there&amp;rsquo;s enough room for the MD5 hash. If it&amp;rsquo;s not possible to include the hash (&lt;code&gt;KUBE_NAMESPACE&lt;/code&gt; and &lt;code&gt;KUBE_SERVICE_DOMAIN&lt;/code&gt; and the dots are 221 characters or more), an error is thrown.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Process Control</title>
      <link>https://quarks.suse.dev/docs/features/process_control/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/process_control/</guid>
      <description>
        
        
        

&lt;h2 id=&#34;background-motivation&#34;&gt;Background &amp;amp; Motivation&lt;/h2&gt;

&lt;p&gt;Before &lt;code&gt;kubecf&lt;/code&gt; the processes of the jobs in an instance group were
managed by &lt;code&gt;monit&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This allowed a human operator to suspend (kill) and later restart
these processes as a means of preventing them from interfering with
low-level operations like restoring a cluster using raw database
backups, and the like. Such suspensions were also not visible at kube
level as the pod and container kept running, except through live- and
readiness-probes.&lt;/p&gt;

&lt;p&gt;The process control features added to the &lt;code&gt;containerun&lt;/code&gt; helper
application of the operator serve the same purpose.&lt;/p&gt;

&lt;h2 id=&#34;interface&#34;&gt;Interface&lt;/h2&gt;

&lt;p&gt;The process control features of &lt;code&gt;containerrun&lt;/code&gt; are accessible through
an unix domain &lt;strong&gt;datagram&lt;/strong&gt; socket at location
&lt;code&gt;/var/vcap/data/&lt;/code&gt;&lt;strong&gt;JOB&lt;/strong&gt;&lt;code&gt;/&lt;/code&gt;&lt;strong&gt;PROCESS&lt;/strong&gt;&lt;code&gt;_containerrun.sock&lt;/code&gt; in the
container. Due to this placement the feature is not accessible from
outside a cluster. An operator (or script written by such) has to log
into the relevant container(s) to use the feature.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Suspending the monitored child processes is done by sending the
command &lt;code&gt;STOP&lt;/code&gt; to this socket.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Conversely, restarting the child processes is done by sending the
command &lt;code&gt;START&lt;/code&gt; to this socket.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Sending a &lt;code&gt;START&lt;/code&gt; command when the child processes are running has
no effect. Conversely the same is true for sending a &lt;code&gt;STOP&lt;/code&gt;
command when the child processes are suspended already.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Any other command sent to the socket is ignored.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Any tool able to send datagram packet to a unix domain socket of that
type should work.&lt;/p&gt;

&lt;p&gt;Examples using &lt;code&gt;netcat&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;echo START | nc -w 1 --unixsock --udp /var/vcap/data/JOB/PROCESS_containerrun.sock&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;echo STOP  | nc -w 1 --unixsock --udp /var/vcap/data/JOB/PROCESS_containerrun.sock&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Note that all of these sockets are placed in the volumne shared by all
container of all jobs of the instance group. It is enough to ssh into
&lt;strong&gt;one&lt;/strong&gt; of the containers to be able to send commands to &lt;strong&gt;all&lt;/strong&gt;
sockets and thus jobs.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;for sock in $(find /var/vcap/dataame &#39;*_containerrun.sock&#39;)
do
    echo STOP | nc -w 1 --unixsock --udp $sock
done
&lt;/code&gt;&lt;/pre&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks Job</title>
      <link>https://quarks.suse.dev/docs/components/quarksjob/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/components/quarksjob/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#quarksjob&#34;&gt;QuarksJob&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#description&#34;&gt;Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#features&#34;&gt;Features&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#errand-jobs&#34;&gt;Errand Jobs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#one-off-jobs--auto-errands&#34;&gt;One-Off Jobs / Auto-Errands&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#restarting-on-config-change&#34;&gt;Restarting on Config Change&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#persisted-output&#34;&gt;Persisted Output&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#versioned-secrets&#34;&gt;Versioned Secrets&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarksjob-examples&#34;&gt;&lt;code&gt;QuarksJob&lt;/code&gt; Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;A &lt;code&gt;QuarksJob&lt;/code&gt; allows the developer to run jobs when something interesting happens. It also allows the developer to store the output of the job into a &lt;code&gt;Secret&lt;/code&gt;.
The job started by an &lt;code&gt;QuarksJob&lt;/code&gt; is deleted automatically after it succeeds.&lt;/p&gt;

&lt;p&gt;There are two different kinds of &lt;code&gt;QuarksJob&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;one-offs&lt;/strong&gt;: automatically runs once after it&amp;rsquo;s created&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;errands&lt;/strong&gt;: needs to be run manually by a user&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;features&#34;&gt;Features&lt;/h2&gt;

&lt;h3 id=&#34;errand-jobs&#34;&gt;Errand Jobs&lt;/h3&gt;

&lt;p&gt;Errands are run manually by the user. They are created by setting &lt;code&gt;trigger.strategy: manual&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;After the &lt;code&gt;QuarksJob&lt;/code&gt; is created, run an errand by editing and applying the
manifest, i.e. via &lt;code&gt;kubectl edit errand1&lt;/code&gt; and change &lt;code&gt;trigger.strategy: manual&lt;/code&gt; to &lt;code&gt;trigger.strategy: now&lt;/code&gt;. A &lt;code&gt;kubectl patch&lt;/code&gt; is also a good way to trigger this type of &lt;code&gt;QuarksJob&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;After completion, this value is reset to &lt;code&gt;manual&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Look &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/blob/master/docs/examples/qjob_errand.yaml&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt; for a full example of an errand.&lt;/p&gt;

&lt;h3 id=&#34;one-off-jobs-auto-errands&#34;&gt;One-Off Jobs / Auto-Errands&lt;/h3&gt;

&lt;p&gt;One-off jobs run directly when created, just like native k8s jobs.&lt;/p&gt;

&lt;p&gt;They are created with &lt;code&gt;trigger.strategy: once&lt;/code&gt; and switch to &lt;code&gt;done&lt;/code&gt; when
finished.&lt;/p&gt;

&lt;p&gt;If a versioned secret is referenced in the pod spec of an qJob, the most recent
version of that secret will be used when the batchv1.Job is created.&lt;/p&gt;

&lt;h4 id=&#34;restarting-on-config-change&#34;&gt;Restarting on Config Change&lt;/h4&gt;

&lt;p&gt;A &lt;strong&gt;one-off&lt;/strong&gt; &lt;code&gt;QuarksJob&lt;/code&gt; can
automatically be restarted if its environment/mounts have changed, due to a
&lt;code&gt;ConfigMap&lt;/code&gt; or a &lt;code&gt;Secret&lt;/code&gt; being updated. This also works for &lt;a href=&#34;#versioned-secrets&#34;&gt;Versioned Secrets&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This requires the attribute &lt;code&gt;updateOnConfigChange&lt;/code&gt; to be set to true.&lt;/p&gt;

&lt;p&gt;Once &lt;code&gt;updateOnConfigChange&lt;/code&gt; is enabled, modifying the &lt;code&gt;data&lt;/code&gt; of any &lt;code&gt;ConfigMap&lt;/code&gt; or &lt;code&gt;Secret&lt;/code&gt; referenced by the &lt;code&gt;template&lt;/code&gt; section of the job will trigger the job again.&lt;/p&gt;

&lt;h3 id=&#34;persisted-output&#34;&gt;Persisted Output&lt;/h3&gt;

&lt;p&gt;QuarksJob can create secrets from job output, which is written to a JSON file in &lt;code&gt;/mnt/quarks&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Multiple secrets are created or overwritten per container in the pod. The output file names are mapped to the secrets&amp;rsquo; names via &lt;code&gt;OutputMap&lt;/code&gt;. This is done for every container.&lt;/p&gt;

&lt;p&gt;The only supported output type currently is json with a flat structure, i.e.
all values being string values, because &lt;a href=&#34;https://kubernetes.io/docs/concepts/configuration/secret/#creating-a-secret-manually&#34; target=&#34;_blank&#34;&gt;Kubernetes secrets store base64 encoded data&lt;/a&gt;. The string value can be a marshalled JSON document.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt; Output of previous runs is overwritten.&lt;/p&gt;

&lt;p&gt;The behavior of storing the output is controlled by specifying the following parameters:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;outputMap&lt;/code&gt; - Mapping from output file name to the name of the secret(s) that will hold the output.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;outputType&lt;/code&gt; - Currently only &lt;code&gt;json&lt;/code&gt; is supported. (default: &lt;code&gt;json&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;secretLabels&lt;/code&gt; - An optional map of labels which will be attached to the generated secret(s)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;writeOnFailure&lt;/code&gt; - if true, output is written even though the Job failed. (default: &lt;code&gt;false&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The developer should ensure that she creates all files defined in &lt;code&gt;OutputMap&lt;/code&gt; in the /mnt/quarks volume mount at the end of the container script. An example of the command field in the quarks job spec will look like this&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;command: [&amp;quot;/bin/sh&amp;quot;]
args: [&amp;quot;-c&amp;quot;,&amp;quot;json=&#39;{\&amp;quot;foo\&amp;quot;: \&amp;quot;1\&amp;quot;, \&amp;quot;bar\&amp;quot;: \&amp;quot;baz\&amp;quot;}&#39; &amp;amp;&amp;amp; echo $json &amp;gt;&amp;gt; /mnt/quarks/output.json&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The secret is created by a side container in quarks job pod which captures the create event of /mnt/quarks/output.json file.&lt;/p&gt;

&lt;p&gt;The behavior of storing the output is controlled by specifying the following parameters:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;outputType&lt;/code&gt; - Currently only &lt;code&gt;json&lt;/code&gt; is supported. (default: &lt;code&gt;json&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;secretLabels&lt;/code&gt; - An optional map of labels which will be attached to the generated secret(s)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;versioned&lt;/code&gt; - if true, the output is written in a &lt;a href=&#34;#versioned-secrets&#34;&gt;Versioned Secret&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;writeOnFailure&lt;/code&gt; - if true, output is written even though the Job failed. (default: &lt;code&gt;false&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;versioned-secrets&#34;&gt;Versioned Secrets&lt;/h4&gt;

&lt;p&gt;Versioned Secrets are a set of &lt;code&gt;Secrets&lt;/code&gt;, where each of them is immutable, and contains data for one iteration. Implementation can be found in the &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-utils/tree/master/pkg/versionedsecretstore&#34; target=&#34;_blank&#34;&gt;versionedsecretstore&lt;/a&gt; package.&lt;/p&gt;

&lt;p&gt;When an &lt;code&gt;QuarksJob&lt;/code&gt; is configured to save to &amp;ldquo;Versioned Secrets&amp;rdquo;, the controller looks for the &lt;code&gt;Secret&lt;/code&gt; with the largest ordinal, adds &lt;code&gt;1&lt;/code&gt; to that value, and &lt;em&gt;creates a new Secret&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;Each versioned secret has the following characteristics:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;its name is calculated like this: &lt;code&gt;&amp;lt;name&amp;gt;-v&amp;lt;ORDINAL&amp;gt;&lt;/code&gt; e.g. &lt;code&gt;mysecret-v2&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;it has the following labels:

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-kind&lt;/code&gt; with a value of &lt;code&gt;versionedSecret&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-version&lt;/code&gt; with a value set to the &lt;code&gt;ordinal&lt;/code&gt; of the secret&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;an annotation of &lt;code&gt;quarks.cloudfoundry.org/source-description&lt;/code&gt; that contains arbitrary information about the creator of the secret&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;quarksjob-examples&#34;&gt;&lt;code&gt;QuarksJob&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-job/tree/master/docs/examples&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/quarks-job/tree/master/docs/examples&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;controller-architecture&#34;&gt;Controller architecture&lt;/h2&gt;

&lt;p&gt;See: &lt;a href=&#34;../../development/controllers/quarksjob/&#34;&gt;Quarks Job controller section&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Rendering BOSH Templates</title>
      <link>https://quarks.suse.dev/docs/features/rendering_templates/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/rendering_templates/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#rendering-bosh-templates&#34;&gt;Rendering BOSH Templates&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#flow&#34;&gt;Flow&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#data-gathering&#34;&gt;Data Gathering&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#extract-job-spec-and-templates-from-image&#34;&gt;Extract Job Spec and Templates from Image&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#calculation-of-required-properties-for-an-instance-group-and-bpm-info&#34;&gt;Calculation of Required Properties for an Instance Group and BPM Info&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#run&#34;&gt;Run&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#create-quarks-statefulset-and-quarks-jobs&#34;&gt;Create QuarksStatefulSet and QuarksJobs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#render-templates&#34;&gt;Render Templates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#run-the-entrypoints&#34;&gt;Run the entrypoints&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#details&#34;&gt;Details&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#services-and-dns-addresses&#34;&gt;Services and DNS Addresses&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#resolving-links&#34;&gt;Resolving Links&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#calculating-spec-and-linkinstances&#34;&gt;Calculating spec.* and link().instances[].*&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#faq&#34;&gt;FAQ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;You can read more about BOSH templates on &lt;a href=&#34;https://bosh.io/docs/jobs/#templates&#34; target=&#34;_blank&#34;&gt;bosh.io&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;flow&#34;&gt;Flow&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;https://docs.google.com/drawings/d/e/2PACX-1vRhPrJuMLVXNuFsym_BZdR_RCpknl1eEBwmECLmP8EJLhI4M1HISBbgfA9rfATeEgZW3hwZMPcWxjCI/pub?w=1749&amp;amp;h=1867&#34; alt=&#34;rendering-flow&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The following points describe each process that involves working with BOSH Job Templates, from beginning to end.&lt;/p&gt;

&lt;h3 id=&#34;data-gathering&#34;&gt;Data Gathering&lt;/h3&gt;

&lt;p&gt;The Data Gathering step is run using one &lt;code&gt;QuarksJob&lt;/code&gt;, that has one pod with multiple containers.&lt;/p&gt;

&lt;h4 id=&#34;extract-job-spec-and-templates-from-image&#34;&gt;Extract Job Spec and Templates from Image&lt;/h4&gt;

&lt;p&gt;This happens in one init container for each release present in the deployment manifest.&lt;/p&gt;

&lt;p&gt;The entrypoint of that init container is responsible with copying the contents of &lt;code&gt;/var/vcap/jobs-src&lt;/code&gt; to a shared directory, where other containers can access it.
This shared directory is &lt;code&gt;/var/vcap/all-releases/jobs-src&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Each init container uses the release&amp;rsquo;s docker image.&lt;/p&gt;

&lt;h4 id=&#34;calculation-of-required-properties-for-an-instance-group-and-bpm-info&#34;&gt;Calculation of Required Properties for an Instance Group and BPM Info&lt;/h4&gt;

&lt;p&gt;The main purpose of the data gathering phase is to compile all information required for all templates to be rendered and for all instance groups to be run:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;properties&lt;/li&gt;
&lt;li&gt;link instances&lt;/li&gt;
&lt;li&gt;bpm yaml&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Two containers are run for each instance group in the deployment manifest, using the image of the CF Operator. These two containers write the following on to a file &lt;code&gt;output.json&lt;/code&gt; in the volume mount &lt;code&gt;/mnt/quarks&lt;/code&gt; of the container :&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;A &lt;code&gt;Secret&lt;/code&gt; named &lt;code&gt;ig-resolved.&amp;lt;instance-group&amp;gt;-v&amp;lt;version&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;This is the &amp;ldquo;Resolved Instance Group Properties&amp;rdquo; yaml file.
It contains a deployment manifest structure that only has information pertinent to an instance group.
It includes:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;all job properties for that instance group&lt;/li&gt;
&lt;li&gt;all properties for all jobs that are link providers to any of the jobs of that instance group&lt;/li&gt;
&lt;li&gt;the rendered contents of each &lt;code&gt;bpm.yml.erb&lt;/code&gt;, for each job in the instance group&lt;/li&gt;
&lt;li&gt;link instance specs for all AZs and replicas; read more about instance keys available for links &lt;a href=&#34;https://bosh.io/docs/links/#templates&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Link instance specs are stored in the &lt;code&gt;quarks&lt;/code&gt; property key for each job in the instance group.&lt;/p&gt;
&lt;/blockquote&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;a &lt;code&gt;Secret&lt;/code&gt; named &lt;code&gt;bpm.&amp;lt;instance-group&amp;gt;-v&amp;lt;version&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Once all properties and link instances are compiled, &lt;code&gt;bpm.yml.erb&lt;/code&gt; can be rendered for each job and for each AZ and replica of the instance group.&lt;/p&gt;

&lt;p&gt;The output of this container is the &amp;ldquo;BPM Info&amp;rdquo; yaml file.
It contains a deployment manifest structure that only has information pertinent to an instance group.
It includes the rendered contents of each &lt;code&gt;bpm.yml.erb&lt;/code&gt;, for each job in the instance group.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;The BPM information is stored under the &lt;code&gt;quarks&lt;/code&gt; property, for each BOSH Job.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Important:&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Because container entrypoints in Kubernetes cannot be different among the replicas of a Pod, we don&amp;rsquo;t support the usage of things like &lt;code&gt;spec.index&lt;/code&gt; in the ERB template of &lt;code&gt;bpm.yaml&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;run&#34;&gt;Run&lt;/h3&gt;

&lt;h4 id=&#34;create-quarksstatefulset-and-quarksjobs&#34;&gt;Create QuarksStatefulSet and QuarksJobs&lt;/h4&gt;

&lt;p&gt;The operator creates definitions for &lt;code&gt;QuarksStatefulSets&lt;/code&gt; (for &lt;strong&gt;BOSH Services&lt;/strong&gt;) or &lt;code&gt;QuarksJobs&lt;/code&gt; (for &lt;strong&gt;BOSH Errands&lt;/strong&gt;).&lt;/p&gt;

&lt;p&gt;These have the following init containers:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;one for each unique release in the instance group - used for copying release job specs and templates; these use the release image&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;one init container that performs ERB rendering; this runs using the CF Operator image&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;render-templates&#34;&gt;Render Templates&lt;/h4&gt;

&lt;p&gt;Init containers copy the templates of the releases to &lt;code&gt;/var/vcap/all-releases&lt;/code&gt;, which is a shared directory among all containers.&lt;/p&gt;

&lt;p&gt;Another init container is run using the operator&amp;rsquo;s image, for rendering all templates. It mounts the &amp;ldquo;Resolved Instance Group Properties&amp;rdquo; &lt;code&gt;Secret&lt;/code&gt; (generated in the &lt;a href=&#34;#data-gathering&#34;&gt;data gathering step&lt;/a&gt;) and performs ERB rendering.
It&amp;rsquo;s also configured with the following environment variables, to facilitate BOSH &lt;code&gt;spec.*&lt;/code&gt; property keys:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;INSTANCE_GROUP_NAME&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;AZ_INDEX&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;REPLICAS&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;run-the-entrypoints&#34;&gt;Run the entrypoints&lt;/h4&gt;

&lt;p&gt;Once all the init containers are done, all control scripts and configuration files are available on disk, the BOSH Job containers can start.
Their entrypoints, env vars, capabilities, etc. are set based on &lt;a href=&#34;https://bosh.io/docs/bpm/config/#process-schema&#34; target=&#34;_blank&#34;&gt;BPM information&lt;/a&gt;.&lt;/p&gt;

&lt;h2 id=&#34;details&#34;&gt;Details&lt;/h2&gt;

&lt;p&gt;The following section describes specific implementation details for algorithms required in the rendering process.&lt;/p&gt;

&lt;h3 id=&#34;services-and-dns-addresses&#34;&gt;Services and DNS Addresses&lt;/h3&gt;

&lt;p&gt;DNS Addresses for instance groups are calculated in the following manner:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&amp;lt;DEPLOYMENT_NAME&amp;gt;-&amp;lt;INSTANCE_GROUP_NAME&amp;gt;-&amp;lt;INDEX&amp;gt;.&amp;lt;KUBE_NAMESPACE&amp;gt;.&amp;lt;KUBE_SERVICE_DOMAIN&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The &lt;code&gt;INDEX&lt;/code&gt; is calculated using the following formula:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;(AZ_INDEX - 1) * REPLICAS + POD_ORDINAL&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In order for things to work correctly across versions and AZs, we need &lt;a href=&#34;https://kubernetes.io/docs/tutorials/stateful-application/basic-stateful-set/#using-stable-network-identities&#34; target=&#34;_blank&#34;&gt;ClusterIP &lt;code&gt;Services&lt;/code&gt;&lt;/a&gt; that select for Instance Group &lt;code&gt;Pods&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For example, assuming a &lt;code&gt;REPLICAS&lt;/code&gt; of &lt;code&gt;3&lt;/code&gt; and an &lt;code&gt;AZ_COUNT&lt;/code&gt; of &lt;code&gt;2&lt;/code&gt; for a &amp;ldquo;nats&amp;rdquo; &lt;code&gt;BOSHDeployment&lt;/code&gt;, with &lt;code&gt;2&lt;/code&gt; &lt;code&gt;StatefulSet&lt;/code&gt; versions available, we would see the following &lt;code&gt;Services&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;nats-0
  selects pod z0-v1-0
  selects pod z0-v2-0
nats-1
  selects pod z1-v1-0
  selects pod z1-v2-0
nats-2
  selects pod z0-v1-1
  selects pod z0-v2-1
nats-3
  selects pod z1-v1-1
  selects pod z1-v2-1
nats-4
  selects pod z0-v1-2
  selects pod z0-v2-2
nats-5
  selects pod z1-v1-2
  selects pod z1-v2-2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;resolving-links&#34;&gt;Resolving Links&lt;/h3&gt;

&lt;p&gt;The following steps describe how to resolve links assuming all information is available. The actual implementation transforms data and stores it in between steps, but the outcome is the same.&lt;/p&gt;

&lt;p&gt;To resolve a link, the following steps are performed:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Vocabulary:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;current job&lt;/code&gt; - the job for which rendering is happening&lt;/li&gt;
&lt;li&gt;&lt;code&gt;desired manifest&lt;/code&gt; - the deployment manifest used&lt;/li&gt;
&lt;li&gt;&lt;code&gt;provider job&lt;/code&gt; - the job that has been identified to be the provider for a link&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;ul&gt;
&lt;li&gt;the name and type of the link is retrieved from the spec of the &lt;code&gt;current job&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;the name of the link is looked up in the &lt;code&gt;current job&lt;/code&gt;&amp;rsquo;s instance group &lt;code&gt;consumes&lt;/code&gt; key (an explicit link definition); if found and is set to &lt;code&gt;nil&lt;/code&gt;, nil is returned and resolving is complete&lt;/li&gt;
&lt;li&gt;if the link&amp;rsquo;s name has been overridden by an explicit link definition in the &lt;code&gt;desired manifest&lt;/code&gt;, the &lt;code&gt;desired manifest&lt;/code&gt; is searched for a corresponding job, that has the same name; if found, the link is populated with the properties of the &lt;code&gt;provider job&lt;/code&gt;; first, the defaults for the exposed properties (defined in the &lt;code&gt;provides&lt;/code&gt; section of the spec of the &lt;code&gt;provider job&lt;/code&gt;) are set to the defaults from the spec, and then the properties from the &lt;code&gt;desired manifest&lt;/code&gt; are applied on top&lt;/li&gt;
&lt;li&gt;if there was no explicit override, we search for a job in all the releases, that provides a link with the same &lt;code&gt;type&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;p&gt;Read more about links &lt;a href=&#34;https://bosh.io/docs/links&#34; target=&#34;_blank&#34;&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;calculating-spec-and-link-instances&#34;&gt;Calculating spec.* and link().instances[].*&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;spec&lt;/code&gt; of each job instance can be calculated:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&amp;lt;name&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;of&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;the&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;instance&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;group&amp;gt;-&amp;lt;name&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;of&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;the&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;job&amp;gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;index&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;(&amp;lt;az&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;index&amp;gt;-&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;1&lt;/span&gt;)&lt;span style=&#34;color:#8f5902;font-style:italic&#34;&gt;*&amp;lt;replicas&amp;gt;+&amp;lt;pod_ordinal&amp;gt;&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;az&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&amp;lt;BOSH_AZ_INDEX&amp;gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;id&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&amp;lt;name&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;of&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;the&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;instance&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;group&amp;gt;-&amp;lt;index&amp;gt;-&amp;lt;name&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;of&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;the&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;job&amp;gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;address&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&amp;lt;calculated&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;address&amp;gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;bootstrap&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&amp;lt;index&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;==&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#0000cf;font-weight:bold&#34;&gt;0&lt;/span&gt;&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&#34;faq&#34;&gt;FAQ&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Why render BPM separately from all other BOSH Job Templates?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Because we need information from BPM to actually know what to run.
  Without that, we don&amp;rsquo;t have an entrypoint, env vars, etc. - so we can&amp;rsquo;t create a pod and containers for the BOSH Job.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Why run all release images for &lt;strong&gt;Data Gathering&lt;/strong&gt;?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;We need to run everything all at once because of links. The only way to resolve them is to have all the BOSH Job specs available in one spot.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Is everything supported in templates, just like BOSH?&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It should, yes. All features should work the same (that&amp;rsquo;s the goal).&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Known Exceptions:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;The use of &lt;code&gt;spec.ip&lt;/code&gt; in &lt;code&gt;bpm.yml.erb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Since &lt;code&gt;bpm.yml&lt;/code&gt; is rendered before the actual instance group runs, in a different pod, &lt;code&gt;spec.ip&lt;/code&gt; is invalid.&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;The use of &lt;code&gt;spec.index&lt;/code&gt; in &lt;code&gt;bpm.yml.erb&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Any BPM information that is different for each replica, cannot be supported by the CF Operator, because all &lt;code&gt;Pod&lt;/code&gt; replicas are identical by definition.&lt;/p&gt;
&lt;/blockquote&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Service wait for Kubernetes native pods</title>
      <link>https://quarks.suse.dev/docs/features/waiting_services/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/features/waiting_services/</guid>
      <description>
        
        
        &lt;p&gt;To support clean deployments and correct depedency management, the quarks-operator allows a Kubernetes &lt;code&gt;Pod&lt;/code&gt; to wait until one (or more) &lt;code&gt;Service&lt;/code&gt; is available.&lt;/p&gt;

&lt;p&gt;The operator does that by injecting an &lt;code&gt;InitContainer&lt;/code&gt; which waits for the service to be up.&lt;/p&gt;

&lt;p&gt;This is a generalization of the serialization hints natively available to all BOSH deployments.&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Pod&lt;/code&gt;s needs to have the &lt;code&gt;quarks.cloudfoundry.org/wait-for&lt;/code&gt; annotation, for example:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;apiVersion&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;v1&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;kind&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;Pod&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;metadata&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;   &lt;/span&gt;annotations&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;     &lt;/span&gt;quarks.cloudfoundry.org/wait-for&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;[ &amp;#34;nats-headless&amp;#34; , &amp;#34;nginx&amp;#34; ]&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;At the ops level this is achieved by an instruction like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;replace&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;path&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/instance_groups/name=THE_INSTANCE_GROUP/env&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;?&lt;/span&gt;/bosh/agent/settings/annotations/quarks.cloudfoundry.org~1wait-for&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;value&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#4e9a06&#34;&gt;&amp;#39;[ &amp;#34;uaa&amp;#34; ]&amp;#39;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;dl&gt;
&lt;dt&gt;The &lt;code&gt;env/bosh/agent/settings/annotations&lt;/code&gt; key is a hash used by the operator to add additional annotations to the k8s objects it creates for an instance group. IOW they are applied to the generated &lt;code&gt;quarks-statefulset&lt;/code&gt;, &lt;code&gt;statefulset&lt;/code&gt;, and &lt;code&gt;pod&lt;/code&gt;.&lt;/dt&gt;
&lt;/dl&gt;

&lt;p&gt;:warning: Note that while the dependency information is ultimately processed as a json array of strings, at the level of the annotations it has to be specified as a plain string. Just one which contains proper json syntax.&lt;/p&gt;

&lt;p&gt;If full custom dependencies are not required, just (partial) serial startup of instance groups (in the order of their specification in their deployment) then the native serialization hints are likely good enough.&lt;/p&gt;

&lt;p&gt;They are specified via a construction of the form&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;instance_groups&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;&lt;/span&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;name&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;THE_INSTANCE_GROUP&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;update&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;    &lt;/span&gt;serial&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;in the BOSH deployment, if under direct control, or via an ops file like&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-yaml&#34; data-lang=&#34;yaml&#34;&gt;-&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;type&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;replace&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;path&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;/instance_groups/name=THE_INSTANCE_GROUP/update/serial&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;
&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt;  &lt;/span&gt;value&lt;span style=&#34;color:#000;font-weight:bold&#34;&gt;:&lt;/span&gt;&lt;span style=&#34;color:#f8f8f8;text-decoration:underline&#34;&gt; &lt;/span&gt;&lt;span style=&#34;color:#204a87;font-weight:bold&#34;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;if the deployment cannot be modified directly.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Quarks Secret</title>
      <link>https://quarks.suse.dev/docs/components/quarkssecret/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/components/quarkssecret/</guid>
      <description>
        
        
        

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret&#34;&gt;QuarksSecret&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#description&#34;&gt;Description&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#features&#34;&gt;Features&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#generate-credentials&#34;&gt;Generate credentials&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#rotate-credentials&#34;&gt;Rotate credentials&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#approve-certificates&#34;&gt;Approve Certificates&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#quarkssecret-examples&#34;&gt;&lt;code&gt;QuarksSecret&lt;/code&gt; Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;description&#34;&gt;Description&lt;/h2&gt;

&lt;p&gt;A QuarksSecret allows the developers to deal with the management of credentials.&lt;/p&gt;

&lt;h2 id=&#34;features&#34;&gt;Features&lt;/h2&gt;

&lt;h3 id=&#34;generate-credentials&#34;&gt;Generate credentials&lt;/h3&gt;

&lt;p&gt;QuarksSecret can be used to generate passwords, certificates and keys. It uses the &lt;a href=&#34;https://github.com/cloudflare/cfssl&#34; target=&#34;_blank&#34;&gt;cfssl package&lt;/a&gt; to generate these. The generated values are stored in kubernetes secrets.&lt;/p&gt;

&lt;h3 id=&#34;rotate-credentials&#34;&gt;Rotate credentials&lt;/h3&gt;

&lt;p&gt;The generated credentials can be rotated by specifying its quarkssecret&amp;rsquo;s name in a configmap. The configmap must have the following label:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-rotation
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;approve-certificates&#34;&gt;Approve Certificates&lt;/h3&gt;

&lt;p&gt;In the case, where a certificate is generated, the QuarksSecret ensures that a certificate signing request is generated and is approved by the Kubernetes API server.&lt;/p&gt;

&lt;h2 id=&#34;quarkssecret-examples&#34;&gt;&lt;code&gt;QuarksSecret&lt;/code&gt; Examples&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&#34;https://github.com/cloudfoundry-incubator/quarks-secret/tree/master/docs/examples&#34; target=&#34;_blank&#34;&gt;https://github.com/cloudfoundry-incubator/quarks-secret/tree/master/docs/examples&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;controller-architecture&#34;&gt;Controller architecture&lt;/h2&gt;

&lt;p&gt;See: &lt;a href=&#34;../../development/controllers/quarks_secret/&#34;&gt;Quarks secret controller section&lt;/a&gt;&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: </title>
      <link>https://quarks.suse.dev/docs/development/controllers/readme/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/development/controllers/readme/</guid>
      <description>
        
        
        

&lt;h1 id=&#34;kubernetes-controllers&#34;&gt;Kubernetes Controllers&lt;/h1&gt;

&lt;p&gt;This folder contains design documents for the Kubernetes controllers that make up the cf-operator.&lt;/p&gt;

&lt;h2 id=&#34;additional-resources&#34;&gt;Additional Resources&lt;/h2&gt;

&lt;p&gt;Draw.io with the sources for the &lt;code&gt;quarks_deployment_flow-*png&lt;/code&gt; controller charts:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://drive.google.com/file/d/1Uk2h5pOmY-gLtbfpDNO3POTcqI5UdZgj/view?usp=sharing&#34; target=&#34;_blank&#34;&gt;https://drive.google.com/file/d/1Uk2h5pOmY-gLtbfpDNO3POTcqI5UdZgj/view?usp=sharing&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

      </description>
    </item>
    
  </channel>
</rss>
