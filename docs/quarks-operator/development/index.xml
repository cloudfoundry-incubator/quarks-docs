<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Quarks Project – Development</title>
    <link>https://quarks.suse.dev/docs/quarks-operator/development/</link>
    <description>Recent content in Development on Quarks Project</description>
    <generator>Hugo -- gohugo.io</generator>
    
	  <atom:link href="https://quarks.suse.dev/docs/quarks-operator/development/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Docs: Releasing</title>
      <link>https://quarks.suse.dev/docs/quarks-operator/development/releasing/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/quarks-operator/development/releasing/</guid>
      <description>
        
        
        &lt;p&gt;We&amp;rsquo;re releasing based on tags, which contain our version number. The format is &amp;lsquo;v0.0.0&amp;rsquo;.
The release title will be set to this version.&lt;/p&gt;
&lt;p&gt;The CI pipeline has a &amp;lsquo;release&amp;rsquo; job, which will update the release on Github.
That job triggers itself, when a draft release is created.&lt;/p&gt;
&lt;h2 id=&#34;create-new-release-pipeline&#34;&gt;Create new release pipeline&lt;/h2&gt;
&lt;p&gt;We release from release-branches. Each maintained release has a separate pipeline in Concourse.
To create a new pipeline run this in the CI repository:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;2
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span style=&#34;color:#24909d&#34;&gt;cd&lt;/span&gt; pipelines/cf-operator-release
./configure.sh CFO v0.4.x v0.4
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;p&gt;Where &lt;code&gt;CFO&lt;/code&gt; is your concourse target and &lt;code&gt;v0.4.x&lt;/code&gt; is the name of the branch.
The last argument, &lt;code&gt;v0.4&lt;/code&gt; is used to filter Github tags, which belong to the release.&lt;/p&gt;
&lt;p&gt;This allows a separate Github branch and Concourse pipeline for each major version.
Within those pipelines, releases can be built from minor versions.&lt;/p&gt;
&lt;h2 id=&#34;create-a-new-release&#34;&gt;Create a new release&lt;/h2&gt;
&lt;p&gt;After completion, the pipeline will create several artifacts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;helm chart on S3&lt;/li&gt;
&lt;li&gt;helm chart in our repo at &lt;a href=&#34;https://cloudfoundry-incubator.github.io/quarks-helm/&#34;&gt;https://cloudfoundry-incubator.github.io/quarks-helm/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;quarks-operator binary on S3&lt;/li&gt;
&lt;li&gt;docker image of the operator on dockerhub&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Running the &amp;lsquo;release&amp;rsquo; job will take the latest artificats, which passed through the pipeline and add them to the Github release:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;to the body&lt;/li&gt;
&lt;li&gt;as Github assets for downloading&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The version numbers (&lt;code&gt;v0.0.0-&amp;lt;number-of-commits&amp;gt;.&amp;lt;commit-SHA&amp;gt;&lt;/code&gt;) of these assets are taken from the info on S3.
They have to match the Github tag, else the release job will fail.
The assets will be copied into a &amp;lsquo;release&amp;rsquo; folder on S3.&lt;/p&gt;
&lt;p&gt;The docker image is only referenced from the helm chart and not mentioned in the release, though.&lt;/p&gt;
&lt;h2 id=&#34;checklist&#34;&gt;Checklist&lt;/h2&gt;
&lt;h3 id=&#34;major-release&#34;&gt;Major Release&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Create version branch&lt;/li&gt;
&lt;li&gt;Create a new release pipeline for that branch&lt;/li&gt;
&lt;li&gt;Unpause pipeline&lt;/li&gt;
&lt;li&gt;Continue with &amp;ldquo;Minor Bump&amp;rdquo;&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;minor-bump&#34;&gt;Minor Bump&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;Tag commit with new version&lt;/li&gt;
&lt;li&gt;Push commit&lt;/li&gt;
&lt;li&gt;Wait for commit to pass release pipeline, &amp;lsquo;publish&amp;rsquo; needs to create the binary and helm chart, before the &amp;lsquo;release&amp;rsquo; job can run&lt;/li&gt;
&lt;li&gt;Create a draft Github release for that tag, &amp;lsquo;release&amp;rsquo; job triggers&lt;/li&gt;
&lt;li&gt;Wait for &amp;lsquo;release&amp;rsquo; job to finish on Concourse&lt;/li&gt;
&lt;li&gt;Edit the draft release on Github and publish it&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Try not to push to the pipeline again, until step 4 is completed. The &amp;lsquo;release&amp;rsquo; job will always take the most recent artifacts from S3. Maybe pause the &amp;lsquo;publish&amp;rsquo; job manually to avoid accidental updates.&lt;/p&gt;
&lt;h2 id=&#34;docs&#34;&gt;Docs&lt;/h2&gt;
&lt;p&gt;Documentation for releases is kept in branches of the quarks-doc repo.
Release docs are pushed to Cloudfoundry via Github Actions, as defined in the branch.&lt;/p&gt;
&lt;p&gt;On the release branch:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Use a unique app name in &lt;code&gt;manifest.yaml&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Edit &lt;code&gt;.github/workflows/pages&lt;/code&gt; branch to match the release branch.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Be sure to adapt menus in all branches (&lt;code&gt;config.toml&lt;/code&gt;) to match the new app URL.&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Kubernetes Controllers</title>
      <link>https://quarks.suse.dev/docs/quarks-operator/development/controllers/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/quarks-operator/development/controllers/</guid>
      <description>
        
        
        &lt;p&gt;The &lt;code&gt;quarks-operator&lt;/code&gt; watches four different types of custom resources:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;bosh_deployment&#34;&gt;BoshDeployment&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../../../quarks-job/development&#34;&gt;QuarksJob&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../../../quarks-secret/development&#34;&gt;QuarksSecret&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;../../../quarks-statefulset/development&#34;&gt;QuarksStatefulSet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The &lt;code&gt;quarks-operator&lt;/code&gt; requires the according CRDs to be installed in the cluster in order to work as expected. By default, the &lt;code&gt;quarks-operator&lt;/code&gt; applies CRDs in your cluster automatically.&lt;/p&gt;
&lt;p&gt;To verify that the CRD´s are installed:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;div style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;
&lt;table style=&#34;border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;&#34;&gt;&lt;tr&gt;&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;&#34;&gt;
&lt;pre style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;1
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;2
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;3
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;4
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;5
&lt;/span&gt;&lt;span style=&#34;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868&#34;&gt;6
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;
&lt;td style=&#34;vertical-align:top;padding:0;margin:0;border:0;;width:100%&#34;&gt;
&lt;pre style=&#34;color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-bash&#34; data-lang=&#34;bash&#34;&gt;$ kubectl get crds
NAME                                            CREATED AT
boshdeployments.quarks.cloudfoundry.org        2019-06-25T07:08:37Z
quarksjobs.quarks.cloudfoundry.org           2019-06-25T07:08:37Z
quarkssecrets.quarks.cloudfoundry.org        2019-06-25T07:08:37Z
quarksstatefulsets.quarks.cloudfoundry.org   2019-06-25T07:08:37Z
&lt;/code&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;h3 id=&#34;architecture-design&#34;&gt;Architecture design&lt;/h3&gt;
&lt;p&gt;&lt;img src=&#34;../QuarksDeploymentFlow-Render.png&#34; alt=&#34;deployment-flow&#34;&gt;&lt;/p&gt;
&lt;p&gt;(Source: &lt;a href=&#34;https://drive.google.com/file/d/1Uk2h5pOmY-gLtbfpDNO3POTcqI5UdZgj/view?usp=sharing&#34;&gt;https://drive.google.com/file/d/1Uk2h5pOmY-gLtbfpDNO3POTcqI5UdZgj/view?usp=sharing&lt;/a&gt;)&lt;/p&gt;

      </description>
    </item>
    
    <item>
      <title>Docs: Labels</title>
      <link>https://quarks.suse.dev/docs/quarks-operator/development/labels/</link>
      <pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate>
      
      <guid>https://quarks.suse.dev/docs/quarks-operator/development/labels/</guid>
      <description>
        
        
        &lt;ul&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/deployment-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentSecretType&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/secret-type&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelDeploymentVersion&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/deployment-version&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelInstanceGroupName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/instance-group-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bdv1.LabelReferencedJobName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/referenced-job-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelAZIndex&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/az-index&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelAZName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/az-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelActivePod&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/pod-active&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelPodOrdinal&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/pod-ordinal&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qstsv1a1.LabelQStsName&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/quarks-statefulset-name&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;qsv1a1.LabelKind&lt;/code&gt; &amp;ldquo;quarks.cloudfoundry.org/secret-kind&amp;rdquo;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;delete&lt;/code&gt; = pod&lt;/li&gt;
&lt;li&gt;&lt;code&gt;variableName&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;app&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;data-from-tests&#34;&gt;Data From Tests&lt;/h1&gt;
&lt;h2 id=&#34;configmaps&#34;&gt;ConfigMaps&lt;/h2&gt;
&lt;h3 id=&#34;secret-rotation-configmap&#34;&gt;Secret Rotation ConfigMap&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-rotation = yes
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;qjob&#34;&gt;QJob&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = bosh-manifest-two-instance-groups
delete=pod
quarks.cloudfoundry.org/deployment-version = 1
quarks.cloudfoundry.org/instance-group-name = nats-smoke-tests
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;qjob-job&#34;&gt;QJob Job&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/qjob-name = ig-bosh-manifest-two-instance-groups
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;pod-from-job&#34;&gt;Pod from Job&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;delete=pod
quarks.cloudfoundry.org/qjob-name=dm-test
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;qsts&#34;&gt;QSTS&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = test
quarks.cloudfoundry.org/deployment-version = 1
quarks.cloudfoundry.org/instance-group-name = nats
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;sts&#34;&gt;STS&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/quarks-statefulset-name=test-nats
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;sts-pod&#34;&gt;STS Pod&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/pod-active=active|true
quarks.cloudfoundry.org/pod-ordinal=0
quarks.cloudfoundry.org/quarks-statefulset-name=test-nats
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;service&#34;&gt;Service&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/az-index=0
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/instance-group-name=nats
quarks.cloudfoundry.org/pod-ordinal=0
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;qsec&#34;&gt;QSec&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name = test
variableName = nats_password
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;qsec-secret&#34;&gt;QSec Secret&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/secret-kind=generated
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id=&#34;secrets&#34;&gt;Secrets&lt;/h2&gt;
&lt;h3 id=&#34;withops-secrets&#34;&gt;WithOps Secrets&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/secret-type=with-ops
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;desired-manifest-secret&#34;&gt;Desired Manifest Secret&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=desired-manifest
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testdesired-manifest
quarks.cloudfoundry.org/referenced-job-name=instance-group-test
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=desired
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;bpm-secret&#34;&gt;BPM Secret&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testbpmnats
quarks.cloudfoundry.org/remote-id=nats
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=bpm
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;ig-resolved-secret&#34;&gt;IG Resolved Secret&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=testig-resolvednats
quarks.cloudfoundry.org/remote-id=nats
quarks.cloudfoundry.org/secret-kind=versionedSecret
quarks.cloudfoundry.org/secret-type=ig-resolved
quarks.cloudfoundry.org/secret-version=1
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;link-secret&#34;&gt;Link Secret&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;quarks.cloudfoundry.org/container-name=nats
quarks.cloudfoundry.org/deployment-name=test
quarks.cloudfoundry.org/entanglement=link-test-nats-nats
quarks.cloudfoundry.org/remote-id=nats
&lt;/code&gt;&lt;/pre&gt;
      </description>
    </item>
    
  </channel>
</rss>
